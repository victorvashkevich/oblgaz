<ПравилаОбмена>
	<ВерсияФормата РежимСовместимости="">2.01</ВерсияФормата>
	<Ид>e7f70ad7-a790-41fc-ab15-fe6864237dbb0004</Ид>
	<Наименование>Сотрудники ЗУП - 7.7</Наименование>
	<ДатаВремяСоздания>2019-11-01T12:11:07</ДатаВремяСоздания>
	<Источник ВерсияПлатформы="8.0" ВерсияКонфигурации="2.5.63.16" СинонимКонфигурации="Зарплата и Управление Персоналом для Беларуси, редакция 2.5">ЗарплатаИУправлениеПерсоналомДляБеларуси</Источник>
	<Приемник ВерсияПлатформы="7.7" ВерсияКонфигурации="" СинонимКонфигурации="">Консолидированный учет УП "Брестоблгаз" 2019 (ver.47)</Приемник>
	<ПередЗагрузкойДанных>ПрефиксБазы     = СокрЛП(Константа.КодСтруктуры);
ПрефиксБазыЗУП  = "ZP";

xmlDoc = СоздатьОбъект("Microsoft.XMLDOM");
xmlDoc.Load(СокрЛП(Константа.ПутькФайламЗУП1с77)+"Message_" + ПрефиксБазыЗУП + "_" + ПрефиксБазы + ".xml");    
//Получим корневой элемент
RootNode = xmlDoc.DocumentElement;

ИмяКонфигурацииПриемника = RootNode.getAttribute("ИмяКонфигурацииПриемника");
	
//Определим количество подчиненных узлов у данного узла
КоличествоПодчиненныхУзлов   = RootNode.childNodes.length;  
 
//Прочитаем каждый подчиненный уровень и выберем данные
Для Инд = 1 По КоличествоПодчиненныхУзлов Цикл   
 	//Получим очередной узел    
 	ТекУзел  = RootNode.childNodes.item(Инд-1); 
 	
 	Если Найти(Строка(ТекУзел.nodename),"ДанныеПоОбмену") &gt; 0 Тогда 
		НомерИсходящегоСообщения = ТекУзел.getAttribute("НомерИсходящегоСообщения");	 	
		НомерВходящегоСообщения  = ТекУзел.getAttribute("НомерВходящегоСообщения");	 			
		Кому 					 = ТекУзел.getAttribute("Кому");		
 	Конецесли;  
Конеццикла;	 

xmlDoc=0;

Если Параметры.КоличествоСтрок() = 0 Тогда
	Параметры.НоваяСтрока();
Иначе
	Параметры.ПолучитьСтрокуПоНомеру(1);
КонецЕсли;	
Параметры.УстановитьЗначение(1, "НомерИсходящегоСообщения", НомерИсходящегоСообщения);
Параметры.УстановитьЗначение(1, "НомерВходящегоСообщения", Число(НомерВходящегоСообщения) + 1);
Параметры.УстановитьЗначение(1, "Кому", Кому);
Параметры.УстановитьЗначение(1, "ИмяКонфигурацииПриемника", ИмяКонфигурацииПриемника);
Параметры.УстановитьЗначение(1, "ПрефиксБазы", ПрефиксБазы);
Параметры.УстановитьЗначение(1, "ПрефиксБазыЗУП", ПрефиксБазыЗУП);</ПередЗагрузкойДанных>
	<ПослеЗагрузкиДанных>Параметры.ПолучитьСтрокуПоНомеру(1);
		
Если СписокОшибок.РазмерСписка() = 0 Тогда
	
	XML_DOM=CreateObject("Microsoft.XMLDOM"); 
	
	СписокПараметров = СоздатьОбъект("СписокЗначений");
	
	СписокПараметров.Установить("ИмяФайлаПравил",КаталогИБ()+"Schedule\V77Exp_1c77_ZUP_Rules.xml");
	СписокПараметров.Установить("ИмяФайлаДанных", СокрЛП(Константа.ПутькФайламЗУП1с77)+"Message_" + Параметры.ПрефиксБазы + "_" + Параметры.ПрефиксБазыЗУП + ".xml");		
	СписокПараметров.Установить("ИмяКоманды","Выгрузить");
	
	Если ТекущаяИБЦентральная()=0 Тогда				
		СписокПараметров.Установить("ИспользуемыеПравилаВыгрузки","Автомобили,Заказчики");
	Иначе	
		СписокПараметров.Установить("ИспользуемыеПравилаВыгрузки","Контрагенты");
	КонецЕсли;				
	
	ОткрытьФорму("Отчет",СписокПараметров,КаталогИБ()+"Schedule\V77Exp_1c77_ZUP.ert");
	
	XML_DOM.Load(СокрЛП(Константа.ПутькФайламЗУП1с77)+"Message_" + Параметры.ПрефиксБазы + "_" + Параметры.ПрефиксБазыЗУП + ".xml");
	
	RootNode = XML_DOM.DocumentElement;
	RootNode.setAttribute("ВерсияФормата","3.1");
	RootNode.setAttribute("ИдПравилКонвертации","e7f70ad7-a790-41fc-ab15-fe6864237dbb0004");					
	RootNode.setAttribute("ИмяКонфигурацииПриемника","ЗарплатаИУправлениеПерсоналомДляБеларуси");			
	RootNode.setAttribute("ИмяКонфигурацииИсточника",Параметры.ИмяКонфигурацииПриемника);			
	ТекДата = ТекущаяДата();			
	RootNode.setAttribute("ДатаВыгрузки",Строка(ДатаГод(ТекДата)) +"-"+ 
		Строка(ДатаМесяц(ТекДата)) +"-"+ 
		Строка(ДатаЧисло(ТекДата)) +"T"+ ТекущееВремя());			
				
	
	ТегИнформацияОТипахДанных=XML_DOM.createElement("ИнформацияОТипахДанных");
	RootNode.appendChild(ТегИнформацияОТипахДанных);
	
	ТегДанныеПоОбмену=XML_DOM.createElement("ДанныеПоОбмену");
	RootNode.appendChild(ТегДанныеПоОбмену);
	
	АтрибутТекста = XML_DOM.createAttribute("ПланОбмена");
	АтрибутТекста.nodeValue = "ОбменЗУП77";
	ТегДанныеПоОбмену.setAttributeNode(АтрибутТекста);
	
	АтрибутТекста = XML_DOM.createAttribute("Кому");
	АтрибутТекста.nodeValue = Параметры.ПрефиксБазыЗУП;
	ТегДанныеПоОбмену.setAttributeNode(АтрибутТекста);
	
	АтрибутТекста = XML_DOM.createAttribute("ОтКого");
	АтрибутТекста.nodeValue = Параметры.Кому;
	ТегДанныеПоОбмену.setAttributeNode(АтрибутТекста);
	
	АтрибутТекста = XML_DOM.createAttribute("НомерИсходящегоСообщения");
	АтрибутТекста.nodeValue = Строка(Параметры.НомерВходящегоСообщения);
	ТегДанныеПоОбмену.setAttributeNode(АтрибутТекста);			
	
	АтрибутТекста = XML_DOM.createAttribute("НомерВходящегоСообщения");
	АтрибутТекста.nodeValue = Строка(Параметры.НомерИсходящегоСообщения);
	ТегДанныеПоОбмену.setAttributeNode(АтрибутТекста);			
	
	АтрибутТекста = XML_DOM.createAttribute("УдалитьРегистрациюИзменений");
	АтрибутТекста.nodeValue = "true";
	ТегДанныеПоОбмену.setAttributeNode(АтрибутТекста);	
	
	XML_DOM.Save(СокрЛП(Константа.ПутькФайламЗУП1с77) + "Message_" + Параметры.ПрефиксБазы + "_" + Параметры.ПрефиксБазыЗУП + ".xml");			
	
КонецЕсли;</ПослеЗагрузкиДанных>
	<Параметры>
		<Параметр Имя="ИмяКонфигурацииПриемника                          " Наименование="ИмяКонфигурацииПриемника" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="true"/>
		<Параметр Имя="Кому                                              " Наименование="Кому                                              " ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="true"/>
		<Параметр Имя="НомерВходящегоСообщения                           " Наименование="НомерВходящегоСообщения" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="true"/>
		<Параметр Имя="НомерИсходящегоСообщения                          " Наименование="НомерИсходящегоСообщения                          " ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="true"/>
		<Параметр Имя="ПрефиксБазы                                       " Наименование="ПрефиксБазы                                       " ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="true"/>
		<Параметр Имя="ПрефиксБазыЗУП                                    " Наименование="ПрефиксБазыЗУП                                    " ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="true"/>
	</Параметры>
	<Обработки/>
	<ПравилаКонвертацииОбъектов>
		<Группа>
			<Код>Справочники</Код>
			<Наименование>Справочники</Наименование>
			<Порядок>50</Порядок>
			<Правило>
				<Код>ШтатныеЕдиницы</Код>
				<Наименование>Справочник: Должности (профессии) организаций</Наименование>
				<Порядок>50</Порядок>
				<НеЗамещать>true</НеЗамещать>
				<НеСоздаватьЕслиНеНайден>true</НеСоздаватьЕслиНеНайден>
				<Источник>СправочникСсылка.ДолжностиОрганизаций</Источник>
				<Приемник>СправочникСсылка.ШтатныеЕдиницы</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Код77 --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код77" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.ДолжностиОрганизаций"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.ШтатныеЕдиницы"/>
					</Свойство>
					<Свойство Обязательное="true">
						<Код>5</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Число"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>Подразделения</Код>
				<Наименование>Справочник: Подразделения организации</Наименование>
				<Порядок>100</Порядок>
				<НеЗамещать>true</НеЗамещать>
				<НеСоздаватьЕслиНеНайден>true</НеСоздаватьЕслиНеНайден>
				<Источник>СправочникСсылка.ПодразделенияОрганизаций</Источник>
				<Приемник>СправочникСсылка.Подразделения</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Код77 --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код77" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.ПодразделенияОрганизаций"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Подразделения"/>
					</Свойство>
					<Свойство Обязательное="true">
						<Код>5</Код>
						<Наименование> --&gt; ЭтоГруппа</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Число"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>СотрудникиКадровыеДанные</Код>
				<Наименование>: </Наименование>
				<Порядок>150</Порядок>
				<НеСоздаватьЕслиНеНайден>true</НеСоздаватьЕслиНеНайден>
				<Приемник>СправочникСсылка.Сотрудники</Приемник>
				<Свойства>
					<Свойство>
						<Код>1</Код>
						<Наименование> --&gt; ДолжностьШЕ</Наименование>
						<Порядок>50</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ДолжностьШЕ" Вид="Реквизит" Тип="СправочникСсылка.ШтатныеЕдиницы"/>
						<КодПравилаКонвертации>ШтатныеЕдиницы                                    </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = ВходящиеДанные.ДолжностьШЕ;</ПередВыгрузкой>
						<ПриВыгрузке>УстановитьАтрибут(УзелСвойства, "ДатаЗначения", ВходящиеДанные.ПериодСотрудника);</ПриВыгрузке>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование> --&gt; Подразделение</Наименование>
						<Порядок>100</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Подразделение" Вид="Реквизит" Тип="СправочникСсылка.Подразделения"/>
						<КодПравилаКонвертации>Подразделения                                     </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = ВходящиеДанные.Подразделение;</ПередВыгрузкой>
						<ПриВыгрузке>УстановитьАтрибут(УзелСвойства, "ДатаЗначения", ВходящиеДанные.ПериодСотрудника);</ПриВыгрузке>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование> --&gt; Код</Наименование>
						<Порядок>150</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<ПередВыгрузкой>Значение = СокрЛП(ВходящиеДанные.Префикс)+"-"+Формат(Число(ВходящиеДанные.ТабельныйНомер),"ЧЦ=5; ЧВН=; ЧГ=");</ПередВыгрузкой>
						<ПриВыгрузке>//Добавим префикс, чтобы при загрузке искать сотрудника
УстановитьАтрибут(УзелСвойства, "Префикс", ВходящиеДанные.Префикс);</ПриВыгрузке>
					</Свойство>
					<Свойство Отключить="true">
						<Код>4</Код>
						<Наименование> --&gt; Наименование</Наименование>
						<Порядок>200</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<ПередВыгрузкой>Значение = ВходящиеДанные.ФизЛицо.Наименование;</ПередВыгрузкой>
					</Свойство>
					<Свойство Отключить="true">
						<Код>5</Код>
						<Наименование> --&gt; Пол</Наименование>
						<Порядок>250</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Пол" Вид="Реквизит" Тип="ПеречислениеСсылка.Пол"/>
						<ПередВыгрузкой>Значение = ВходящиеДанные.ФизЛицо.Пол;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование> --&gt; Должность</Наименование>
						<Порядок>300</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Должность" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = СокрЛП(ВходящиеДанные.ДолжностьШЕ.Наименование);</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>7</Код>
						<Наименование> --&gt; КодЗУП</Наименование>
						<Порядок>350</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="КодЗУП" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = СокрЛП(ВходящиеДанные.УникальныйИдентификатор);</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>Сотрудники</Код>
				<Наименование>Справочник: Сотрудники организаций</Наименование>
				<Порядок>200</Порядок>
				<Источник>СправочникСсылка.СотрудникиОрганизаций</Источник>
				<Приемник>СправочникСсылка.Сотрудники</Приемник>
				<Свойства>
					<Свойство>
						<Код>1</Код>
						<Наименование> --&gt; ДатаУвольнения</Наименование>
						<Порядок>50</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ДатаУвольнения" Вид="Реквизит" Тип="Дата"/>
						<ПередВыгрузкой>Отказ = Не ЗначениеЗаполнено(ВходящиеДанные.ДатаУвольнения);

Значение = ВходящиеДанные.ДатаУвольнения;</ПередВыгрузкой>
					</Свойство>
					<Свойство Отключить="true">
						<Код>2</Код>
						<Наименование>Должность --&gt; Должность</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Должность" Вид="Реквизит" Тип="СправочникСсылка.ДолжностиОрганизаций"/>
						<Приемник Имя="Должность" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>3</Код>
						<Наименование>Классность --&gt; Классность</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Классность" Вид="Реквизит" Тип="ПеречислениеСсылка.КлассностиВодителей"/>
						<Приемник Имя="Классность" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование> --&gt; Код</Наименование>
						<Порядок>200</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<ПередВыгрузкой>Значение = СокрЛП(ВходящиеДанные.Префикс)+"-"+Формат(Число(ВходящиеДанные.ТабельныйНомер),"ЧЦ=5; ЧВН=; ЧГ=");</ПередВыгрузкой>
						<ПриВыгрузке>//Добавим префикс, чтобы при загрузке искать сотрудника
УстановитьАтрибут(УзелСвойства, "Префикс", ВходящиеДанные.Префикс);</ПриВыгрузке>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование> --&gt; Наименование</Наименование>
						<Порядок>250</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<ПередВыгрузкой>Значение  = ВходящиеДанные.Наименование;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование> --&gt; ПометкаУдаления</Наименование>
						<Порядок>300</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Число"/>
						<ПослеВыгрузки>Значение = ВходящиеДанные.ПометкаУдаления;</ПослеВыгрузки>
					</Свойство>
					<Свойство Отключить="true">
						<Код>7</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.СотрудникиОрганизаций"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Сотрудники"/>
					</Свойство>
					<Свойство Отключить="true" Обязательное="true">
						<Код>8</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование> --&gt; Пол</Наименование>
						<Порядок>450</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Пол" Вид="Реквизит" Тип="ПеречислениеСсылка.Пол"/>
						<КодПравилаКонвертации>Пол                                               </КодПравилаКонвертации>
						<ПередВыгрузкой>Отказ = Не ЗначениеЗаполнено(ВходящиеДанные.Пол);

Значение = ВходящиеДанные.Пол;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>10</Код>
						<Наименование> --&gt; Адрес</Наименование>
						<Порядок>500</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Адрес" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Отказ = СокрЛП(ВходящиеДанные.АдресПроживания)="";

Значение = СокрЛП(ВходящиеДанные.АдресПроживания);</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>11</Код>
						<Наименование> --&gt; ДокументСерия</Наименование>
						<Порядок>550</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ДокументСерия" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Отказ = СокрЛП(ВходящиеДанные.ДокументСерия)="";

Значение = СокрЛП(ВходящиеДанные.ДокументСерия)</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>12</Код>
						<Наименование> --&gt; ДокументНомер</Наименование>
						<Порядок>600</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ДокументНомер" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Отказ = СокрЛП(ВходящиеДанные.ДокументНомер)="";

Значение = СокрЛП(ВходящиеДанные.ДокументНомер);</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>13</Код>
						<Наименование> --&gt; ДокументКемВыдан</Наименование>
						<Порядок>650</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ДокументКемВыдан" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Отказ = СокрЛП(ВходящиеДанные.ДокументКемВыдан)="";

Значение = СокрЛП(ВходящиеДанные.ДокументКемВыдан);</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>14</Код>
						<Наименование> --&gt; ДокументДатаВыдачи</Наименование>
						<Порядок>700</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ДокументДатаВыдачи" Вид="Реквизит" Тип="Дата"/>
						<ПередВыгрузкой>Отказ = Не ЗначениеЗаполнено(ВходящиеДанные.ДокументДатаВыдачи);

Значение = ВходящиеДанные.ДокументДатаВыдачи;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>15</Код>
						<Наименование> --&gt; ЛицевойСчет</Наименование>
						<Порядок>750</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ЛицевойСчет" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Отказ = СокрЛП(ВходящиеДанные.НомерЛицевогоСчета)="";

Значение = СокрЛП(ВходящиеДанные.НомерЛицевогоСчета);</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>16</Код>
						<Наименование> --&gt; ДатаПриема</Наименование>
						<Порядок>800</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ДатаПриема" Вид="Реквизит" Тип="Дата"/>
						<ПередВыгрузкой>Отказ = Не ЗначениеЗаполнено(ВходящиеДанные.ДатаПриема);

Значение = ВходящиеДанные.ДатаПриема;</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>17</Код>
						<Наименование> --&gt; КодЗУП</Наименование>
						<Порядок>850</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="КодЗУП" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = СокрЛП(ВходящиеДанные.УникальныйИдентификатор)</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
		</Группа>
		<Группа>
			<Код>Перечисления</Код>
			<Наименование>Перечисления                                      </Наименование>
			<Порядок>100</Порядок>
			<Правило>
				<Код>Пол</Код>
				<Наименование>Перечисление: Пол физических Лиц</Наименование>
				<Порядок>50</Порядок>
				<Источник>ПеречислениеСсылка.ПолФизическихЛиц</Источник>
				<Приемник>ПеречислениеСсылка.Пол</Приемник>
				<Свойства/>
				<Значения>
					<Значение>
						<Код>1</Код>
						<Наименование>Женский --&gt; Ж</Наименование>
						<Порядок>50</Порядок>
						<Источник>Женский</Источник>
						<Приемник>Ж</Приемник>
					</Значение>
					<Значение>
						<Код>2</Код>
						<Наименование>Мужской --&gt; М</Наименование>
						<Порядок>100</Порядок>
						<Источник>Мужской</Источник>
						<Приемник>М</Приемник>
					</Значение>
				</Значения>
			</Правило>
		</Группа>
	</ПравилаКонвертацииОбъектов>
	<ПравилаВыгрузкиДанных>
		<Группа Отключить="true">
			<Код>Справочники</Код>
			<Наименование>Справочники</Наименование>
			<Порядок>50</Порядок>
			<Правило Отключить="true">
				<Код>ДолжностиОрганизаций</Код>
				<Наименование>ДолжностиОрганизаций</Наименование>
				<Порядок>50</Порядок>
				<КодПравилаКонвертации>ШтатныеЕдиницы                                    </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.ДолжностиОрганизаций</ОбъектВыборки>
			</Правило>
			<Правило Отключить="true">
				<Код>ПодразделенияОрганизаций</Код>
				<Наименование>ПодразделенияОрганизаций</Наименование>
				<Порядок>100</Порядок>
				<КодПравилаКонвертации>Подразделения                                     </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.ПодразделенияОрганизаций</ОбъектВыборки>
			</Правило>
			<Правило Отключить="false">
				<Код>СотрудникиОрганизаций</Код>
				<Наименование>СотрудникиОрганизаций</Наименование>
				<Порядок>150</Порядок>
				<КодПравилаКонвертации>Сотрудники                                        </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.СотрудникиОрганизаций</ОбъектВыборки>
				<ПередВыгрузкойОбъекта>
//Если ЗначениеЗаполнено(Объект) И Не Объект.ЭтоГРуппа Тогда 
Если Не Объект.ЭтоГРуппа Тогда 
	
	Запрос = Новый Запрос;
	
	Запрос.Текст=
	
		"ВЫБРАТЬ
		|	&amp;ФизЛицо КАК ФизЛицо
		|ПОМЕСТИТЬ ВТФизЛицо1
		|;
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ФизическоеЛицо.ФизЛицо,
		|	МАКСИМУМ(ЛицевыеСчетаРаботниковОрганизации.НомерЛицевогоСчета) КАК НомерЛицевогоСчета //берем первый попавшийся, т.к. их может быть несколько
		|ПОМЕСТИТЬ ВТФизЛицо
		|ИЗ
		|	ВТФизЛицо1 КАК ФизическоеЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЛицевыеСчетаРаботниковОрганизации КАК ЛицевыеСчетаРаботниковОрганизации
		|		ПО ФизическоеЛицо.ФизЛицо = ЛицевыеСчетаРаботниковОрганизации.ФизЛицо

		|СГРУППИРОВАТЬ ПО
		|	ФизическоеЛицо.ФизЛицо
		|;
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ФизическоеЛицо.ФизЛицо КАК ФизЛицо,
		|	ФизическоеЛицо.ФизЛицо.Пол КАК Пол,
		|	ФизическоеЛицо.НомерЛицевогоСчета,
		|	ФИОФизЛицСрезПоследних.Фамилия,
		|	ФИОФизЛицСрезПоследних.Имя,
		|	ФИОФизЛицСрезПоследних.Отчество,
		|	ПаспортныеДанныеФизЛиц.ДокументСерия КАК ДокументСерия,
		|	ПаспортныеДанныеФизЛиц.ДокументНомер КАК ДокументНомер,
		|	ПаспортныеДанныеФизЛиц.ДокументДатаВыдачи КАК ДокументДатаВыдачи,
		|	ПаспортныеДанныеФизЛиц.ДокументКемВыдан КАК ДокументКемВыдан,
		|	ЕСТЬNULL(КонтактнаяИнформация1.Представление, КонтактнаяИнформация.Представление) КАК АдресПроживания
		|ИЗ
		|	ВТФизЛицо КАК ФизическоеЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц.СрезПоследних(, ФизЛицо = &amp;ФизЛицо) КАК ФИОФизЛицСрезПоследних
		|		ПО ФизическоеЛицо.ФизЛицо = ФИОФизЛицСрезПоследних.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК КонтактнаяИнформация
		|		ПО ФизическоеЛицо.ФизЛицо = КонтактнаяИнформация.Объект
		|			И (КонтактнаяИнформация.Тип = ЗНАЧЕНИЕ(Перечисление.ТипыКонтактнойИнформации.Адрес))
		|			И (КонтактнаяИнформация.Вид = ЗНАЧЕНИЕ(Справочник.ВидыКонтактнойИнформации.ЮрАдресФизЛица))
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК КонтактнаяИнформация1
		|		ПО ФизическоеЛицо.ФизЛицо = КонтактнаяИнформация1.Объект
		|			И (КонтактнаяИнформация1.Тип = ЗНАЧЕНИЕ(Перечисление.ТипыКонтактнойИнформации.Адрес))
		|			И (КонтактнаяИнформация1.Вид = ЗНАЧЕНИЕ(Справочник.ВидыКонтактнойИнформации.ФактАдресФизЛица))
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПаспортныеДанныеФизЛиц.СрезПоследних(, ) КАК ПаспортныеДанныеФизЛиц
		|		ПО ФизическоеЛицо.ФизЛицо = ПаспортныеДанныеФизЛиц.ФизЛицо";
	
		Запрос.УстановитьПараметр("ФизЛицо", Объект.ФизЛицо);
		
		Выборка = Запрос.Выполнить().Выбрать();
		
		ВходящиеДанные = Новый Структура;		
		
		Если Выборка.Следующий() Тогда
			
			ВходящиеДанные.Вставить("ТабельныйНомер",Объект.Код);
			ВходящиеДанные.Вставить("УникальныйИдентификатор",Объект.Ссылка.УникальныйИдентификатор());
			ВходящиеДанные.Вставить("ПометкаУдаления",Объект.ПометкаУдаления);
			ВходящиеДанные.Вставить("ДатаУвольнения",Объект.ДатаУвольнения);			
			ВходящиеДанные.Вставить("ДатаПриема",Объект.ДатаПриемаНаРаботу);
			ВходящиеДанные.Вставить("Наименование",Выборка.Фамилия+" "+Выборка.Имя+" "+Выборка.Отчество);
			ВходящиеДанные.Вставить("АдресПроживания",Выборка.АдресПроживания);
			ВходящиеДанные.Вставить("ДокументСерия",Выборка.ДокументСерия);
			ВходящиеДанные.Вставить("ДокументНомер",Выборка.ДокументНомер);
			ВходящиеДанные.Вставить("ДокументКемВыдан",Выборка.ДокументКемВыдан);
			ВходящиеДанные.Вставить("ДокументДатаВыдачи",Выборка.ДокументДатаВыдачи);
			ВходящиеДанные.Вставить("НомерЛицевогоСчета",Выборка.НомерЛицевогоСчета);
			ВходящиеДанные.Вставить("Пол",Выборка.Пол);
			ВходящиеДанные.Вставить("Префикс",СокрЛП(Объект.ТекущееОбособленноеПодразделение.Код77));
			

			ВыгрузитьПоПравилу(,,ВходящиеДанные,,"Сотрудники");
			
		КонецЕсли;
		
			
КонецЕсли;

Отказ = Истина;</ПередВыгрузкойОбъекта>
			</Правило>
		</Группа>
		<Группа Отключить="false">
			<Код>РегистрыСведений</Код>
			<Наименование>РегистрыСведений                                  </Наименование>
			<Порядок>100</Порядок>
			<Правило Отключить="false">
				<Код>РаботникиОрганизаций</Код>
				<Наименование>Работники организаций</Наименование>
				<Порядок>50</Порядок>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>РегистрСведенийЗапись.РаботникиОрганизаций</ОбъектВыборки>
				<ПередВыгрузкойОбъекта>//при использовании БСП и синхронизации нельзя корректно регистр перенести в документ в случае стандартной выгрузки, поэтому делаем через выгрузку по правилу

// проверка необходима т.к. возникают ситуации, когда меняют дату набора РС, который уже зарегистрирован к обмену, получается, что к обмену зарегистрирован несуществующий набор
Если ЗначениеЗаполнено(Объект) Тогда 
		
		ВходящиеДанные = Новый Структура;
		
		//в случае использования синхронизации раскомментировать
		
		ВходящиеДанные.Вставить("ПериодСотрудника",Объект[0].Период);
		ВходящиеДанные.Вставить("ДолжностьШЕ",Объект[0].Должность);
		ВходящиеДанные.Вставить("Подразделение",Объект[0].ПодразделениеОрганизации);
		ВходящиеДанные.Вставить("Префикс",СокрЛП(Объект[0].ОбособленноеПодразделение.Код77));
		ВходящиеДанные.Вставить("ТабельныйНомер",Объект[0].ТабельныйНомер);
		ВходящиеДанные.Вставить("ФизЛицо",Объект[0].Сотрудник.ФизЛицо);
		ВходящиеДанные.Вставить("УникальныйИдентификатор",Объект[0].Сотрудник.УникальныйИдентификатор());
		
		//ВходящиеДанные.Вставить("ПериодСотрудника",Объект.Период);
		//ВходящиеДанные.Вставить("ДолжностьШЕ",Объект.Должность);
		//ВходящиеДанные.Вставить("Подразделение",Объект.ПодразделениеОрганизации);
		//ВходящиеДанные.Вставить("Префикс",СокрЛП(Объект.ОбособленноеПодразделение.Код77));
		//ВходящиеДанные.Вставить("ТабельныйНомер",Объект.ТабельныйНомер);
		//ВходящиеДанные.Вставить("ФизЛицо",Объект.Сотрудник.ФизЛицо);
		
		ВыгрузитьПоПравилу(,,ВходящиеДанные,,"СотрудникиКадровыеДанные");
			
КонецЕсли;

Отказ = Истина;</ПередВыгрузкойОбъекта>
			</Правило>
		</Группа>
	</ПравилаВыгрузкиДанных>
	<ПравилаОчисткиДанных/>
	<Алгоритмы>
		<Алгоритм Имя="ДополниттьНулями" ИспользуетсяПриЗагрузке="false"/>
	</Алгоритмы>
	<Запросы/>
</ПравилаОбмена>