<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИнформационнаяБаза</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>Данные</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВидРасчета</dataPath>
			<field>ВидРасчета</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Вид расчета</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ГоловнаяОрганизация</dataPath>
			<field>ГоловнаяОрганизация</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Головная организация</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодДохода</dataPath>
			<field>КодДохода</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Код дохода</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Организация</dataPath>
			<field>Организация</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Организация</v8:content>
				</v8:item>
			</title>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПериодРегистрации</dataPath>
			<field>ПериодРегистрации</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Период регистрации</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ДФ='MMMM yyyy'</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Регистратор</dataPath>
			<field>Регистратор</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Регистратор</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФизЛицо</dataPath>
			<field>ФизЛицо</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Физическое лицо</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НДФЛ.БазаНДФЛ</dataPath>
			<field>БазаНДФЛ</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма доходов, зарегистрированная в учете по подоходному налогу</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НДФЛ.НалогНДФЛ</dataPath>
			<field>НалогНДФЛ</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Подоходный налог исчисленный</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldFolder">
			<dataPath>НДФЛ</dataPath>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Подоходный налог</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НДФЛ.НалогНДФЛУдержаный</dataPath>
			<field>НалогНДФЛУдержаный</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Подоходный налог удержанный (к перечислению в банк)</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НДФЛ.КодВычетНДФЛ</dataPath>
			<field>Вычет</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Вычет по подоходному налогу</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НДФЛ.ВычетаНДФЛ</dataPath>
			<field>СуммаВычетаНДФЛ</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма вычетов и льгот доходов физических лиц</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НДФЛ.СуммаДоходаНеОблагаемая</dataPath>
			<field>СуммаДоходаНеОблагаемая</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Доходы, целиком необлагаемые подоходным налогом</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНалогообложенияРезидента</dataPath>
			<field>СтавкаНалогообложенияРезидента</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Ставка налогообложения</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Инвалид</dataPath>
			<field>Инвалид</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Инвалид</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НеИмеетПравоНаПенсию</dataPath>
			<field>НеИмеетПравоНаПенсию</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Не имеет право на пенсию</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Взносы.БазаФСЗН</dataPath>
			<field>БазаФСЗН</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>База ФСЗН</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Взносы.ВидДохода</dataPath>
			<field>ВидДохода</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Взносы.Вид дохода</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Взносы.ОбязательноеСтрахование</dataPath>
			<field>ОбязательноеСтрахование</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Исчсленные взносы в Белгосстрах</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Взносы.ПенсионныйФонд</dataPath>
			<field>ПенсионныйФонд</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Исчисленный пенсионный фонд</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Взносы.ПособияИзФонда</dataPath>
			<field>ПособияИзФонда</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Пособия из фонда</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Взносы.ФСЗН</dataPath>
			<field>ФСЗН</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Исчисленный ФСЗН</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldFolder">
			<dataPath>Взносы</dataPath>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Взносы</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Взносы.Доход</dataPath>
			<field>Доход</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Начислено</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Взносы.БазаСтрах</dataPath>
			<field>БазаСтрах</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>База для отчислений в Белгосстрах</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Взносы.НеОблагаетсяЦеликом</dataPath>
			<field>НеОблагаетсяЦеликом</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Не облагается целиком</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Взносы.БазаППС</dataPath>
			<field>БазаППС</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>База ППС</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Взносы.ППС</dataPath>
			<field>ППС</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>ППС</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Взносы.ВидДеятельности</dataPath>
			<field>ВидДеятельности</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Вид деятельности</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПериодВзаиморасчетов</dataPath>
			<field>ПериодВзаиморасчетов</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Период взаиморасчетов</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ДФ='MMMM yyyy'</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Взносы.ПособияНеВходящиеВПУ</dataPath>
			<field>ПособияНеВходящиеВПУ</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Пособия не входящие в ПУ-3</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldFolder">
			<dataPath>ПособияИзФСЗН</dataPath>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Пособия из ФСЗН</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПособияИзФСЗН.ВидПособия</dataPath>
			<field>ВидПособия</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Вид пособия</v8:content>
				</v8:item>
			</title>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПособияИзФСЗН.КоличествоПособий</dataPath>
			<field>КоличествоПособий</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Количество пособий</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПособияИзФСЗН.ОплаченыеДни</dataPath>
			<field>ОплаченыеДни</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Оплаченые дни</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПособияИзФСЗН.ПроцентОплатыПособия</dataPath>
			<field>ПроцентОплатыПособия</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Процент оплаты пособия</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ГоризонтальноеПоложение</dcscor:parameter>
					<dcscor:value xsi:type="v8ui:HorizontalAlign">Left</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПособияИзФСЗН.СуммаПособий</dataPath>
			<field>СуммаПособий</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма пособий</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧДЦ=2</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПроцентФСЗН</dataPath>
			<field>ПроцентФСЗН</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Процент ФСЗН</v8:content>
				</v8:item>
			</title>
		</field>
		<dataSource>ИнформационнаяБаза</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации
ПОМЕСТИТЬ Периоды
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	СрезПоследнихДат.ПериодРегистрации,
	СрезПоследнихДат.Физлицо,
	СведенияОбИнвалидностиФизлиц.Инвалидность,
	СведенияОбИнвалидностиФизлиц.ГруппаИнвалидности
ПОМЕСТИТЬ Инвалиды
ИЗ
	(ВЫБРАТЬ
		ВТПериоды.ПериодРегистрации КАК ПериодРегистрации,
		СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо,
		МАКСИМУМ(СведенияОбИнвалидностиФизлиц.Период) КАК Период
	ИЗ
		Периоды КАК ВТПериоды
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОбИнвалидностиФизлиц КАК СведенияОбИнвалидностиФизлиц
			ПО (КОНЕЦПЕРИОДА(ВТПериоды.ПериодРегистрации, МЕСЯЦ) &gt;= СведенияОбИнвалидностиФизлиц.Период)
	
	СГРУППИРОВАТЬ ПО
		СведенияОбИнвалидностиФизлиц.Физлицо,
		ВТПериоды.ПериодРегистрации) КАК СрезПоследнихДат
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОбИнвалидностиФизлиц КАК СведенияОбИнвалидностиФизлиц
		ПО СрезПоследнихДат.Период = СведенияОбИнвалидностиФизлиц.Период
			И СрезПоследнихДат.Физлицо = СведенияОбИнвалидностиФизлиц.Физлицо
ГДЕ
	СведенияОбИнвалидностиФизлиц.ГруппаИнвалидности В ("I", "II")
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	СрезПоследнихДат.ПериодРегистрации,
	СрезПоследнихДат.Физлицо,
	ГражданствоФизЛиц.НеЯвляетсяНалоговымРезидентомРФ,
	ГражданствоФизЛиц.Страна,
	ГражданствоФизЛиц.НеИмеетПравоНаПенсию
ПОМЕСТИТЬ Гражданство
ИЗ
	(ВЫБРАТЬ
		ВТПериоды.ПериодРегистрации КАК ПериодРегистрации,
		ГражданствоФизЛиц.ФизЛицо КАК Физлицо,
		МАКСИМУМ(ГражданствоФизЛиц.Период) КАК Период
	ИЗ
		Периоды КАК ВТПериоды
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
			ПО (КОНЕЦПЕРИОДА(ВТПериоды.ПериодРегистрации, МЕСЯЦ) &gt;= ГражданствоФизЛиц.Период)
	
	СГРУППИРОВАТЬ ПО
		ГражданствоФизЛиц.ФизЛицо,
		ВТПериоды.ПериодРегистрации) КАК СрезПоследнихДат
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
		ПО СрезПоследнихДат.Период = ГражданствоФизЛиц.Период
			И СрезПоследнихДат.Физлицо = ГражданствоФизЛиц.ФизЛицо
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ПоследниеЗаписиРегитсра.ПериодРегистрации КАК ПериодРегистрации,
	ПоследниеЗаписиРегитсра.ФизЛицо КАК ФизЛицо
ПОМЕСТИТЬ НеИмеютправоНаПенсию
ИЗ
	(ВЫБРАТЬ
		Периоды.ПериодРегистрации КАК ПериодРегистрации,
		ГражданствоФизЛиц.ФизЛицо КАК ФизЛицо,
		МАКСИМУМ(ГражданствоФизЛиц.Период) КАК Период
	ИЗ
		Периоды КАК Периоды
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
			ПО (КОНЕЦПЕРИОДА(Периоды.ПериодРегистрации, МЕСЯЦ) &gt;= ГражданствоФизЛиц.Период)
	
	СГРУППИРОВАТЬ ПО
		Периоды.ПериодРегистрации,
		ГражданствоФизЛиц.ФизЛицо) КАК ПоследниеЗаписиРегитсра
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
		ПО ПоследниеЗаписиРегитсра.ФизЛицо = ГражданствоФизЛиц.ФизЛицо
			И ПоследниеЗаписиРегитсра.Период = ГражданствоФизЛиц.Период
ГДЕ
	ГражданствоФизЛиц.НеИмеетПравоНаПенсию
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо,
	ЕСНСведенияОДоходах.Организация,
	ЕСНСведенияОДоходах.КодДоходаЕСН КАК ВидДохода,
	ЕСНСведенияОДоходах.ОбособленноеПодразделение,
	ЕСНСведенияОДоходах.ВидДеятельности КАК ВидДеятельности,
	НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
	НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) КАК ПериодРегистрации,
	ВЫБОР
		КОГДА ЕСНСведенияОДоходах.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.БольничныйИзФСЗН)
			ТОГДА ЕСНСведенияОДоходах.Результат
		ИНАЧЕ 0
	КОНЕЦ КАК ПособияИзФонда,
	ВЫБОР
		КОГДА ЕСНСведенияОДоходах.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ПособияИзФСЗН)
			ТОГДА ЕСНСведенияОДоходах.Результат
		ИНАЧЕ 0
	КОНЕЦ КАК ПособияНеВходящиеВПУ,
	ЕСНСведенияОДоходах.Результат КАК Доходы,
	ВЫБОР
		КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.Облагается)
				И (Гражданство.НеИмеетПравоНаПенсию ЕСТЬ NULL 
					ИЛИ НЕ Гражданство.НеИмеетПравоНаПенсию)
			ТОГДА ЕСНСведенияОДоходах.БазаФСЗН
		ИНАЧЕ 0
	КОНЕЦ КАК БазаФСЗН,
	ВЫБОР
		КОГДА ЕСНСведенияОДоходах.ДоходППС = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.Облагается)
				И (Гражданство.НеИмеетПравоНаПенсию ЕСТЬ NULL 
					ИЛИ НЕ Гражданство.НеИмеетПравоНаПенсию)
			ТОГДА ЕСНСведенияОДоходах.БазаППС
		ИНАЧЕ 0
	КОНЕЦ КАК БазаППС,
	ВЫБОР
		КОГДА ЕСНСведенияОДоходах.ДоходСтрах = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.Облагается)
				И НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) &lt; ДАТАВРЕМЯ(2014, 7, 1)
			ТОГДА ЕСНСведенияОДоходах.Результат
		ИНАЧЕ 0
	КОНЕЦ КАК БазаСтрах,
	ВЫБОР
		КОГДА ЕСНСведенияОДоходах.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.НеОблагаетсяПолностью)
			ТОГДА ЕСНСведенияОДоходах.Результат
		ИНАЧЕ 0
	КОНЕЦ КАК НеОблагаетсяЦеликом,
	ЕСНСведенияОДоходах.Регистратор,
	ВЫБОР
		КОГДА &amp;Инвалид
			ТОГДА ЕСТЬNULL(Инвалиды.Инвалидность, ЛОЖЬ)
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК Инвалид
ПОМЕСТИТЬ ВТДоходыВзносов
ИЗ
	РегистрНакопления.ЕСНСведенияОДоходах КАК ЕСНСведенияОДоходах
		ЛЕВОЕ СОЕДИНЕНИЕ Инвалиды КАК Инвалиды
		ПО (НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = Инвалиды.ПериодРегистрации)
			И ЕСНСведенияОДоходах.ФизЛицо = Инвалиды.Физлицо
		ЛЕВОЕ СОЕДИНЕНИЕ Гражданство КАК Гражданство
		ПО (НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = Гражданство.ПериодРегистрации)
			И ЕСНСведенияОДоходах.ФизЛицо = Гражданство.Физлицо
ГДЕ
	ЕСНСведенияОДоходах.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(ВЫБОР
			КОГДА &amp;Инвалид
				ТОГДА ВЫБОР
						КОГДА ЕСТЬNULL(Инвалиды.Инвалидность, ЛОЖЬ)
							ТОГДА ИСТИНА
						ИНАЧЕ ЛОЖЬ
					КОНЕЦ
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Инвалид,
	(ЕСТЬNULL(Гражданство.НеИмеетПравоНаПенсию, ЛОЖЬ)) КАК НеИмеетПравоНаПенсию}

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	БелгосстрахСведенияОДоходах.Сотрудник.Физлицо,
	БелгосстрахСведенияОДоходах.Организация,
	БелгосстрахСведенияОДоходах.КодДоходаЕСН,
	//vvv
	БелгосстрахСведенияОДоходах.ОбособленноеПодразделение,
	//
	NULL,
	НАЧАЛОПЕРИОДА(БелгосстрахСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(БелгосстрахСведенияОДоходах.Период, МЕСЯЦ),
	0,
	0,
	0,
	0,
	0,
	ВЫБОР
		КОГДА БелгосстрахСведенияОДоходах.ДоходБелгосстрах = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.Облагается)
			ТОГДА БелгосстрахСведенияОДоходах.БазаБелгосстрах
		ИНАЧЕ 0
	КОНЕЦ,
	0,
	БелгосстрахСведенияОДоходах.Регистратор,
	ВЫБОР
		КОГДА &amp;Инвалид
			ТОГДА ЕСТЬNULL(Инвалиды.Инвалидность, ЛОЖЬ)
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ
ИЗ
	РегистрНакопления.БелгосстрахСведенияОДоходах КАК БелгосстрахСведенияОДоходах
		ЛЕВОЕ СОЕДИНЕНИЕ Инвалиды КАК Инвалиды
		ПО (НАЧАЛОПЕРИОДА(БелгосстрахСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = Инвалиды.ПериодРегистрации)
			И БелгосстрахСведенияОДоходах.Сотрудник.Физлицо = Инвалиды.Физлицо
		ЛЕВОЕ СОЕДИНЕНИЕ Гражданство КАК Гражданство
		ПО (НАЧАЛОПЕРИОДА(БелгосстрахСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = Гражданство.ПериодРегистрации)
			И БелгосстрахСведенияОДоходах.Сотрудник.Физлицо = Гражданство.Физлицо
ГДЕ
	БелгосстрахСведенияОДоходах.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(ВЫБОР
			КОГДА &amp;Инвалид
				ТОГДА ВЫБОР
						КОГДА ЕСТЬNULL(Инвалиды.Инвалидность, ЛОЖЬ)
							ТОГДА ИСТИНА
						ИНАЧЕ ЛОЖЬ
					КОНЕЦ
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Инвалид,
	(ЕСТЬNULL(Гражданство.НеИмеетПравоНаПенсию, ЛОЖЬ)) КАК НеИмеетПравоНаПенсию}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВЫБОР
		КОГДА &amp;ФизЛицо
			ТОГДА ВТДоходыВзносов.ФизЛицо
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
	КОНЕЦ КАК ФизЛицо,
	ВТДоходыВзносов.Организация КАК ГоловнаяОрганизация,
	ВЫБОР
		КОГДА &amp;ВидДохода
			ТОГДА ВТДоходыВзносов.ВидДохода
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ПустаяССылка)
	КОНЕЦ КАК ВидДохода,
	ВЫБОР
		КОГДА &amp;Регистратор
			ТОГДА ВТДоходыВзносов.Регистратор
		ИНАЧЕ ""
	КОНЕЦ КАК Регистратор,
	ВТДоходыВзносов.ОбособленноеПодразделение КАК Организация,
	ВТДоходыВзносов.ПериодРегистрации,
	ВТДоходыВзносов.ПериодВзаиморасчетов,
	ВЫБОР
		КОГДА &amp;ВидДеятельности
			ТОГДА ВТДоходыВзносов.ВидДеятельности
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка)
	КОНЕЦ КАК ВидДеятельности,
	СУММА(ВТДоходыВзносов.ПособияИзФонда) КАК ПособияИзФонда,
	СУММА(ВТДоходыВзносов.ПособияНеВходящиеВПУ) КАК ПособияНеВходящиеВПУ,
	СУММА(ВТДоходыВзносов.Доходы) КАК Доход,
	СУММА(ВТДоходыВзносов.БазаФСЗН) КАК БазаФСЗН,
	СУММА(ВТДоходыВзносов.БазаСтрах) КАК БазаСтрах,
	СУММА(ВТДоходыВзносов.БазаППС) КАК БазаППС,
	СУММА(ВТДоходыВзносов.НеОблагаетсяЦеликом) КАК НеОблагаетсяЦеликом,
	"БазаВзносов" КАК ВидТаблицы
ПОМЕСТИТЬ ВТБазаВзносов
ИЗ
	ВТДоходыВзносов КАК ВТДоходыВзносов
ГДЕ
	ВТДоходыВзносов.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода

СГРУППИРОВАТЬ ПО
	ВТДоходыВзносов.Организация,
	ВТДоходыВзносов.ОбособленноеПодразделение,
	ВТДоходыВзносов.ПериодРегистрации,
	ВТДоходыВзносов.ПериодВзаиморасчетов,
	ВЫБОР
		КОГДА &amp;ФизЛицо
			ТОГДА ВТДоходыВзносов.ФизЛицо
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;ВидДохода
			ТОГДА ВТДоходыВзносов.ВидДохода
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ПустаяССылка)
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;Регистратор
			ТОГДА ВТДоходыВзносов.Регистратор
		ИНАЧЕ ""
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;ВидДеятельности
			ТОГДА ВТДоходыВзносов.ВидДеятельности
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка)
	КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
	НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ) КАК ПериодРегистрации,
	ВЫБОР
		КОГДА &amp;ФизЛицо
			ТОГДА ЕСНИсчисленный.ФизЛицо
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
	КОНЕЦ КАК ФизЛицо,
	ЕСНИсчисленный.Организация КАК ГоловнаяОрганизация,
	ЕСНИсчисленный.ОбособленноеПодразделение КАК Организация,
	ВЫБОР
		КОГДА &amp;Регистратор
			ТОГДА ЕСНИсчисленный.Регистратор
		ИНАЧЕ ""
	КОНЕЦ КАК Регистратор,
	ВЫБОР
		КОГДА &amp;Инвалид
			ТОГДА ЕСТЬNULL(Инвалиды.Инвалидность, ЛОЖЬ)
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК Инвалид,
	ВЫБОР
		КОГДА &amp;ВидДеятельности
			ТОГДА ЕСНИсчисленный.ВидДеятельности
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка)
	КОНЕЦ КАК ВидДеятельности,
	СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН,
	СУММА(ЕСНИсчисленный.ППС) КАК ППС,
	СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд,
	СУММА(ЕСНИсчисленный.ОбязательноеСтрахование) КАК ОбязательноеСтрахование,
	"Взносы" КАК ВидТаблицы,
	ЕСНИсчисленный.ПроцентФСЗН
ПОМЕСТИТЬ ВТВзносы
ИЗ
	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		ЛЕВОЕ СОЕДИНЕНИЕ Инвалиды КАК Инвалиды
		ПО (НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) = Инвалиды.ПериодРегистрации)
			И ЕСНИсчисленный.ФизЛицо = Инвалиды.Физлицо
ГДЕ
	ЕСНИсчисленный.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(ВЫБОР
			КОГДА &amp;Инвалид
				ТОГДА ВЫБОР
						КОГДА ЕСТЬNULL(Инвалиды.Инвалидность, ЛОЖЬ)
							ТОГДА ИСТИНА
						ИНАЧЕ ЛОЖЬ
					КОНЕЦ
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Инвалид}

СГРУППИРОВАТЬ ПО
	НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ),
	ВЫБОР
		КОГДА &amp;ФизЛицо
			ТОГДА ЕСНИсчисленный.ФизЛицо
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
	КОНЕЦ,
	ЕСНИсчисленный.Организация,
	ЕСНИсчисленный.ОбособленноеПодразделение,
	ВЫБОР
		КОГДА &amp;ВидДеятельности
			ТОГДА ЕСНИсчисленный.ВидДеятельности
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка)
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;Регистратор
			ТОГДА ЕСНИсчисленный.Регистратор
		ИНАЧЕ ""
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;Инвалид
			ТОГДА ЕСТЬNULL(Инвалиды.Инвалидность, ЛОЖЬ)
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ЕСНИсчисленный.ПроцентФСЗН

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НАЧАЛОПЕРИОДА(БелгосстрахИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(БелгосстрахИсчисленный.Период, МЕСЯЦ),
	ВЫБОР
		КОГДА &amp;ФизЛицо
			ТОГДА БелгосстрахИсчисленный.Сотрудник.Физлицо
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
	КОНЕЦ,
	БелгосстрахИсчисленный.Организация,
	БелгосстрахИсчисленный.ОбособленноеПодразделение,
	ВЫБОР
		КОГДА &amp;Регистратор
			ТОГДА БелгосстрахИсчисленный.Регистратор
		ИНАЧЕ ""
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;Инвалид
			ТОГДА ЕСТЬNULL(Инвалиды.Инвалидность, ЛОЖЬ)
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;ВидДеятельности
			ТОГДА БелгосстрахИсчисленный.ВидДеятельности
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка)
	КОНЕЦ,
	0,
	0,
	0,
	СУММА(БелгосстрахИсчисленный.Белгосстрах),
	"Взносы",
	NULL
ИЗ
	РегистрНакопления.БелгосстрахИсчисленный КАК БелгосстрахИсчисленный
		ЛЕВОЕ СОЕДИНЕНИЕ Инвалиды КАК Инвалиды
		ПО (НАЧАЛОПЕРИОДА(БелгосстрахИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) = Инвалиды.ПериодРегистрации)
			И БелгосстрахИсчисленный.ФизЛицо = Инвалиды.Физлицо
ГДЕ
	БелгосстрахИсчисленный.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	(ВЫБОР
			КОГДА &amp;Инвалид
				ТОГДА ВЫБОР
						КОГДА ЕСТЬNULL(Инвалиды.Инвалидность, ЛОЖЬ)
							ТОГДА ИСТИНА
						ИНАЧЕ ЛОЖЬ
					КОНЕЦ
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ) КАК Инвалид}

СГРУППИРОВАТЬ ПО
	НАЧАЛОПЕРИОДА(БелгосстрахИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(БелгосстрахИсчисленный.Период, МЕСЯЦ),
	ВЫБОР
		КОГДА &amp;ФизЛицо
			ТОГДА БелгосстрахИсчисленный.Сотрудник.Физлицо
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
	КОНЕЦ,
	БелгосстрахИсчисленный.Организация,
	БелгосстрахИсчисленный.ОбособленноеПодразделение,
	ВЫБОР
		КОГДА &amp;ВидДеятельности
			ТОГДА БелгосстрахИсчисленный.ВидДеятельности
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка)
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;Регистратор
			ТОГДА БелгосстрахИсчисленный.Регистратор
		ИНАЧЕ ""
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;Инвалид
			ТОГДА ЕСТЬNULL(Инвалиды.Инвалидность, ЛОЖЬ)
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВЫБОР
		КОГДА &amp;ФизЛицо
			ТОГДА ПособияИзФСЗН.ФизЛицо
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
	КОНЕЦ КАК ФизЛицо,
	ПособияИзФСЗН.Организация,
	ПособияИзФСЗН.ВидПособия,
	СУММА(ЕСТЬNULL(ПособияИзФСЗН.Сумма, 0)) КАК Сумма,
	СУММА(ЕСТЬNULL(ПособияИзФСЗН.КоличествоПособий, 0)) КАК КоличествоПособий,
	СУММА(ЕСТЬNULL(ПособияИзФСЗН.ОплаченныеДни, 0)) КАК ОплаченныеДни,
	ПособияИзФСЗН.Размер КАК ПроцентОплатыПособия,
	"ПособияИзФСЗН" КАК ВидТаблицы,
	ПособияИзФСЗН.Период,
	ВЫБОР
		КОГДА &amp;Регистратор
			ТОГДА ПособияИзФСЗН.Регистратор
		ИНАЧЕ ""
	КОНЕЦ КАК Регистратор
ПОМЕСТИТЬ ВТПособияИзФСЗН
ИЗ
	РегистрНакопления.ПособияИзФСЗН КАК ПособияИзФСЗН
ГДЕ
	ПособияИзФСЗН.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода

СГРУППИРОВАТЬ ПО
	ПособияИзФСЗН.Организация,
	ПособияИзФСЗН.ВидПособия,
	ПособияИзФСЗН.Размер,
	ПособияИзФСЗН.Период,
	ВЫБОР
		КОГДА &amp;ФизЛицо
			ТОГДА ПособияИзФСЗН.ФизЛицо
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;Регистратор
			ТОГДА ПособияИзФСЗН.Регистратор
		ИНАЧЕ ""
	КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	НДФЛСведенияОДоходах.Организация КАК ГоловнаяОрганизация,
	ВЫБОР
		КОГДА &amp;ФизЛицо
			ТОГДА НДФЛСведенияОДоходах.ФизЛицо
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
	КОНЕЦ КАК ФизЛицо,
	ВЫБОР
		КОГДА &amp;КодДохода
			ТОГДА НДФЛСведенияОДоходах.КодДохода
		ИНАЧЕ ""
	КОНЕЦ КАК КодДохода,
	НДФЛСведенияОДоходах.ОбособленноеПодразделение КАК Организация,
	//vvv
	//НДФЛСведенияОДоходах.ПериодРегистрации КАК ПериодРегистрации,
	//НДФЛСведенияОДоходах.Период КАК ПериодВзаиморасчетов,
	НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации,МЕСЯЦ) КАК ПериодРегистрации,
	НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период,МЕСЯЦ) КАК ПериодВзаиморасчетов,
	//
	СУММА(НДФЛСведенияОДоходах.СуммаДохода) КАК СуммаДохода,
	НДФЛСведенияОДоходах.КодДохода.СтавкаНалогообложенияРезидента КАК СтавкаНалогообложенияРезидента,
	ВЫБОР
		КОГДА &amp;Регистратор
			ТОГДА НДФЛСведенияОДоходах.Регистратор
		ИНАЧЕ ""
	КОНЕЦ КАК Регистратор,
	ВЫБОР
		КОГДА &amp;Вычет
			ТОГДА НДФЛСведенияОДоходах.КодВычета
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка)
	КОНЕЦ КАК Вычет,
	СУММА(НДФЛСведенияОДоходах.СуммаВычета) КАК СуммаВычета,
	ВЫБОР
		КОГДА &amp;ВидРасчета
			ТОГДА НДФЛСведенияОДоходах.ВидРасчета
		ИНАЧЕ ""
	КОНЕЦ КАК ВидРасчета
ПОМЕСТИТЬ СведенияОДоходахНДФЛ
ИЗ
	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВТПериоды.ПериодРегистрации КАК Период,
			ГражданствоФизЛиц.ФизЛицо КАК ФизЛицо,
			МАКСИМУМ(ГражданствоФизЛиц.Период) КАК ПериодЗаписи
		ИЗ
			Периоды КАК ВТПериоды
				ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
				ПО (КОНЕЦПЕРИОДА(ВТПериоды.ПериодРегистрации, МЕСЯЦ) &gt;= ГражданствоФизЛиц.Период)
		
		СГРУППИРОВАТЬ ПО
			ВТПериоды.ПериодРегистрации,
			ГражданствоФизЛиц.ФизЛицо) КАК ДатыПоследнихДвижений
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
			ПО ДатыПоследнихДвижений.ПериодЗаписи = ГражданствоФизЛиц.Период
				И ДатыПоследнихДвижений.ФизЛицо = ГражданствоФизЛиц.ФизЛицо
		ПО (НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ) = ДатыПоследнихДвижений.Период)
			И НДФЛСведенияОДоходах.ФизЛицо = ДатыПоследнихДвижений.ФизЛицо
ГДЕ
	//vvv
	//НДФЛСведенияОДоходах.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	НДФЛСведенияОДоходах.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	//

СГРУППИРОВАТЬ ПО
	ВЫБОР
		КОГДА &amp;ФизЛицо
			ТОГДА НДФЛСведенияОДоходах.ФизЛицо
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
	КОНЕЦ,
	НДФЛСведенияОДоходах.ОбособленноеПодразделение,
	НДФЛСведенияОДоходах.Организация,
	НДФЛСведенияОДоходах.ИсчисленоИзЗарплаты,
	//vvv
	//НДФЛСведенияОДоходах.Период,
	//НДФЛСведенияОДоходах.ПериодРегистрации,
	НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период,МЕСЯЦ),
	НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации,МЕСЯЦ),
	//
	ВЫБОР
		КОГДА &amp;Регистратор
			ТОГДА НДФЛСведенияОДоходах.Регистратор
		ИНАЧЕ ""
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;КодДохода
			ТОГДА НДФЛСведенияОДоходах.КодДохода
		ИНАЧЕ ""
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;Вычет
			ТОГДА НДФЛСведенияОДоходах.КодВычета
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка)
	КОНЕЦ,
	НДФЛСведенияОДоходах.КодДохода.СтавкаНалогообложенияРезидента,
	ВЫБОР
		КОГДА &amp;ВидРасчета
			ТОГДА НДФЛСведенияОДоходах.ВидРасчета
		ИНАЧЕ ""
	КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	БАЗАИТОГО.ВидРасчета КАК ВидРасчета,
	СУММА(БАЗАИТОГО.Результат) КАК Результат,
	БАЗАИТОГО.Организация КАК Организация,
	БАЗАИТОГО.ФизЛицо КАК ФизЛицо,
	БАЗАИТОГО.КодДохода КАК КодДохода,
	БАЗАИТОГО.СтавкаНалогообложенияРезидента КАК СтавкаНалогообложенияРезидента,
	БАЗАИТОГО.ПериодРегистрации КАК ПериодРегистрации,
	БАЗАИТОГО.ПериодВзаиморасчетов КАК ПериодВзаиморасчетов,
	БАЗАИТОГО.ГоловнаяОрганизация,
	БАЗАИТОГО.Регистратор,
	СУММА(БАЗАИТОГО.СуммаДоходаНеОблагаемая) КАК СуммаДоходаНеОблагаемая,
	"БазаНДФЛ" КАК ВидТаблицы
ПОМЕСТИТЬ БазаНДФЛ
ИЗ
	(ВЫБРАТЬ
		СведенияОДоходахНДФЛ.ВидРасчета КАК ВидРасчета,
		СУММА(СведенияОДоходахНДФЛ.СуммаДохода) КАК Результат,
		СведенияОДоходахНДФЛ.Организация КАК Организация,
		СведенияОДоходахНДФЛ.ФизЛицо КАК ФизЛицо,
		СведенияОДоходахНДФЛ.КодДохода КАК КодДохода,
		СведенияОДоходахНДФЛ.СтавкаНалогообложенияРезидента КАК СтавкаНалогообложенияРезидента,
		СведенияОДоходахНДФЛ.ПериодРегистрации КАК ПериодРегистрации,
		СведенияОДоходахНДФЛ.ПериодВзаиморасчетов КАК ПериодВзаиморасчетов,
		СведенияОДоходахНДФЛ.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
		СведенияОДоходахНДФЛ.Регистратор КАК Регистратор,
		СУММА(ВЫБОР
				КОГДА СведенияОДоходахНДФЛ.СтавкаНалогообложенияРезидента = ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.НеОблагается)
					ТОГДА СведенияОДоходахНДФЛ.СуммаДохода
				ИНАЧЕ 0
			КОНЕЦ) КАК СуммаДоходаНеОблагаемая
	ИЗ
		СведенияОДоходахНДФЛ КАК СведенияОДоходахНДФЛ
	ГДЕ
		НЕ &amp;ВидРасчета
	
	СГРУППИРОВАТЬ ПО
		СведенияОДоходахНДФЛ.Организация,
		СведенияОДоходахНДФЛ.ФизЛицо,
		СведенияОДоходахНДФЛ.КодДохода,
		СведенияОДоходахНДФЛ.СтавкаНалогообложенияРезидента,
		СведенияОДоходахНДФЛ.ПериодРегистрации,
		СведенияОДоходахНДФЛ.ПериодВзаиморасчетов,
		СведенияОДоходахНДФЛ.ГоловнаяОрганизация,
		СведенияОДоходахНДФЛ.Регистратор,
		СведенияОДоходахНДФЛ.ВидРасчета) КАК БАЗАИТОГО

СГРУППИРОВАТЬ ПО
	БАЗАИТОГО.ВидРасчета,
	БАЗАИТОГО.Организация,
	БАЗАИТОГО.ФизЛицо,
	БАЗАИТОГО.КодДохода,
	БАЗАИТОГО.СтавкаНалогообложенияРезидента,
	БАЗАИТОГО.ПериодРегистрации,
	БАЗАИТОГО.ПериодВзаиморасчетов,
	БАЗАИТОГО.ГоловнаяОрганизация,
	БАЗАИТОГО.Регистратор
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ) КАК ПериодРегистрации,
	НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ) КАК ПериодВзаиморасчетов,
	ВЫБОР
		КОГДА &amp;ФизЛицо
			ТОГДА НДФЛРасчетыСБюджетом.ФизЛицо
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
	КОНЕЦ КАК ФизЛицо,
	НДФЛРасчетыСБюджетом.Организация КАК ГоловнаяОрганизация,
	ВЫБОР
		КОГДА &amp;СтавкаНалогообложенияРезидента
				И НДФЛРасчетыСБюджетом.КодДохода &lt;&gt; ""
			ТОГДА НДФЛРасчетыСБюджетом.КодДохода.СтавкаНалогообложенияРезидента
		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.ПустаяССылка)
	КОНЕЦ КАК СтавкаНалогообложенияРезидента,
	СУММА(ВЫБОР
			КОГДА НДФЛРасчетыСБюджетом.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.НДФЛРасчетыСБюджетомВидСтроки.Начисление)
				ТОГДА НДФЛРасчетыСБюджетом.Налог
			ИНАЧЕ 0
		КОНЕЦ) КАК Налог,
	НДФЛРасчетыСБюджетом.ОбособленноеПодразделение КАК Организация,
	ВЫБОР
		КОГДА &amp;КодДохода
			ТОГДА НДФЛРасчетыСБюджетом.КодДохода
		ИНАЧЕ ""
	КОНЕЦ КАК КодДохода,
	ВЫБОР
		КОГДА &amp;Регистратор
			ТОГДА НДФЛРасчетыСБюджетом.Регистратор
		ИНАЧЕ ""
	КОНЕЦ КАК Регистратор,
	СУММА(ВЫБОР
			КОГДА НДФЛРасчетыСБюджетом.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.НДФЛРасчетыСБюджетомВидСтроки.Удержание)
					ИЛИ НДФЛРасчетыСБюджетом.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.НДФЛРасчетыСБюджетомВидСтроки.ВозвратНалога)
				ТОГДА НДФЛРасчетыСБюджетом.Налог
			ИНАЧЕ 0
		КОНЕЦ) КАК НалогУдержаный,
	"НалогНДФЛ" КАК ВидТаблицы
ПОМЕСТИТЬ НалогНДФЛ
ИЗ
	РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВТПериоды.ПериодРегистрации КАК Период,
			ГражданствоФизЛиц.ФизЛицо КАК ФизЛицо,
			МАКСИМУМ(ГражданствоФизЛиц.Период) КАК ПериодЗаписи
		ИЗ
			Периоды КАК ВТПериоды
				ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
				ПО (КОНЕЦПЕРИОДА(ВТПериоды.ПериодРегистрации, МЕСЯЦ) &gt;= ГражданствоФизЛиц.Период)
		
		СГРУППИРОВАТЬ ПО
			ВТПериоды.ПериодРегистрации,
			ГражданствоФизЛиц.ФизЛицо) КАК ДатыПоследнихДвижений
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
			ПО ДатыПоследнихДвижений.ПериодЗаписи = ГражданствоФизЛиц.Период
				И ДатыПоследнихДвижений.ФизЛицо = ГражданствоФизЛиц.ФизЛицо
		ПО (НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ) = ДатыПоследнихДвижений.Период)
			И НДФЛРасчетыСБюджетом.ФизЛицо = ДатыПоследнихДвижений.ФизЛицо
ГДЕ
	//vvv
	//НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	НДФЛРасчетыСБюджетом.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	//

СГРУППИРОВАТЬ ПО
	НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
	НДФЛРасчетыСБюджетом.Организация,
	ВЫБОР
		КОГДА &amp;ФизЛицо
			ТОГДА НДФЛРасчетыСБюджетом.ФизЛицо
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;КодДохода
			ТОГДА НДФЛРасчетыСБюджетом.КодДохода
		ИНАЧЕ ""
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;Регистратор
			ТОГДА НДФЛРасчетыСБюджетом.Регистратор
		ИНАЧЕ ""
	КОНЕЦ,
	НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
	НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
	ВЫБОР
		КОГДА &amp;СтавкаНалогообложенияРезидента
				И НДФЛРасчетыСБюджетом.КодДохода &lt;&gt; ""
			ТОГДА НДФЛРасчетыСБюджетом.КодДохода.СтавкаНалогообложенияРезидента
		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.ПустаяССылка)
	КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	СведенияОВычетах.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
	СведенияОВычетах.ФизЛицо КАК ФизЛицо,
	СведенияОВычетах.Организация КАК Организация,
	СведенияОВычетах.Вычет КАК Вычет,
	СУММА(СведенияОВычетах.СуммаВычета) КАК СуммаВычета,
	СведенияОВычетах.ПериодРегистрации КАК ПериодРегистрации,
	//vvv
	//СведенияОВычетах.ПериодРегистрации КАК ПериодВзаиморасчетов,
	СведенияОВычетах.ПериодВзаиморасчетов КАК ПериодВзаиморасчетов,
	//
	СведенияОВычетах.Регистратор КАК Регистратор,
	СведенияОВычетах.СтавкаНалогообложенияРезидента,
	"ВычетыНДФЛ" КАК ВидТаблицы
ПОМЕСТИТЬ ВычетыНДФЛ
ИЗ
	(ВЫБРАТЬ
		НДФЛИмущественныеВычетыФизлиц.Организация КАК ГоловнаяОрганизация,
		ВЫБОР
			КОГДА &amp;ФизЛицо
				ТОГДА НДФЛИмущественныеВычетыФизлиц.ФизЛицо
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
		КОНЕЦ КАК ФизЛицо,
		НДФЛИмущественныеВычетыФизлиц.ОбособленноеПодразделение КАК Организация,
		ВЫБОР
			КОГДА &amp;Вычет
				ТОГДА НДФЛИмущественныеВычетыФизлиц.КодВычетаИмущественный
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка)
		КОНЕЦ КАК Вычет,
		СУММА(НДФЛИмущественныеВычетыФизлиц.Размер) КАК СуммаВычета,
		//vvv
		//НАЧАЛОПЕРИОДА(НДФЛИмущественныеВычетыФизлиц.Период, МЕСЯЦ) КАК ПериодРегистрации,
		НАЧАЛОПЕРИОДА(НДФЛИмущественныеВычетыФизлиц.ПериодРегистрации, МЕСЯЦ) КАК ПериодРегистрации,
		//
		НАЧАЛОПЕРИОДА(НДФЛИмущественныеВычетыФизлиц.Период, МЕСЯЦ) КАК ПериодВзаиморасчетов,
		ВЫБОР
			КОГДА &amp;Регистратор
				ТОГДА НДФЛИмущественныеВычетыФизлиц.Регистратор
			ИНАЧЕ ""
		КОНЕЦ КАК Регистратор,
		ВЫБОР
			КОГДА &amp;СтавкаНалогообложенияРезидента
				ТОГДА ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.Ставка13)
			ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.ПустаяССылка)
		КОНЕЦ КАК СтавкаНалогообложенияРезидента
	ИЗ
		РегистрНакопления.НДФЛИмущественныеВычетыФизлиц КАК НДФЛИмущественныеВычетыФизлиц
	ГДЕ
		//vvv
		//НДФЛИмущественныеВычетыФизлиц.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		НДФЛИмущественныеВычетыФизлиц.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		//
		И НДФЛИмущественныеВычетыФизлиц.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	
	СГРУППИРОВАТЬ ПО
		НДФЛИмущественныеВычетыФизлиц.Организация,
		ВЫБОР
			КОГДА &amp;ФизЛицо
				ТОГДА НДФЛИмущественныеВычетыФизлиц.ФизЛицо
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
		КОНЕЦ,
		НДФЛИмущественныеВычетыФизлиц.ОбособленноеПодразделение,
		ВЫБОР
			КОГДА &amp;Вычет
				ТОГДА НДФЛИмущественныеВычетыФизлиц.КодВычетаИмущественный
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка)
		КОНЕЦ,
		//vvv
		//НАЧАЛОПЕРИОДА(НДФЛИмущественныеВычетыФизлиц.Период, МЕСЯЦ),
		НАЧАЛОПЕРИОДА(НДФЛИмущественныеВычетыФизлиц.ПериодРегистрации, МЕСЯЦ),
		//
		ВЫБОР
			КОГДА &amp;Регистратор
				ТОГДА НДФЛИмущественныеВычетыФизлиц.Регистратор
			ИНАЧЕ ""
		КОНЕЦ,
		НАЧАЛОПЕРИОДА(НДФЛИмущественныеВычетыФизлиц.Период, МЕСЯЦ)
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		СведенияОДоходахНДФЛ.ГоловнаяОрганизация,
		СведенияОДоходахНДФЛ.ФизЛицо,
		СведенияОДоходахНДФЛ.Организация,
		СведенияОДоходахНДФЛ.Вычет,
		СУММА(СведенияОДоходахНДФЛ.СуммаВычета),
		СведенияОДоходахНДФЛ.ПериодРегистрации,
		СведенияОДоходахНДФЛ.ПериодВзаиморасчетов,
		СведенияОДоходахНДФЛ.Регистратор,
		СведенияОДоходахНДФЛ.СтавкаНалогообложенияРезидента
	ИЗ
		СведенияОДоходахНДФЛ КАК СведенияОДоходахНДФЛ
	
	СГРУППИРОВАТЬ ПО
		СведенияОДоходахНДФЛ.ГоловнаяОрганизация,
		СведенияОДоходахНДФЛ.ФизЛицо,
		СведенияОДоходахНДФЛ.Организация,
		СведенияОДоходахНДФЛ.Вычет,
		СведенияОДоходахНДФЛ.ПериодРегистрации,
		СведенияОДоходахНДФЛ.ПериодВзаиморасчетов,
		СведенияОДоходахНДФЛ.Регистратор,
		СведенияОДоходахНДФЛ.СтавкаНалогообложенияРезидента
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		НДФЛРасчетыСБюджетом.Организация,
		ВЫБОР
			КОГДА &amp;ФизЛицо
				ТОГДА НДФЛРасчетыСБюджетом.ФизЛицо
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
		КОНЕЦ,
		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		ВЫБОР
			КОГДА &amp;Вычет
				ТОГДА ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код600)
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка)
		КОНЕЦ,
		СУММА(НДФЛРасчетыСБюджетом.ПримененныйВычетЛичный),
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		ВЫБОР
			КОГДА &amp;Регистратор
				ТОГДА НДФЛРасчетыСБюджетом.Регистратор
			ИНАЧЕ ""
		КОНЕЦ,
		ВЫБОР
			КОГДА &amp;СтавкаНалогообложенияРезидента
				ТОГДА ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.Ставка13)
			ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.ПустаяССылка)
		КОНЕЦ
	ИЗ
		РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
	ГДЕ
		//vvv
		//НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		НДФЛРасчетыСБюджетом.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		//
		И НДФЛРасчетыСБюджетом.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	
	СГРУППИРОВАТЬ ПО
		НДФЛРасчетыСБюджетом.Организация,
		ВЫБОР
			КОГДА &amp;ФизЛицо
				ТОГДА НДФЛРасчетыСБюджетом.ФизЛицо
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
		КОНЕЦ,
		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		ВЫБОР
			КОГДА &amp;Регистратор
				ТОГДА НДФЛРасчетыСБюджетом.Регистратор
			ИНАЧЕ ""
		КОНЕЦ
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		НДФЛРасчетыСБюджетом.Организация,
		ВЫБОР
			КОГДА &amp;ФизЛицо
				ТОГДА НДФЛРасчетыСБюджетом.ФизЛицо
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
		КОНЕЦ,
		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		ВЫБОР
			КОГДА &amp;Вычет
				ТОГДА ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код610)
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка)
		КОНЕЦ,
		СУММА(НДФЛРасчетыСБюджетом.ПримененныйВычетНаДетей),
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		ВЫБОР
			КОГДА &amp;Регистратор
				ТОГДА НДФЛРасчетыСБюджетом.Регистратор
			ИНАЧЕ ""
		КОНЕЦ,
		ВЫБОР
			КОГДА &amp;СтавкаНалогообложенияРезидента
				ТОГДА ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.Ставка13)
			ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.ПустаяССылка)
		КОНЕЦ
	ИЗ
		РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
	ГДЕ
		//vvv
		//НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		НДФЛРасчетыСБюджетом.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		//
		И НДФЛРасчетыСБюджетом.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	
	СГРУППИРОВАТЬ ПО
		НДФЛРасчетыСБюджетом.Организация,
		ВЫБОР
			КОГДА &amp;ФизЛицо
				ТОГДА НДФЛРасчетыСБюджетом.ФизЛицо
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
		КОНЕЦ,
		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		ВЫБОР
			КОГДА &amp;Регистратор
				ТОГДА НДФЛРасчетыСБюджетом.Регистратор
			ИНАЧЕ ""
		КОНЕЦ
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		НДФЛРасчетыСБюджетом.Организация,
		ВЫБОР
			КОГДА &amp;ФизЛицо
				ТОГДА НДФЛРасчетыСБюджетом.ФизЛицо
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
		КОНЕЦ,
		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		ВЫБОР
			КОГДА &amp;Вычет
				ТОГДА ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код611)
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка)
		КОНЕЦ,
		СУММА(НДФЛРасчетыСБюджетом.ПримененныйВычетНаДетейЛьгота),
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		ВЫБОР
			КОГДА &amp;Регистратор
				ТОГДА НДФЛРасчетыСБюджетом.Регистратор
			ИНАЧЕ ""
		КОНЕЦ,
		ВЫБОР
			КОГДА &amp;СтавкаНалогообложенияРезидента
				ТОГДА ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.Ставка13)
			ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.ПустаяССылка)
		КОНЕЦ
	ИЗ
		РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
	ГДЕ
		//vvv
		//НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		НДФЛРасчетыСБюджетом.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		//
		И НДФЛРасчетыСБюджетом.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	
	СГРУППИРОВАТЬ ПО
		НДФЛРасчетыСБюджетом.Организация,
		ВЫБОР
			КОГДА &amp;ФизЛицо
				ТОГДА НДФЛРасчетыСБюджетом.ФизЛицо
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
		КОНЕЦ,
		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		ВЫБОР
			КОГДА &amp;Регистратор
				ТОГДА НДФЛРасчетыСБюджетом.Регистратор
			ИНАЧЕ ""
		КОНЕЦ
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		НДФЛРасчетыСБюджетом.Организация,
		ВЫБОР
			КОГДА &amp;ФизЛицо
				ТОГДА НДФЛРасчетыСБюджетом.ФизЛицо
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
		КОНЕЦ,
		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		ВЫБОР
			КОГДА &amp;Вычет
				ТОГДА ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код620)
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка)
		КОНЕЦ,
		СУММА(НДФЛРасчетыСБюджетом.ПримененныйДополнительныйВычет),
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		ВЫБОР
			КОГДА &amp;Регистратор
				ТОГДА НДФЛРасчетыСБюджетом.Регистратор
			ИНАЧЕ ""
		КОНЕЦ,
		ВЫБОР
			КОГДА &amp;СтавкаНалогообложенияРезидента
				ТОГДА ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.Ставка13)
			ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.ПустаяССылка)
		КОНЕЦ
	ИЗ
		РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
	ГДЕ
		//vvv
		//НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		НДФЛРасчетыСБюджетом.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
		//
		И НДФЛРасчетыСБюджетом.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	
	СГРУППИРОВАТЬ ПО
		НДФЛРасчетыСБюджетом.Организация,
		ВЫБОР
			КОГДА &amp;ФизЛицо
				ТОГДА НДФЛРасчетыСБюджетом.ФизЛицо
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяССылка)
		КОНЕЦ,
		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		ВЫБОР
			КОГДА &amp;Регистратор
				ТОГДА НДФЛРасчетыСБюджетом.Регистратор
			ИНАЧЕ ""
		КОНЕЦ) КАК СведенияОВычетах

СГРУППИРОВАТЬ ПО
	СведенияОВычетах.ГоловнаяОрганизация,
	СведенияОВычетах.ПериодРегистрации,
	СведенияОВычетах.ПериодВзаиморасчетов,
	СведенияОВычетах.Регистратор,
	СведенияОВычетах.ФизЛицо,
	СведенияОВычетах.Вычет,
	СведенияОВычетах.Организация,
	СведенияОВычетах.СтавкаНалогообложенияРезидента,
	СведенияОВычетах.ПериодРегистрации
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	НалогНДФЛ.ГоловнаяОрганизация,
	НалогНДФЛ.ФизЛицо,
	НалогНДФЛ.Организация,
	НалогНДФЛ.ПериодРегистрации,
	НалогНДФЛ.ПериодВзаиморасчетов,
	НалогНДФЛ.КодДохода КАК КодДохода,
	НалогНДФЛ.Регистратор КАК Регистратор,
	НалогНДФЛ.СтавкаНалогообложенияРезидента,
	"" КАК ВидРасчета,
	ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка) КАК Вычет,
	ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка) КАК ВидДеятельности,
	ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ПустаяСсылка) КАК ВидДохода,
	"" КАК ВидПособия,
	"" КАК ПроцентОплатыПособия,
	НалогНДФЛ.ВидТаблицы КАК ВидТаблицы
ПОМЕСТИТЬ ПоляОтчета
ИЗ
	НалогНДФЛ КАК НалогНДФЛ

ОБЪЕДИНИТЬ

ВЫБРАТЬ РАЗЛИЧНЫЕ
	БазаНДФЛ.ГоловнаяОрганизация,
	БазаНДФЛ.ФизЛицо,
	БазаНДФЛ.Организация,
	БазаНДФЛ.ПериодРегистрации,
	БазаНДФЛ.ПериодВзаиморасчетов,
	БазаНДФЛ.КодДохода,
	БазаНДФЛ.Регистратор,
	БазаНДФЛ.СтавкаНалогообложенияРезидента,
	БазаНДФЛ.ВидРасчета,
	ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка),
	ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка),
	ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ПустаяСсылка),
	"",
	"",
	БазаНДФЛ.ВидТаблицы
ИЗ
	БазаНДФЛ КАК БазаНДФЛ

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВычетыНДФЛ.ГоловнаяОрганизация,
	ВычетыНДФЛ.ФизЛицо,
	ВычетыНДФЛ.Организация,
	ВычетыНДФЛ.ПериодРегистрации,
	ВычетыНДФЛ.ПериодВзаиморасчетов,
	"",
	ВычетыНДФЛ.Регистратор,
	ВычетыНДФЛ.СтавкаНалогообложенияРезидента,
	"",
	ВычетыНДФЛ.Вычет,
	ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка),
	ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ПустаяСсылка),
	"",
	"",
	ВычетыНДФЛ.ВидТаблицы
ИЗ
	ВычетыНДФЛ КАК ВычетыНДФЛ

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	БазаВзносов.ГоловнаяОрганизация,
	БазаВзносов.ФизЛицо,
	БазаВзносов.Организация,
	БазаВзносов.ПериодРегистрации,
	БазаВзносов.ПериодВзаиморасчетов,
	"",
	БазаВзносов.Регистратор,
	ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.ПустаяССылка),
	"",
	ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка),
	БазаВзносов.ВидДеятельности,
	БазаВзносов.ВидДохода,
	"",
	"",
	БазаВзносов.ВидТаблицы
ИЗ
	ВТБазаВзносов КАК БазаВзносов

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	Взносы.ГоловнаяОрганизация,
	Взносы.ФизЛицо,
	Взносы.Организация,
	Взносы.ПериодРегистрации,
	Взносы.ПериодВзаиморасчетов,
	"",
	Взносы.Регистратор,
	ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.ПустаяССылка),
	"",
	ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка),
	Взносы.ВидДеятельности,
	ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ПустаяСсылка),
	"",
	"",
	Взносы.ВидТаблицы
ИЗ
	ВТВзносы КАК Взносы

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ПособияИзФСЗН.Организация,
	ПособияИзФСЗН.ФизЛицо,
	ПособияИзФСЗН.Организация,
	ПособияИзФСЗН.Период,
	ПособияИзФСЗН.Период,
	"",
	ПособияИзФСЗН.Регистратор,
	ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.ПустаяССылка),
	"",
	ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка),
	ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка),
	ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ПустаяСсылка),
	ПособияИзФСЗН.ВидПособия,
	ПособияИзФСЗН.ПроцентОплатыПособия,
	ПособияИзФСЗН.ВидТаблицы
ИЗ
	ВТПособияИзФСЗН КАК ПособияИзФСЗН
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ПоляОтчета.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
	ПоляОтчета.Организация КАК Организация,
	ПоляОтчета.ПериодРегистрации КАК ПериодРегистрации,
	ПоляОтчета.ПериодВзаиморасчетов КАК ПериодВзаиморасчетов,
	ПоляОтчета.ФизЛицо КАК ФизЛицо,
	ПоляОтчета.КодДохода КАК КодДохода,
	ПоляОтчета.СтавкаНалогообложенияРезидента КАК СтавкаНалогообложенияРезидента,
	ПоляОтчета.Регистратор КАК Регистратор,
	ПоляОтчета.ВидРасчета КАК ВидРасчета,
	ПоляОтчета.Вычет КАК Вычет,
	ПоляОтчета.ВидДохода КАК ВидДохода,
	ПоляОтчета.ВидДеятельности КАК ВидДеятельности,
	ЕСТЬNULL(НалогНДФЛ.Налог, 0) КАК НалогНДФЛ,
	ЕСТЬNULL(БазаНДФЛ.Результат, 0) КАК БазаНДФЛ,
	ЕСТЬNULL(НалогНДФЛ.НалогУдержаный, 0) КАК НалогНДФЛУдержаный,
	ЕСТЬNULL(ВычетыНДФЛ.СуммаВычета, 0) КАК СуммаВычетаНДФЛ,
	ЕСТЬNULL(БазаНДФЛ.СуммаДоходаНеОблагаемая, 0) КАК СуммаДоходаНеОблагаемая,
	ЕСТЬNULL(БазаВзносов.Доход, 0) КАК Доход,
	ЕСТЬNULL(БазаВзносов.БазаФСЗН, 0) КАК БазаФСЗН,
	ЕСТЬNULL(БазаВзносов.БазаСтрах, 0) КАК БазаСтрах,
	ЕСТЬNULL(БазаВзносов.БазаППС, 0) КАК БазаППС,
	ЕСТЬNULL(БазаВзносов.НеОблагаетсяЦеликом, 0) КАК НеОблагаетсяЦеликом,
	ЕСТЬNULL(БазаВзносов.ПособияИзФонда, 0) КАК ПособияИзФонда,
	ЕСТЬNULL(БазаВзносов.ПособияНеВходящиеВПУ, 0) КАК ПособияНеВходящиеВПУ,
	ЕСТЬNULL(Взносы.ФСЗН, 0) КАК ФСЗН,
	ЕСТЬNULL(Взносы.ОбязательноеСтрахование, 0) КАК ОбязательноеСтрахование,
	ЕСТЬNULL(Взносы.ППС, 0) КАК ППС,
	ЕСТЬNULL(Взносы.ПенсионныйФонд, 0) КАК ПенсионныйФонд,
	ЕСТЬNULL(ПособияИзФСЗН.КоличествоПособий, 0) КАК КоличествоПособий,
	ЕСТЬNULL(ПособияИзФСЗН.ОплаченныеДни, 0) КАК ОплаченыеДни,
	ЕСТЬNULL(ПособияИзФСЗН.Сумма, 0) КАК СуммаПособий,
	ПоляОтчета.ВидПособия КАК ВидПособия,
	ПоляОтчета.ПроцентОплатыПособия КАК ПроцентОплатыПособия,
	ЕСТЬNULL(Взносы.ПроцентФСЗН, 0) КАК ПроцентФСЗН
{ВЫБРАТЬ
	ГоловнаяОрганизация.*,
	ФизЛицо.*,
	Организация.*,
	ПериодРегистрации,
	ПериодВзаиморасчетов,
	КодДохода.*,
	СтавкаНалогообложенияРезидента.* КАК СтавкаНалогообложенияРезидента,
	Регистратор.*,
	ВидДеятельности.*,
	НалогНДФЛ КАК НалогНДФЛ,
	БазаНДФЛ КАК БазаНДФЛ,
	ВидРасчета.*,
	НалогНДФЛУдержаный,
	СуммаВычетаНДФЛ,
	Вычет.*,
	ВидДохода.*,
	СуммаДоходаНеОблагаемая,
	Доход,
	БазаФСЗН,
	БазаСтрах,
	БазаППС,
	НеОблагаетсяЦеликом,
	ПособияИзФонда,
	ФСЗН,
	ОбязательноеСтрахование,
	ППС,
	ПенсионныйФонд,
	ПособияНеВходящиеВПУ,
	ВидПособия.*,
	ПроцентОплатыПособия,
	СуммаПособий,
	ОплаченыеДни,
	КоличествоПособий,
	ПроцентФСЗН}
ИЗ
	ПоляОтчета КАК ПоляОтчета
		ЛЕВОЕ СОЕДИНЕНИЕ БазаНДФЛ КАК БазаНДФЛ
		ПО ПоляОтчета.ФизЛицо = БазаНДФЛ.ФизЛицо
			И ПоляОтчета.ГоловнаяОрганизация = БазаНДФЛ.ГоловнаяОрганизация
			И ПоляОтчета.Организация = БазаНДФЛ.Организация
			И ПоляОтчета.ПериодРегистрации = БазаНДФЛ.ПериодРегистрации
			И ПоляОтчета.ПериодВзаиморасчетов = БазаНДФЛ.ПериодВзаиморасчетов
			И ПоляОтчета.КодДохода = БазаНДФЛ.КодДохода
			И ПоляОтчета.Регистратор = БазаНДФЛ.Регистратор
			И ПоляОтчета.СтавкаНалогообложенияРезидента = БазаНДФЛ.СтавкаНалогообложенияРезидента
			И ПоляОтчета.ВидРасчета = БазаНДФЛ.ВидРасчета
			И ПоляОтчета.ВидТаблицы = БазаНДФЛ.ВидТаблицы
		ЛЕВОЕ СОЕДИНЕНИЕ НалогНДФЛ КАК НалогНДФЛ
		ПО ПоляОтчета.ГоловнаяОрганизация = НалогНДФЛ.ГоловнаяОрганизация
			И ПоляОтчета.Организация = НалогНДФЛ.Организация
			И ПоляОтчета.ПериодРегистрации = НалогНДФЛ.ПериодРегистрации
			И ПоляОтчета.ПериодВзаиморасчетов = НалогНДФЛ.ПериодВзаиморасчетов
			И ПоляОтчета.КодДохода = НалогНДФЛ.КодДохода
			И ПоляОтчета.Регистратор = НалогНДФЛ.Регистратор
			И ПоляОтчета.СтавкаНалогообложенияРезидента = НалогНДФЛ.СтавкаНалогообложенияРезидента
			И ПоляОтчета.ФизЛицо = НалогНДФЛ.ФизЛицо
			И ПоляОтчета.ВидТаблицы = НалогНДФЛ.ВидТаблицы
		ЛЕВОЕ СОЕДИНЕНИЕ ВычетыНДФЛ КАК ВычетыНДФЛ
		ПО ПоляОтчета.ГоловнаяОрганизация = ВычетыНДФЛ.ГоловнаяОрганизация
			И ПоляОтчета.ФизЛицо = ВычетыНДФЛ.ФизЛицо
			И ПоляОтчета.Организация = ВычетыНДФЛ.Организация
			И ПоляОтчета.ПериодРегистрации = ВычетыНДФЛ.ПериодРегистрации
			И ПоляОтчета.ПериодВзаиморасчетов = ВычетыНДФЛ.ПериодВзаиморасчетов
			И ПоляОтчета.Вычет = ВычетыНДФЛ.Вычет
			И ПоляОтчета.СтавкаНалогообложенияРезидента = ВычетыНДФЛ.СтавкаНалогообложенияРезидента
			И ПоляОтчета.Регистратор = ВычетыНДФЛ.Регистратор
			И ПоляОтчета.ВидТаблицы = ВычетыНДФЛ.ВидТаблицы
		ЛЕВОЕ СОЕДИНЕНИЕ ВТБазаВзносов КАК БазаВзносов
		ПО ПоляОтчета.ГоловнаяОрганизация = БазаВзносов.ГоловнаяОрганизация
			И ПоляОтчета.ФизЛицо = БазаВзносов.ФизЛицо
			И ПоляОтчета.Организация = БазаВзносов.Организация
			И ПоляОтчета.ПериодРегистрации = БазаВзносов.ПериодРегистрации
			И ПоляОтчета.ПериодВзаиморасчетов = БазаВзносов.ПериодВзаиморасчетов
			И ПоляОтчета.ВидДохода = БазаВзносов.ВидДохода
			И ПоляОтчета.Регистратор = БазаВзносов.Регистратор
			И ПоляОтчета.ВидДеятельности = БазаВзносов.ВидДеятельности
			И ПоляОтчета.ВидТаблицы = БазаВзносов.ВидТаблицы
		ЛЕВОЕ СОЕДИНЕНИЕ ВТВзносы КАК Взносы
		ПО ПоляОтчета.ГоловнаяОрганизация = Взносы.ГоловнаяОрганизация
			И ПоляОтчета.ФизЛицо = Взносы.ФизЛицо
			И ПоляОтчета.Организация = Взносы.Организация
			И ПоляОтчета.ПериодРегистрации = Взносы.ПериодРегистрации
			И ПоляОтчета.ПериодВзаиморасчетов = Взносы.ПериодВзаиморасчетов
			И ПоляОтчета.Регистратор = Взносы.Регистратор
			И ПоляОтчета.ВидДеятельности = Взносы.ВидДеятельности
			И ПоляОтчета.ВидТаблицы = Взносы.ВидТаблицы
		ЛЕВОЕ СОЕДИНЕНИЕ ВТПособияИзФСЗН КАК ПособияИзФСЗН
		ПО ПоляОтчета.ГоловнаяОрганизация = ПособияИзФСЗН.Организация
			И ПоляОтчета.ФизЛицо = ПособияИзФСЗН.ФизЛицо
			И ПоляОтчета.Организация = ПособияИзФСЗН.Организация
			И ПоляОтчета.ПериодРегистрации = ПособияИзФСЗН.Период
			И ПоляОтчета.ПериодВзаиморасчетов = ПособияИзФСЗН.Период
			И ПоляОтчета.Регистратор = ПособияИзФСЗН.Регистратор
			И ПоляОтчета.ВидПособия = ПособияИзФСЗН.ВидПособия
			И ПоляОтчета.ВидТаблицы = ПособияИзФСЗН.ВидТаблицы
{ГДЕ
	ПоляОтчета.ГоловнаяОрганизация.*,
	ПоляОтчета.ФизЛицо.*,
	ПоляОтчета.Организация.*,
	ПоляОтчета.ПериодРегистрации,
	ПоляОтчета.ПериодВзаиморасчетов,
	ПоляОтчета.КодДохода.*,
	ПоляОтчета.СтавкаНалогообложенияРезидента.* КАК СтавкаНалогообложенияРезидента,
	ПоляОтчета.Регистратор.*,
	ПоляОтчета.ВидДеятельности.*,
	ПоляОтчета.ВидДохода.*,
	ПоляОтчета.Вычет.*,
	ПоляОтчета.ВидПособия.*,
	ПоляОтчета.ПроцентОплатыПособия,
	(ЕСТЬNULL(НалогНДФЛ.Налог, 0)) КАК НалогНДФЛ,
	(ЕСТЬNULL(БазаНДФЛ.Результат, 0)) КАК БазаНДФЛ,
	(ЕСТЬNULL(НалогНДФЛ.НалогУдержаный, 0)) КАК НалогНДФЛУдержаный,
	(ЕСТЬNULL(ВычетыНДФЛ.СуммаВычета, 0)) КАК СуммаВычетаНДФЛ,
	(ЕСТЬNULL(БазаНДФЛ.СуммаДоходаНеОблагаемая, 0)) КАК СуммаДоходаНеОблагаемая,
	(ЕСТЬNULL(БазаВзносов.Доход, 0)) КАК Доход,
	(ЕСТЬNULL(БазаВзносов.БазаФСЗН, 0)) КАК БазаФСЗН,
	(ЕСТЬNULL(БазаВзносов.БазаППС, 0)) КАК БазаППС,
	(ЕСТЬNULL(БазаВзносов.ПособияИзФонда, 0)) КАК ПособияИзФонда,
	(ЕСТЬNULL(БазаВзносов.ПособияНеВходящиеВПУ, 0)) КАК ПособияНеВходящиеВПУ,
	(ЕСТЬNULL(БазаВзносов.БазаСтрах, 0)) КАК БазаСтрах,
	(ЕСТЬNULL(БазаВзносов.НеОблагаетсяЦеликом, 0)) КАК НеОблагаетсяЦеликом,
	(ЕСТЬNULL(Взносы.ФСЗН, 0)) КАК ФСЗН,
	(ЕСТЬNULL(Взносы.ППС, 0)) КАК ППС,
	(ЕСТЬNULL(Взносы.ОбязательноеСтрахование, 0)) КАК ОбязательноеСтрахование,
	(ЕСТЬNULL(Взносы.ПенсионныйФонд, 0)) КАК ПенсионныйФонд,
	(ЕСТЬNULL(Взносы.ПроцентФСЗН, 0)) КАК ПроцентФСЗН,
	//vvv добавим, т.к. в противном случае в таблицу пособий попадают ВСЕ сотрудники,
	//а не только те, которые имели пособие в данном периоде
	(ЕСТЬNULL(ПособияИзФСЗН.Сумма, 0)) КАК СуммаПособий}
	//</query>
		<autoFillFields>false</autoFillFields>
	</dataSet>
	<dataSet xsi:type="DataSetQuery">
		<name>ФИОРаботников</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПериодРегистрации</dataPath>
			<field>ПериодРегистрации</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Период регистрации</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФизЛицо</dataPath>
			<field>ФизЛицо</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Физ лицо</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</useRestriction>
			<attributeUseRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФИО</dataPath>
			<field>ФИО</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>ФИО</v8:content>
				</v8:item>
			</title>
		</field>
		<dataSource>ИнформационнаяБаза</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации
ПОМЕСТИТЬ Периоды
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
;

ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ФИОФизЛиц.ФизЛицо КАК ФизЛицо,
	ДатыПоследнихДвижений.ПериодРегистрации КАК ПериодРегистрации,
	ФИОФизЛиц.Фамилия + " " + ФИОФизЛиц.Имя + " " + ФИОФизЛиц.Отчество КАК ФИО
{ВЫБРАТЬ
	ФИО,
	ФизЛицо.*,
	ПериодРегистрации}
ИЗ
	(ВЫБРАТЬ
		Периоды.ПериодРегистрации КАК ПериодРегистрации,
		ФИОФизЛиц.ФизЛицо КАК ФизЛицо,
		МАКСИМУМ(ФИОФизЛиц.Период) КАК Период
	ИЗ
		Периоды КАК Периоды
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц КАК ФИОФизЛиц
			ПО (КОНЕЦПЕРИОДА(Периоды.ПериодРегистрации, МЕСЯЦ) &gt;= ФИОФизЛиц.Период)
	{ГДЕ
		Периоды.ПериодРегистрации,
		ФИОФизЛиц.ФизЛицо.*}
	
	СГРУППИРОВАТЬ ПО
		Периоды.ПериодРегистрации,
		ФИОФизЛиц.ФизЛицо) КАК ДатыПоследнихДвижений
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц КАК ФИОФизЛиц
		ПО ДатыПоследнихДвижений.ФизЛицо = ФИОФизЛиц.ФизЛицо
			И ДатыПоследнихДвижений.Период = ФИОФизЛиц.Период
{ГДЕ
	ФИОФизЛиц.ФизЛицо.*,
	ДатыПоследнихДвижений.ПериодРегистрации}</query>
	</dataSet>
	<dataSetLink>
		<sourceDataSet>Данные</sourceDataSet>
		<destinationDataSet>ФИОРаботников</destinationDataSet>
		<sourceExpression>ФизЛицо</sourceExpression>
		<destinationExpression>ФизЛицо</destinationExpression>
	</dataSetLink>
	<dataSetLink>
		<sourceDataSet>Данные</sourceDataSet>
		<destinationDataSet>ФИОРаботников</destinationDataSet>
		<sourceExpression>ПериодРегистрации</sourceExpression>
		<destinationExpression>ПериодРегистрации</destinationExpression>
	</dataSetLink>
	<totalField>
		<dataPath>НДФЛ.БазаНДФЛ</dataPath>
		<expression>Сумма(НДФЛ.БазаНДФЛ)</expression>
	</totalField>
	<totalField>
		<dataPath>НДФЛ.ВычетаНДФЛ</dataPath>
		<expression>Сумма(НДФЛ.ВычетаНДФЛ)</expression>
	</totalField>
	<totalField>
		<dataPath>НДФЛ.НалогНДФЛ</dataPath>
		<expression>Сумма(НДФЛ.НалогНДФЛ)</expression>
	</totalField>
	<totalField>
		<dataPath>НДФЛ.НалогНДФЛУдержаный</dataPath>
		<expression>Сумма(НДФЛ.НалогНДФЛУдержаный)</expression>
	</totalField>
	<totalField>
		<dataPath>НДФЛ.СуммаДоходаНеОблагаемая</dataPath>
		<expression>Сумма(НДФЛ.СуммаДоходаНеОблагаемая)</expression>
	</totalField>
	<totalField>
		<dataPath>Взносы.БазаФСЗН</dataPath>
		<expression>Сумма(Взносы.БазаФСЗН)</expression>
	</totalField>
	<totalField>
		<dataPath>Взносы.ОбязательноеСтрахование</dataPath>
		<expression>Сумма(Взносы.ОбязательноеСтрахование)</expression>
	</totalField>
	<totalField>
		<dataPath>Взносы.ПенсионныйФонд</dataPath>
		<expression>Сумма(Взносы.ПенсионныйФонд)</expression>
	</totalField>
	<totalField>
		<dataPath>Взносы.ПособияИзФонда</dataPath>
		<expression>Сумма(Взносы.ПособияИзФонда)</expression>
	</totalField>
	<totalField>
		<dataPath>Взносы.Доход</dataPath>
		<expression>Сумма(Взносы.Доход)</expression>
	</totalField>
	<totalField>
		<dataPath>Взносы.БазаСтрах</dataPath>
		<expression>Сумма(Взносы.БазаСтрах)</expression>
	</totalField>
	<totalField>
		<dataPath>Взносы.НеОблагаетсяЦеликом</dataPath>
		<expression>Сумма(Взносы.НеОблагаетсяЦеликом)</expression>
	</totalField>
	<totalField>
		<dataPath>Взносы.ФСЗН</dataPath>
		<expression>Сумма(Взносы.ФСЗН)</expression>
	</totalField>
	<totalField>
		<dataPath>Взносы.БазаППС</dataPath>
		<expression>Сумма(Взносы.БазаППС)</expression>
	</totalField>
	<totalField>
		<dataPath>Взносы.ППС</dataPath>
		<expression>Сумма(Взносы.ППС)</expression>
	</totalField>
	<totalField>
		<dataPath>Взносы.ПособияНеВходящиеВПУ</dataPath>
		<expression>Сумма(Взносы.ПособияНеВходящиеВПУ)</expression>
	</totalField>
	<totalField>
		<dataPath>ПособияИзФСЗН.КоличествоПособий</dataPath>
		<expression>Сумма(ПособияИзФСЗН.КоличествоПособий)</expression>
	</totalField>
	<totalField>
		<dataPath>ПособияИзФСЗН.ОплаченыеДни</dataPath>
		<expression>Сумма(ПособияИзФСЗН.ОплаченыеДни)</expression>
	</totalField>
	<totalField>
		<dataPath>ПособияИзФСЗН.СуммаПособий</dataPath>
		<expression>Сумма(ПособияИзФСЗН.СуммаПособий)</expression>
	</totalField>
	<parameter>
		<name>КонецПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>Date</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>НачалоПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Начало периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>Date</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>КодДохода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Код дохода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>Регистратор</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Регистратор</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>СтавкаНалогообложенияРезидента</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Ставка налогообложения резидента</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>ФизЛицо</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Физ лицо</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>Вычет</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Вычет</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>ВидДохода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Вид дохода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>ВидРасчета</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Вид расчета</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>Инвалид</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Инвалид</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>ВидДеятельности</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Вид деятельности</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
			<dcsset:outputParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыводитьЗаголовок</dcscor:parameter>
					<dcscor:value xsi:type="dcsset:DataCompositionTextOutputType">DontOutput</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>Заголовок</dcscor:parameter>
					<dcscor:value xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Анализ налогов и взносов</v8:content>
						</v8:item>
					</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыводитьПараметрыДанных</dcscor:parameter>
					<dcscor:value xsi:type="dcsset:DataCompositionTextOutputType">DontOutput</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыводитьОтбор</dcscor:parameter>
					<dcscor:value xsi:type="dcsset:DataCompositionTextOutputType">DontOutput</dcscor:value>
				</dcscor:item>
			</dcsset:outputParameters>
		</dcsset:settings>
	</settingsVariant>
</DataCompositionSchema>