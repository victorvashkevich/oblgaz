////////////////////////////////////////////////////////////////////////////////
// ПЕРЕМЕННЫЕ МОДУЛЯ

Перем НачисленияУдержания                        Экспорт; // Таблица значений - внешний источник данных
Перем СохраненнаяНастройка                       Экспорт; // Текущий вариант отчета
Перем ТаблицаВариантовОтчета                     Экспорт; // Таблица вариантов доступных текущему пользователю
Перем СписокПолейОтбора                          Экспорт; // Список названий поле схемы компоновки по которым можно устанавливать отбор
Перем ЭлементНастройкиРасчетногоЛистка           Экспорт; // Элемент структуры настройки схемы компоновки данных
Перем ТекстЗапроса                               Экспорт;
Перем ИмяМакетаНачало;
Перем ИмяМакетаКонец;
Перем НастройкаШириныКолонокРасчетногоЛистка     Экспорт;
Перем НастройкаРазмТекстаКолонокРасчетногоЛистка Экспорт;
Перем СоответствиеНаборовДанныхИЗапросов;


////////////////////////////////////////////////////////////////////////////////
// ВСПОМОГАТЕЛЬНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ 
// 

// Осуществляет рекурсивный поиск элемента группировки с именем "ШапкаРасчетногоЛистка"
//
Процедура ПроверитьВложенныеЭлементы(ЭлементСтруктурыГруппировки , ЭлементНайден)
	
	Для Каждого ЭлементСтруктуры из ЭлементСтруктурыГруппировки.Структура Цикл
		
		Если ЭлементНайден тогда
			Возврат;
		КонецЕсли;
		
		Если ЭлементСтруктуры.Имя = "ШапкаРасчетногоЛистка" тогда
			
			ЭлементНастройкиРасчетногоЛистка = ЭлементСтруктуры;
			ЭлементСтруктурыГруппировки.Структура.Удалить(ЭлементСтруктуры);
			ЭлементНайден = истина;
			Возврат;
			
		Иначе
			
			ПроверитьВложенныеЭлементы(ЭлементСтруктуры , ЭлементНайден);
			
		КонецЕсли;
	КонецЦикла;
	
КонецПроцедуры

// Запоминает настройку группировки расчетного листка
//
Процедура ЗапомнитьНастройкуРасчетногоЛистка() Экспорт
	
	// Найдем элемент группировки с названием "ШапкаРасчетногоЛистка"
	ЭлементНайден = Ложь;
	Для Каждого ЭлементСтруктурыГруппировки из КомпоновщикНастроек.Настройки.Структура Цикл
		
		Если ЭлементСтруктурыГруппировки.Имя = "ШапкаРасчетногоЛистка" тогда
			
			ЭлементНастройкиРасчетногоЛистка = ЭлементСтруктурыГруппировки;
			КомпоновщикНастроек.Настройки.Структура.Удалить(ЭлементСтруктурыГруппировки);
			ЭлементНайден = Истина;
			Возврат;
			
		Иначе
			
			// Рекурсивно проверим остальные элементы структуры
			ПроверитьВложенныеЭлементы(ЭлементСтруктурыГруппировки , ЭлементНайден);
			
		КонецЕсли;
	КонецЦикла;
	
КонецПроцедуры

Процедура ДобавитьСтруктуруРасчетногоЛистка(Структура)
	
	ЭлементСтруктурыРасчетногоЛистка = Структура.Добавить(ТипЗнч(ЭлементНастройкиРасчетногоЛистка));
	
	ТиповыеОтчеты.СкопироватьНастройкиКомпоновкиДанных(ЭлементСтруктурыРасчетногоЛистка, ЭлементНастройкиРасчетногоЛистка);
	
	ЭлементСтруктурыРасчетногоЛистка.Имя                           = "ШапкаРасчетногоЛистка";
	ЭлементСтруктурыРасчетногоЛистка.Структура[0].Имя              = "Начисление";
	ЭлементСтруктурыРасчетногоЛистка.Структура[0].Структура[0].Имя = "СтрокаНачисленийУдержаний";
	ЭлементСтруктурыРасчетногоЛистка.Структура[1].Имя              = "Удержание";
	ЭлементСтруктурыРасчетногоЛистка.Структура[1].Структура[0].Имя = "СтрокаНачисленийУдержаний";
	ЭлементСтруктурыРасчетногоЛистка.Структура[2].Имя              = "Сальдо";
	
КонецПроцедуры

// Добавление поля в таблицу выбранных полей из таблицы группировок
//
Процедура ДобавитьГруппировкиВВыводимыеПоля(ЭлементСтруктуры)
	
	ЭлементСтруктуры.Выбор.Элементы.Очистить();
	
	ЭлементСтруктуры.ПараметрыВывода.Элементы.Найти("TemplateType").Значение      = ТипМакетаГруппировкиКомпоновкиДанных.Вертикальный;
	ЭлементСтруктуры.ПараметрыВывода.Элементы.Найти("TemplateType").Использование = истина;
	
	Для каждого ЭлементИсточник Из ЭлементСтруктуры.ПоляГруппировки.Элементы Цикл
		
		ДоступноеПоле = ЭлементСтруктуры.Выбор.ДоступныеПоляВыбора.НайтиПоле(Новый ПолеКомпоновкиДанных(Строка(ЭлементИсточник.Поле)));
		Если ДоступноеПоле <> Неопределено тогда
			ЭлементПриемник               = ЭлементСтруктуры.Выбор.Элементы.Добавить(Тип("ВыбранноеПолеКомпоновкиДанных"));
			ЭлементПриемник.Поле          = ДоступноеПоле.Поле;
			ЭлементПриемник.Заголовок     = ДоступноеПоле.Заголовок;
			ЭлементПриемник.Использование = истина;
		КонецЕсли;
		
	КонецЦикла;
	
КонецПроцедуры

// Поиск последнего уровня иерархии группировки
//
Процедура НайтиСледующийУровень(ЭлементСтруктурыГруппировки)
	
	Для Каждого ЭлементСтруктуры из ЭлементСтруктурыГруппировки.Структура Цикл
		
		Если ЭлементСтруктуры.Имя = "ШапкаРасчетногоЛистка" тогда
			ЭлементСтруктурыГруппировки.Структура.Удалить(ЭлементСтруктуры);
			ДобавитьСтруктуруРасчетногоЛистка(ЭлементСтруктурыГруппировки.Структура);
			Возврат;
		КонецЕсли;
		
		Если ЭлементСтруктуры.Структура.Количество() <> 0 тогда
			Если ЭлементСтруктуры.ПоляГруппировки.Элементы.Количество() <> 0 тогда
				
				ДобавитьГруппировкиВВыводимыеПоля(ЭлементСтруктуры);
				НайтиСледующийУровень(ЭлементСтруктуры);
				
			Иначе
				
				ЭлементСтруктурыГруппировки.Структура.Удалить(ЭлементСтруктуры);
				
				ДобавитьСтруктуруРасчетногоЛистка(ЭлементСтруктурыГруппировки.Структура);
				
			КонецЕсли;
		Иначе
			Если ЭлементСтруктуры.ПоляГруппировки.Элементы.Количество() = 0 тогда
				
				ЭлементСтруктурыГруппировки.Структура.Удалить(ЭлементСтруктуры);
				ДобавитьСтруктуруРасчетногоЛистка(ЭлементСтруктурыГруппировки.Структура);
				
			Иначе
				
				ДобавитьГруппировкиВВыводимыеПоля(ЭлементСтруктуры);
				ДобавитьСтруктуруРасчетногоЛистка(ЭлементСтруктуры.Структура);
				
			КонецЕсли;
			
		КонецЕсли;
	КонецЦикла;
	
КонецПроцедуры

// Добавление расчетного листка в настройку схемы компоновки
//
Процедура ВосстановитьНастройкуРасчетногоЛистка() Экспорт
	
	Если КомпоновщикНастроек.Настройки.Структура.Количество() = 0 тогда
		
		ДобавитьСтруктуруРасчетногоЛистка(КомпоновщикНастроек.Настройки.Структура);
		
	Иначе
		
		Для Каждого ЭлементСтруктурыГруппировки из КомпоновщикНастроек.Настройки.Структура Цикл
			
			Если ТипЗнч(ЭлементСтруктурыГруппировки) <> Тип("ГруппировкаКомпоновкиДанных") тогда
				КомпоновщикНастроек.Настройки.Структура.Удалить(ЭлементСтруктурыГруппировки);
				ДобавитьСтруктуруРасчетногоЛистка(КомпоновщикНастроек.Настройки.Структура);
				Возврат;
			КонецЕсли;
			
			Если ЭлементСтруктурыГруппировки.Структура.Количество() <> 0 тогда
				Если ЭлементСтруктурыГруппировки.ПоляГруппировки.Элементы.Количество() <> 0 тогда
					
					ДобавитьГруппировкиВВыводимыеПоля(ЭлементСтруктурыГруппировки); 
					НайтиСледующийУровень(ЭлементСтруктурыГруппировки);
					
				Иначе
					
					КомпоновщикНастроек.Настройки.Структура.Удалить(ЭлементСтруктурыГруппировки);
					
					ДобавитьСтруктуруРасчетногоЛистка(КомпоновщикНастроек.Настройки.Структура);
					
				КонецЕсли;
				
			Иначе
				
				Если ЭлементСтруктурыГруппировки.ПоляГруппировки.Элементы.Количество() = 0 тогда
					
					КомпоновщикНастроек.Настройки.Структура.Удалить(ЭлементСтруктурыГруппировки);
					ДобавитьСтруктуруРасчетногоЛистка(КомпоновщикНастроек.Настройки.Структура);
					
				Иначе
					
					ДобавитьГруппировкиВВыводимыеПоля(ЭлементСтруктурыГруппировки);
					ДобавитьСтруктуруРасчетногоЛистка(ЭлементСтруктурыГруппировки.Структура);
					
				КонецЕсли;
				
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
	
КонецПроцедуры

// Удаление элементов структуры настройки	
//	
Процедура УдалитьГруппировку()
	
	ЗапомнитьНастройкуРасчетногоЛистка();
	
	Настройки = КомпоновщикНастроек.Настройки;
	
	Если Настройки.Структура.Количество() <> 0 тогда
		Настройки.Структура.Удалить(Настройки.Структура[0]);
	КОнецЕсли;
	
	ВосстановитьНастройкуРасчетногоЛистка();
	
КонецПроцедуры

// Настраивает построитель запросов
//
Процедура НастроитьПостроительЗапросов(ПостроительОтчетов, ВидРасчетногоЛистка) Экспорт
	
	ДатаНач = КомпоновщикНастроек.Настройки.ПараметрыДанных.Элементы.Найти("НачалоПериода").Значение;
	ДатаКон = КомпоновщикНастроек.Настройки.ПараметрыДанных.Элементы.Найти("КонецПериода").Значение;
	
	// Заполнить параметры построителя запросов
	ПостроительОтчетов.Параметры.Вставить("парамПустаяОрганизация",  Справочники.Организации.ПустаяСсылка());
	ПостроительОтчетов.Параметры.Вставить("ПериодРегистрации", 	  	 ДатаНач);
	ПостроительОтчетов.Параметры.Вставить("КонецПериодаРегистрации", КонецДня(ДатаКон));
	ПостроительОтчетов.Параметры.Вставить("НачалоПериода", 	  	     ДатаНач);
	ПостроительОтчетов.Параметры.Вставить("КонецПериода", 	         КонецДня(ДатаКон));
	
	НачислениеВозврат = Новый Массив;
	НачислениеВозврат.Добавить(Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление);
	//НачислениеВозврат.Добавить(Перечисления.НДФЛРасчетыСБюджетомВидСтроки.ВозвратНалога);
	
	ПостроительОтчетов.Параметры.Вставить("ВидСтроки",              	НачислениеВозврат);
	ПостроительОтчетов.Параметры.Вставить("ВозвратНалога",              Перечисления.НДФЛРасчетыСБюджетомВидСтроки.ВозвратНалога);
	
	ПостроительОтчетов.Параметры.Вставить("Расход", 					ВидДвиженияНакопления.Расход);
	ПостроительОтчетов.Параметры.Вставить("Приход", 					ВидДвиженияНакопления.Приход);
	ПостроительОтчетов.Параметры.Вставить("ВнутреннееСовместительство", Перечисления.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство);
	ПостроительОтчетов.Параметры.Вставить("ЗанятостьНеУказана",		    Перечисления.ВидыЗанятостиВОрганизации.ПустаяСсылка());
	ПостроительОтчетов.Параметры.Вставить("Прием",						Перечисления.ПричиныИзмененияСостояния.ПриемНаРаботу);
	
	Авансы = Новый Массив;
	Авансы.Добавить(Перечисления.ХарактерВыплатыЗарплаты.АвансЗаПервуюПоловинуМесяца);
	Авансы.Добавить(Перечисления.ХарактерВыплатыЗарплаты.ПлановыйАванс);
	
	ПостроительОтчетов.Параметры.Вставить("Аванс",			  Авансы);
	ПостроительОтчетов.Параметры.Вставить("Расчет",		      Перечисления.ХарактерВыплатыЗарплаты.Зарплата);
	ПостроительОтчетов.Параметры.Вставить("ХарактерНеУказан", Перечисления.ХарактерВыплатыЗарплаты.ПустаяСсылка());
	ПостроительОтчетов.Параметры.Вставить("ЧерезКассу",	      Перечисления.СпособыВыплатыЗарплаты.ЧерезКассу);
	ПостроительОтчетов.Параметры.Вставить("ЧерезБанк",		  Перечисления.СпособыВыплатыЗарплаты.ЧерезБанк);
	ПостроительОтчетов.Параметры.Вставить("Общая",			  Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13);
	ПостроительОтчетов.Параметры.Вставить("Дивиденды",		  Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка09);
	ПостроительОтчетов.Параметры.Вставить("ПустаяКатегория",  Перечисления.КатегорииДолжностейДляСтатистическогоУчета.ПустаяСсылка());
	ПостроительОтчетов.Параметры.Вставить("ПустаяДолжность",  Справочники.ДолжностиОрганизаций.ПустаяСсылка());
	
	МассивКодыМатвыгоды = Новый Массив;
	МассивКодыМатвыгоды.Добавить(Справочники.ДоходыНДФЛ.Код99998проценты);
	МассивКодыМатвыгоды.Добавить(Справочники.ДоходыНДФЛ.Код99999товары);

	
	ПостроительОтчетов.Параметры.Вставить("КодыМатвыгоды",	МассивКодыМатвыгоды);
	
	// Присвоим текст запроса в зависимости от типа расчетного листка
	Если ВидРасчетногоЛистка = "Кратко" тогда
		
		ТекстПостроителя = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
		|	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации
		|ПОМЕСТИТЬ Периоды
		|ИЗ
		|	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
		|ГДЕ
		|	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
		|	ОсновныеНачисленияРаботниковОрганизацийФактическийПериодДействия.НомерСтроки,
		|	ОсновныеНачисленияРаботниковОрганизацийФактическийПериодДействия.Регистратор
		|ПОМЕСТИТЬ СтрокиСФактическимПериодомДействия
		|ИЗ
		|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации) КАК ОсновныеНачисленияРаботниковОрганизацийФактическийПериодДействия
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	НачисленияУдержания.ВидДвижения КАК ВидДвижения,
		|	НачисленияУдержания.ФизЛицо КАК ФизЛицо,
		|	НачисленияУдержания.Организация КАК Организация,
		|	НачисленияУдержания.ПериодРегистрации КАК ПериодРегистрации,
		|	НачисленияУдержания.ВидРасчета КАК ВидРасчета,
		|	НачисленияУдержания.ПорядокВидаРасчета КАК ПорядокВидаРасчета,
		|	НачисленияУдержания.ОтработаноДней КАК ОтработаноДней,
		|	НачисленияУдержания.ОтработаноЧасов,
		|	НачисленияУдержания.ОплаченоДней,
		|	НачисленияУдержания.ОплаченоЧасов,
		|	НачисленияУдержания.Результат,
		|	НачисленияУдержания.СальдоНачальное,
		|	НачисленияУдержания.СальдоКонечное,
		|	НачисленияУдержания.Оборот,
		|	НачисленияУдержания.СальдоНачальноеНДФЛ,
		|	НачисленияУдержания.СальдоКонечноеНДФЛ
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме
		|				ТОГДА ""ДоходыВНатуральнойФорме""
		|			ИНАЧЕ ""Начислено""
		|		КОНЕЦ КАК ВидДвижения,
		|		ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение КАК Организация,
		|		ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации КАК ПериодРегистрации,
		|		ОсновныеНачисленияРаботниковОрганизации.ФизЛицо КАК ФизЛицо,
		|		ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.Наименование + ВЫБОР
		|			КОГДА ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизации.Сотрудник.ВидЗанятости, &ЗанятостьНеУказана) <> &ВнутреннееСовместительство
		|				ТОГДА """"
		|			ИНАЧЕ "" (по внутр. совмест-ву)""
		|		КОНЕЦ КАК ВидРасчета,
		|		""А"" + ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЗачетОтработанногоВремени
		|				ТОГДА ""А""
		|			ИНАЧЕ ""Б""
		|		КОНЕЦ + ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЗачетНормыВремени
		|				ТОГДА ""А""
		|			ИНАЧЕ ""Б""
		|		КОНЕЦ + ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.Код + ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.Код КАК ПорядокВидаРасчета,
		|		СУММА(ОсновныеНачисленияРаботниковОрганизации.ОтработаноДней) КАК ОтработаноДней,
		|		СУММА(ОсновныеНачисленияРаботниковОрганизации.ОтработаноЧасов) КАК ОтработаноЧасов,
		|		СУММА(ВЫБОР
		|				КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
		|					ТОГДА ОсновныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|				ИНАЧЕ 0
		|			КОНЕЦ) КАК ОплаченоДней,
		|		СУММА(ВЫБОР
		|				КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидУчетаВремени <> ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
		|					ТОГДА ОсновныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|				ИНАЧЕ 0
		|			КОНЕЦ) КАК ОплаченоЧасов,
		|		СУММА(ОсновныеНачисленияРаботниковОрганизации.Результат) КАК Результат,
		|		NULL КАК СальдоНачальное,
		|		NULL КАК СальдоКонечное,
		|		NULL КАК Оборот,
		|		NULL КАК СальдоНачальноеНДФЛ,
		|		NULL КАК СальдоКонечноеНДФЛ,
		|		ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение.ГоловнаяОрганизация КАК ОбособленноеПодразделениеГоловнаяОрганизация
		|	ИЗ
		|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизации
		|			ЛЕВОЕ СОЕДИНЕНИЕ СтрокиСФактическимПериодомДействия КАК СтрокиСФактическимПериодомДействия
		|			ПО ОсновныеНачисленияРаботниковОрганизации.НомерСтроки = СтрокиСФактическимПериодомДействия.НомерСтроки
		|				И ОсновныеНачисленияРаботниковОрганизации.Регистратор = СтрокиСФактическимПериодомДействия.Регистратор
		|	ГДЕ
		|		ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И (ОсновныеНачисленияРаботниковОрганизации.Результат <> 0
		|				ИЛИ СтрокиСФактическимПериодомДействия.НомерСтроки ЕСТЬ НЕ NULL )
		|	{ГДЕ
		|		ОсновныеНачисленияРаботниковОрганизации.Сотрудник,
		|		ОсновныеНачисленияРаботниковОрганизации.ФизЛицо,
		|		ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение КАК Организация}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме
		|				ТОГДА ""ДоходыВНатуральнойФорме""
		|			ИНАЧЕ ""Начислено""
		|		КОНЕЦ,
		|		ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации,
		|		ОсновныеНачисленияРаботниковОрганизации.ФизЛицо,
		|		ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.Наименование + ВЫБОР
		|			КОГДА ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизации.Сотрудник.ВидЗанятости, &ЗанятостьНеУказана) <> &ВнутреннееСовместительство
		|				ТОГДА """"
		|			ИНАЧЕ "" (по внутр. совмест-ву)""
		|		КОНЕЦ,
		|		""А"" + ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЗачетОтработанногоВремени
		|				ТОГДА ""А""
		|			ИНАЧЕ ""Б""
		|		КОНЕЦ + ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЗачетНормыВремени
		|				ТОГДА ""А""
		|			ИНАЧЕ ""Б""
		|		КОНЕЦ + ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.Код + ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.Код,
		|		ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение,
		|		ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме
		|				ТОГДА ""ДоходыВНатуральнойФорме""
		|			ИНАЧЕ ""Начислено""
		|		КОНЕЦ,
		|		ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение,
		|		НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ),
		|		ДополнительныеНачисленияРаботниковОрганизации.ФизЛицо,
		|		ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.Наименование + ВЫБОР
		|			КОГДА ЕСТЬNULL(ДополнительныеНачисленияРаботниковОрганизации.Сотрудник.ВидЗанятости, &ЗанятостьНеУказана) <> &ВнутреннееСовместительство
		|				ТОГДА """"
		|			ИНАЧЕ "" (по внутр. совмест-ву)""
		|		КОНЕЦ,
		|		""БААА"" + ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.Код,
		|		0,
		|		0,
		|		СУММА(ВЫБОР
		|				КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
		|					ТОГДА ДополнительныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА(ВЫБОР
		|				КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоЧасам)
		|					ТОГДА ДополнительныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА(ДополнительныеНачисленияРаботниковОрганизации.Результат),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизации
		|	ГДЕ
		|		ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|	{ГДЕ
		|		ДополнительныеНачисленияРаботниковОрганизации.Сотрудник,
		|		ДополнительныеНачисленияРаботниковОрганизации.ФизЛицо,
		|		ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение КАК Организация}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме
		|				ТОГДА ""ДоходыВНатуральнойФорме""
		|			ИНАЧЕ ""Начислено""
		|		КОНЕЦ,
		|		НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ),
		|		ДополнительныеНачисленияРаботниковОрганизации.ФизЛицо,
		|		ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.Наименование + ВЫБОР
		|			КОГДА ЕСТЬNULL(ДополнительныеНачисленияРаботниковОрганизации.Сотрудник.ВидЗанятости, &ЗанятостьНеУказана) <> &ВнутреннееСовместительство
		|				ТОГДА """"
		|			ИНАЧЕ "" (по внутр. совмест-ву)""
		|		КОНЕЦ,
		|		""БААА"" + ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.Код,
		|		ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение,
		|		ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		""ДоходыВНатуральнойФорме"",
		|		НДФЛСведенияОДоходах.ОбособленноеПодразделение,
		|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		|		НДФЛСведенияОДоходах.ФизЛицо,
		|		""Мат. выгода по займам (кредитам)"",
		|		""БААА9"",
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(НДФЛСведенияОДоходах.СуммаДохода),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		НДФЛСведенияОДоходах.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
		|	ГДЕ
		|		НДФЛСведенияОДоходах.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И НДФЛСведенияОДоходах.КодДохода В(&КодыМатвыгоды)
		|		И НДФЛСведенияОДоходах.ИсчисленоИзЗарплаты
		|		И НДФЛСведенияОДоходах.СуммаДохода <> 0
		|	{ГДЕ
		|		НДФЛСведенияОДоходах.ФизЛицо,
		|		НДФЛСведенияОДоходах.ОбособленноеПодразделение КАК Организация}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		|		НДФЛСведенияОДоходах.ФизЛицо,
		|		НДФЛСведенияОДоходах.ОбособленноеПодразделение,
		|		НДФЛСведенияОДоходах.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		""Удержано"",
		|		УдержанияРаботниковОрганизации.ОбособленноеПодразделение,
		|		УдержанияРаботниковОрганизации.ПериодРегистрации,
		|		УдержанияРаботниковОрганизации.ФизЛицо,
		|		УдержанияРаботниковОрганизации.ВидРасчета.Наименование,
		|		""АААА"" + УдержанияРаботниковОрганизации.ВидРасчета.Код,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(УдержанияРаботниковОрганизации.Результат),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		УдержанияРаботниковОрганизации.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизации
		|	ГДЕ
		|		УдержанияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И УдержанияРаботниковОрганизации.Результат <> 0
		|	{ГДЕ
		|		УдержанияРаботниковОрганизации.ФизЛицо,
		|		УдержанияРаботниковОрганизации.ОбособленноеПодразделение}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		УдержанияРаботниковОрганизации.ПериодРегистрации,
		|		УдержанияРаботниковОрганизации.ФизЛицо,
		|		УдержанияРаботниковОрганизации.ВидРасчета.Наименование,
		|		""АААА"" + УдержанияРаботниковОрганизации.ВидРасчета.Код,
		|		УдержанияРаботниковОрганизации.ОбособленноеПодразделение,
		|		УдержанияРаботниковОрганизации.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		""Удержано"",
		|		ЕСНИсчисленный.ОбособленноеПодразделение,
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ),
		|		ЕСНИсчисленный.ФизЛицо,
		|		""Пенсионный фонд исчисленный"",
		|		""БААА"",
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(ЕСНИсчисленный.ПенсионныйФонд),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		ЕСНИсчисленный.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		|	ГДЕ
		|		ЕСНИсчисленный.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И ЕСНИсчисленный.ПенсионныйФонд <> 0
		|	{ГДЕ
		|		ЕСНИсчисленный.ФизЛицо,
		|		ЕСНИсчисленный.ОбособленноеПодразделение КАК Организация}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ),
		|		ЕСНИсчисленный.ФизЛицо,
		|		ЕСНИсчисленный.ОбособленноеПодразделение,
		|		ЕСНИсчисленный.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		""Удержано"",
		|		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		|		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		|		НДФЛРасчетыСБюджетом.ФизЛицо,
		|		ВЫБОР
		|			КОГДА НДФЛРасчетыСБюджетом.ВидСтроки = &ВозвратНалога
		|				ТОГДА ""Подоходный налог возврат налога""
		|			ИНАЧЕ ""Подоходный налог исчисленный""
		|		КОНЕЦ,
		|		""БААА"",
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(НДФЛРасчетыСБюджетом.Налог),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
		|	ГДЕ
		|		НДФЛРасчетыСБюджетом.ИсчисленоИзЗарплаты
		|		И НДФЛРасчетыСБюджетом.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И НДФЛРасчетыСБюджетом.ВидСтроки В(&ВидСтроки)
		|		И НДФЛРасчетыСБюджетом.Налог <> 0
		|	{ГДЕ
		|		НДФЛРасчетыСБюджетом.ФизЛицо,
		|		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение КАК Организация}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		|		НДФЛРасчетыСБюджетом.ФизЛицо,
		|		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		|		ВЫБОР
		|			КОГДА НДФЛРасчетыСБюджетом.ВидСтроки = &ВозвратНалога
		|				ТОГДА ""Подоходный налог возврат налога""
		|			ИНАЧЕ ""Подоходный налог исчисленный""
		|		КОНЕЦ,
		|		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		""Удержано"",
		|		ПогашениеЗаймовРаботникамиОрганизаций.Организация,
		|		НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ),
		|		ПогашениеЗаймовРаботникамиОрганизаций.ФизЛицо,
		|		""Погашение займа"",
		|		""ВААА"",
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(ПогашениеЗаймовРаботникамиОрганизаций.ОсновнойДолг + ПогашениеЗаймовРаботникамиОрганизаций.Проценты),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		ПогашениеЗаймовРаботникамиОрганизаций.Организация.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций КАК ПогашениеЗаймовРаботникамиОрганизаций
		|	ГДЕ
		|		ПогашениеЗаймовРаботникамиОрганизаций.ВидДвижения = &Расход
		|		И ПогашениеЗаймовРаботникамиОрганизаций.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И ПогашениеЗаймовРаботникамиОрганизаций.УдержаноИзЗарплаты
		|		И ПогашениеЗаймовРаботникамиОрганизаций.ОсновнойДолг + ПогашениеЗаймовРаботникамиОрганизаций.Проценты <> 0
		|	{ГДЕ
		|		ПогашениеЗаймовРаботникамиОрганизаций.ФизЛицо}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ПогашениеЗаймовРаботникамиОрганизаций.ДоговорЗайма,
		|		НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ),
		|		ПогашениеЗаймовРаботникамиОрганизаций.Организация,
		|		ПогашениеЗаймовРаботникамиОрганизаций.ФизЛицо,
		|		ПогашениеЗаймовРаботникамиОрганизаций.Организация.ГоловнаяОрганизация
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		""Выплата"",
		|		Взаиморасчеты.Организация,
		|		НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|		Взаиморасчеты.Физлицо,
		|		ВЫБОР
		|			КОГДА НЕ Взаиморасчеты.Регистратор ССЫЛКА Документ.ДепонированиеОрганизаций
		|				ТОГДА ВЫБОР
		|						КОГДА Взаиморасчеты.СпособВыплаты = &ЧерезКассу
		|							ТОГДА ""Через кассу ""
		|						КОГДА Взаиморасчеты.СпособВыплаты = &ЧерезБанк
		|							ТОГДА ""Перечислено в банк ""
		|						ИНАЧЕ ""Способ выплаты не указан ""
		|					КОНЕЦ + ВЫБОР
		|						КОГДА Взаиморасчеты.ХарактерВыплаты В (&Аванс)
		|							ТОГДА ""(аванс)""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = &Расчет
		|							ТОГДА ""(под расчет)""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = &ХарактерНеУказан
		|								И Взаиморасчеты.СуммаВзаиморасчетов > 0
		|							ТОГДА ""(не указано)""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = &ХарактерНеУказан
		|								И Взаиморасчеты.СуммаВзаиморасчетов < 0
		|							ТОГДА ""(погашено задолженности)""
		|						ИНАЧЕ ""(межрасчет)""
		|					КОНЕЦ
		|			ИНАЧЕ ""Задепонировано""
		|		КОНЕЦ,
		|		""ГААА1"",
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(Взаиморасчеты.СуммаВзаиморасчетов),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		Взаиморасчеты.Организация.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций КАК Взаиморасчеты
		|	ГДЕ
		|		Взаиморасчеты.ВидДвижения = &Расход
		|		И Взаиморасчеты.СуммаВзаиморасчетов <> 0
		|		И Взаиморасчеты.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|	{ГДЕ
		|		Взаиморасчеты.Физлицо,
		|		Взаиморасчеты.Организация}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		Взаиморасчеты.Организация,
		|		Взаиморасчеты.Физлицо,
		|		НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|		ВЫБОР
		|			КОГДА НЕ Взаиморасчеты.Регистратор ССЫЛКА Документ.ДепонированиеОрганизаций
		|				ТОГДА ВЫБОР
		|						КОГДА Взаиморасчеты.СпособВыплаты = &ЧерезКассу
		|							ТОГДА ""Через кассу ""
		|						КОГДА Взаиморасчеты.СпособВыплаты = &ЧерезБанк
		|							ТОГДА ""Перечислено в банк ""
		|						ИНАЧЕ ""Способ выплаты не указан ""
		|					КОНЕЦ + ВЫБОР
		|						КОГДА Взаиморасчеты.ХарактерВыплаты В (&Аванс)
		|							ТОГДА ""(аванс)""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = &Расчет
		|							ТОГДА ""(под расчет)""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = &ХарактерНеУказан
		|								И Взаиморасчеты.СуммаВзаиморасчетов > 0
		|							ТОГДА ""(не указано)""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = &ХарактерНеУказан
		|								И Взаиморасчеты.СуммаВзаиморасчетов < 0
		|							ТОГДА ""(погашено задолженности)""
		|						ИНАЧЕ ""(межрасчет)""
		|					КОНЕЦ
		|			ИНАЧЕ ""Задепонировано""
		|		КОНЕЦ,
		|		Взаиморасчеты.Организация.ГоловнаяОрганизация
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ВидыДвижения.ВидДвижения,
		|		Взаиморасчеты.Организация,
		|		НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|		Взаиморасчеты.Физлицо,
		|		""Компенсация за "" + ВЫБОР
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПлановыйАванс)
		|				ТОГДА ""несвоевременную выплату заработной платы за первую половину месяца""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.АвансЗаПервуюПоловинуМесяца)
		|				ТОГДА ""несвоевременную выплату заработной платы за первую половину месяца""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПоБольничнымЛистам)
		|				ТОГДА ""несвоевременную выплату пособий по временной нетрудоспособности""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПоБеременностиИРодам)
		|				ТОГДА ""несвоевременную выплату пособий по беременности и родам""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПособияФСС)
		|				ТОГДА ""несвоевременную выплату пособий по социальному страхованию""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Отпускные)
		|				ТОГДА ""несвоевременную выплату заработка, сохраняемого на период отпуска""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Командировочные)
		|				ТОГДА ""несвоевременную выплату заработка, сохраняемого на период командировки""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Премии)
		|				ТОГДА ""несвоевременную выплату премий""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.РасчетПриУвольнении)
		|				ТОГДА ""несвоевременные выплаты при увольнении""
		|			ИНАЧЕ ""несвоевременную выплату заработной платы""
		|		КОНЕЦ,
		|		""ГААА2"",
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(ЗарплатаКВыплатеОрганизацийЗарплата.КомпенсацияЗаЗадержкуЗарплаты),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		Взаиморасчеты.Организация.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций КАК Взаиморасчеты
		|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ЗарплатаКВыплатеОрганизаций.Зарплата КАК ЗарплатаКВыплатеОрганизацийЗарплата
		|			ПО Взаиморасчеты.Физлицо = ЗарплатаКВыплатеОрганизацийЗарплата.Физлицо
		|				И Взаиморасчеты.Ведомость = ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка,
		|		(ВЫБРАТЬ
		|			""Начислено"" КАК ВидДвижения
		|		
		|		ОБЪЕДИНИТЬ ВСЕ
		|		
		|		ВЫБРАТЬ
		|			""Выплата"") КАК ВидыДвижения
		|	ГДЕ
		|		Взаиморасчеты.ВидДвижения = &Расход
		|		И Взаиморасчеты.СуммаВзаиморасчетов <> 0
		|		И Взаиморасчеты.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И ЗарплатаКВыплатеОрганизацийЗарплата.КомпенсацияЗаЗадержкуЗарплаты <> 0
		|	{ГДЕ
		|		Взаиморасчеты.Физлицо,
		|		Взаиморасчеты.Организация}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		Взаиморасчеты.Организация,
		|		Взаиморасчеты.Физлицо,
		|		НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|		ВидыДвижения.ВидДвижения,
		|		Взаиморасчеты.Организация.ГоловнаяОрганизация,
		|		""Компенсация за "" + ВЫБОР
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПлановыйАванс)
		|				ТОГДА ""несвоевременную выплату заработной платы за первую половину месяца""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.АвансЗаПервуюПоловинуМесяца)
		|				ТОГДА ""несвоевременную выплату заработной платы за первую половину месяца""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПоБольничнымЛистам)
		|				ТОГДА ""несвоевременную выплату пособий по временной нетрудоспособности""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПоБеременностиИРодам)
		|				ТОГДА ""несвоевременную выплату пособий по беременности и родам""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПособияФСС)
		|				ТОГДА ""несвоевременную выплату пособий по социальному страхованию""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Отпускные)
		|				ТОГДА ""несвоевременную выплату заработка, сохраняемого на период отпуска""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Командировочные)
		|				ТОГДА ""несвоевременную выплату заработка, сохраняемого на период командировки""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Премии)
		|				ТОГДА ""несвоевременную выплату премий""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.РасчетПриУвольнении)
		|				ТОГДА ""несвоевременные выплаты при увольнении""
		|			ИНАЧЕ ""несвоевременную выплату заработной платы""
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		""Сальдо"",
		|		Сальдо.Организация,
		|		Периоды.ПериодРегистрации,
		|		Сальдо.Физлицо,
		|		"""",
		|		""ЯЯЯЯ"",
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(ВЫБОР
		|				КОГДА Сальдо.Период < Периоды.ПериодРегистрации
		|					ТОГДА Сальдо.СуммаВзаиморасчетовОстаток
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА(ВЫБОР
		|				КОГДА Сальдо.Период <= Периоды.ПериодРегистрации
		|					ТОГДА Сальдо.СуммаВзаиморасчетовОстаток
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА(Сальдо.СуммаВзаиморасчетовОборот),
		|		СУММА(ВЫБОР
		|				КОГДА Сальдо.Период < Периоды.ПериодРегистрации
		|					ТОГДА Сальдо.СуммаНДФЛКОстаток
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА(ВЫБОР
		|				КОГДА Сальдо.Период <= Периоды.ПериодРегистрации
		|					ТОГДА Сальдо.СуммаНДФЛКОстаток
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		Сальдо.Организация.ГоловнаяОрганизация
		|	ИЗ
		|		Периоды КАК Периоды
		|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|				ВзаиморасчетыСРаботникамиОрганизацийОстатки.Организация КАК Организация,
		|				ДОБАВИТЬКДАТЕ(&ПериодРегистрации, МЕСЯЦ, -1) КАК Период,
		|				ВзаиморасчетыСРаботникамиОрганизацийОстатки.Физлицо КАК Физлицо,
		|				ВзаиморасчетыСРаботникамиОрганизацийОстатки.СуммаВзаиморасчетовОстаток КАК СуммаВзаиморасчетовОстаток,
		|				NULL КАК СуммаВзаиморасчетовОборот,
		|				NULL КАК СуммаНДФЛКОстаток
		|			ИЗ
		|				РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций.Остатки(&ПериодРегистрации, {(Физлицо), (Организация)}) КАК ВзаиморасчетыСРаботникамиОрганизацийОстатки
		|			
		|			ОБЪЕДИНИТЬ ВСЕ
		|			
		|			ВЫБРАТЬ
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.Организация,
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.Период,
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.Физлицо,
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.СуммаВзаиморасчетовОборот,
		|				NULL,
		|				NULL
		|			ИЗ
		|				РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций.Обороты(&ПериодРегистрации, &КонецПериодаРегистрации, Месяц, {(Организация), (Физлицо)}) КАК ВзаиморасчетыСРаботникамиОрганизацийОбороты
		|			
		|			ОБЪЕДИНИТЬ ВСЕ
		|			
		|			ВЫБРАТЬ
		|				НДФЛКЗачету.Организация,
		|				ДОБАВИТЬКДАТЕ(&ПериодРегистрации, МЕСЯЦ, -1),
		|				НДФЛКЗачету.ФизЛицо,
		|				НДФЛКЗачету.СуммаНДФЛКЗачетуОстаток,
		|				NULL,
		|				НДФЛКЗачету.СуммаНДФЛКЗачетуОстаток
		|			ИЗ
		|				РегистрНакопления.НДФЛКЗачету.Остатки(&ПериодРегистрации, {(ФизЛицо), (Организация)}) КАК НДФЛКЗачету
		|			
		|			ОБЪЕДИНИТЬ ВСЕ
		|			
		|			ВЫБРАТЬ
		|				НДФЛКЗачету.Организация,
		|				НДФЛКЗачету.Период,
		|				НДФЛКЗачету.ФизЛицо,
		|				НДФЛКЗачету.СуммаНДФЛКЗачетуОборот,
		|				NULL,
		|				НДФЛКЗачету.СуммаНДФЛКЗачетуОборот
		|			ИЗ
		|				РегистрНакопления.НДФЛКЗачету.Обороты(&ПериодРегистрации, &КонецПериодаРегистрации, Месяц, {(Организация), (ФизЛицо)}) КАК НДФЛКЗачету
		|			
		|			ОБЪЕДИНИТЬ ВСЕ
		|			
		|			ВЫБРАТЬ
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.Организация,
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.Период,
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.Физлицо,
		|				NULL,
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.СуммаВзаиморасчетовПриход + ВзаиморасчетыСРаботникамиОрганизацийОбороты.СуммаВзаиморасчетовРасход,
		|				NULL
		|			ИЗ
		|				РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций.Обороты(&ПериодРегистрации, &КонецПериодаРегистрации, Месяц, {(Организация), (Физлицо)}) КАК ВзаиморасчетыСРаботникамиОрганизацийОбороты) КАК Сальдо
		|			ПО (Сальдо.Период <= Периоды.ПериодРегистрации)
		|	{ГДЕ
		|		Сальдо.Организация,
		|		Сальдо.Физлицо}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		Сальдо.Организация,
		|		Сальдо.Физлицо,
		|		Периоды.ПериодРегистрации,
		|		Сальдо.Организация.ГоловнаяОрганизация) КАК НачисленияУдержания
		|{ГДЕ
		|	НачисленияУдержания.ФизЛицо.*,
		|	НачисленияУдержания.Организация.*}
		|
		|УПОРЯДОЧИТЬ ПО
		|	ПериодРегистрации,
		|	Организация,
		|	ФизЛицо,
		|	ПорядокВидаРасчета,
		|	ВидРасчета
		|ИТОГИ ПО
		|	Организация,
		|	ПериодРегистрации,
		|	ФизЛицо,
		|	ВидДвижения";
		
	ИначеЕсли ВидРасчетногоЛистка = "Рабочий" тогда
		
		ТекстПостроителя = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
		|	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации
		|ПОМЕСТИТЬ Периоды
		|ИЗ
		|	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
		|ГДЕ
		|	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
		|	ОсновныеНачисленияРаботниковОрганизацийФактическийПериодДействия.НомерСтроки,
		|	ОсновныеНачисленияРаботниковОрганизацийФактическийПериодДействия.Регистратор
		|ПОМЕСТИТЬ СтрокиСФактическимПериодомДействия
		|ИЗ
		|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации) КАК ОсновныеНачисленияРаботниковОрганизацийФактическийПериодДействия
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	НачисленияУдержания.ВидДвижения КАК ВидДвижения,
		|	НачисленияУдержания.ФизЛицо КАК ФизЛицо,
		|	НачисленияУдержания.Организация КАК Организация,
		|	НачисленияУдержания.ПериодРегистрации КАК ПериодРегистрации,
		|	НачисленияУдержания.ВидРасчета КАК ВидРасчета,
		|	НачисленияУдержания.ПорядокВидаРасчета КАК ПорядокВидаРасчета,
		|	НачисленияУдержания.ОтработаноДней КАК ОтработаноДней,
		|	НачисленияУдержания.ОтработаноЧасов,
		|	НачисленияУдержания.ОплаченоДней,
		|	НачисленияУдержания.ОплаченоЧасов,
		|	НачисленияУдержания.Результат,
		|	НачисленияУдержания.СальдоНачальное,
		|	НачисленияУдержания.СальдоКонечное,
		|	НачисленияУдержания.Оборот,
		|	НачисленияУдержания.СальдоНачальноеНДФЛ,
		|	НачисленияУдержания.СальдоКонечноеНДФЛ,
		|	НачисленияУдержания.ПериодДействия,
		|	НачисленияУдержания.Организация.ГоловнаяОрганизация
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме
		|				ТОГДА ""ДоходыВНатуральнойФорме""
		|			ИНАЧЕ ""Начислено""
		|		КОНЕЦ КАК ВидДвижения,
		|		ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение КАК Организация,
		|		ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации КАК ПериодРегистрации,
		|		ОсновныеНачисленияРаботниковОрганизации.ФизЛицо КАК ФизЛицо,
		|		ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.Наименование + ВЫБОР
		|			КОГДА ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизации.Сотрудник.ВидЗанятости, &ЗанятостьНеУказана) <> &ВнутреннееСовместительство
		|				ТОГДА """"
		|			ИНАЧЕ "" (по внутр. совмест-ву)""
		|		КОНЕЦ КАК ВидРасчета,
		|		""А"" + ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЗачетОтработанногоВремени
		|				ТОГДА ""А""
		|			ИНАЧЕ ""Б""
		|		КОНЕЦ + ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЗачетНормыВремени
		|				ТОГДА ""А""
		|			ИНАЧЕ ""Б""
		|		КОНЕЦ + ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.Код + ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.Код КАК ПорядокВидаРасчета,
		|		СУММА(ОсновныеНачисленияРаботниковОрганизации.ОтработаноДней) КАК ОтработаноДней,
		|		СУММА(ОсновныеНачисленияРаботниковОрганизации.ОтработаноЧасов) КАК ОтработаноЧасов,
		|		СУММА(ВЫБОР
		|				КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
		|					ТОГДА ОсновныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|				ИНАЧЕ 0
		|			КОНЕЦ) КАК ОплаченоДней,
		|		СУММА(ВЫБОР
		|				КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидУчетаВремени <> ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
		|					ТОГДА ОсновныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|				ИНАЧЕ 0
		|			КОНЕЦ) КАК ОплаченоЧасов,
		|		СУММА(ОсновныеНачисленияРаботниковОрганизации.Результат) КАК Результат,
		|		NULL КАК СальдоНачальное,
		|		NULL КАК СальдоКонечное,
		|		NULL КАК Оборот,
		|		NULL КАК СальдоНачальноеНДФЛ,
		|		NULL КАК СальдоКонечноеНДФЛ,
		|		ОсновныеНачисленияРаботниковОрганизации.ПериодДействия КАК ПериодДействия,
		|		ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение.ГоловнаяОрганизация КАК ОбособленноеПодразделениеГоловнаяОрганизация
		|	ИЗ
		|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизации
		|			ЛЕВОЕ СОЕДИНЕНИЕ СтрокиСФактическимПериодомДействия КАК СтрокиСФактическимПериодомДействия
		|			ПО ОсновныеНачисленияРаботниковОрганизации.НомерСтроки = СтрокиСФактическимПериодомДействия.НомерСтроки
		|				И ОсновныеНачисленияРаботниковОрганизации.Регистратор = СтрокиСФактическимПериодомДействия.Регистратор
		|	ГДЕ
		|		ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И (ОсновныеНачисленияРаботниковОрганизации.Результат <> 0
		|				ИЛИ СтрокиСФактическимПериодомДействия.НомерСтроки ЕСТЬ НЕ NULL )
		|	{ГДЕ
		|		ОсновныеНачисленияРаботниковОрганизации.Сотрудник,
		|		ОсновныеНачисленияРаботниковОрганизации.ФизЛицо,
		|		ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение КАК Организация}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме
		|				ТОГДА ""ДоходыВНатуральнойФорме""
		|			ИНАЧЕ ""Начислено""
		|		КОНЕЦ,
		|		ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации,
		|		ОсновныеНачисленияРаботниковОрганизации.ФизЛицо,
		|		ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.Наименование + ВЫБОР
		|			КОГДА ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизации.Сотрудник.ВидЗанятости, &ЗанятостьНеУказана) <> &ВнутреннееСовместительство
		|				ТОГДА """"
		|			ИНАЧЕ "" (по внутр. совмест-ву)""
		|		КОНЕЦ,
		|		""А"" + ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЗачетОтработанногоВремени
		|				ТОГДА ""А""
		|			ИНАЧЕ ""Б""
		|		КОНЕЦ + ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЗачетНормыВремени
		|				ТОГДА ""А""
		|			ИНАЧЕ ""Б""
		|		КОНЕЦ + ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.Код + ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.Код,
		|		ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение,
		|		ОсновныеНачисленияРаботниковОрганизации.ПериодДействия,
		|		ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме
		|				ТОГДА ""ДоходыВНатуральнойФорме""
		|			ИНАЧЕ ""Начислено""
		|		КОНЕЦ,
		|		ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение,
		|		НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ),
		|		ДополнительныеНачисленияРаботниковОрганизации.ФизЛицо,
		|		ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.Наименование + ВЫБОР
		|			КОГДА ЕСТЬNULL(ДополнительныеНачисленияРаботниковОрганизации.Сотрудник.ВидЗанятости, &ЗанятостьНеУказана) <> &ВнутреннееСовместительство
		|				ТОГДА """"
		|			ИНАЧЕ "" (по внутр. совмест-ву)""
		|		КОНЕЦ,
		|		""БААА"" + ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.Код,
		|		0,
		|		0,
		|		СУММА(ВЫБОР
		|				КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
		|					ТОГДА ДополнительныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА(ВЫБОР
		|				КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоЧасам)
		|					ТОГДА ДополнительныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА(ДополнительныеНачисленияРаботниковОрганизации.Результат),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисленияРаботниковОрганизации.БазовыйПериодНачало = ДАТАВРЕМЯ(1, 1, 1)
		|				ТОГДА НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ)
		|			ИНАЧЕ НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.БазовыйПериодНачало, МЕСЯЦ)
		|		КОНЕЦ,
		|		ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизации
		|	ГДЕ
		|		ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И НЕ(ДополнительныеНачисленияРаботниковОрганизации.Результат = 0
		|					И ВЫБОР
		|						КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
		|							ТОГДА ДополнительныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|						ИНАЧЕ 0
		|					КОНЕЦ = 0
		|					И ВЫБОР
		|						КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоЧасам)
		|							ТОГДА ДополнительныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|						ИНАЧЕ 0
		|					КОНЕЦ = 0)
		|	{ГДЕ
		|		ДополнительныеНачисленияРаботниковОрганизации.Сотрудник,
		|		ДополнительныеНачисленияРаботниковОрганизации.ФизЛицо,
		|		ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение КАК Организация}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме
		|				ТОГДА ""ДоходыВНатуральнойФорме""
		|			ИНАЧЕ ""Начислено""
		|		КОНЕЦ,
		|		НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ),
		|		ДополнительныеНачисленияРаботниковОрганизации.ФизЛицо,
		|		ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.Наименование + ВЫБОР
		|			КОГДА ЕСТЬNULL(ДополнительныеНачисленияРаботниковОрганизации.Сотрудник.ВидЗанятости, &ЗанятостьНеУказана) <> &ВнутреннееСовместительство
		|				ТОГДА """"
		|			ИНАЧЕ "" (по внутр. совмест-ву)""
		|		КОНЕЦ,
		|		""БААА"" + ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.Код,
		|		ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение,
		|		ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение.ГоловнаяОрганизация,
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисленияРаботниковОрганизации.БазовыйПериодНачало = ДАТАВРЕМЯ(1, 1, 1)
		|				ТОГДА НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ)
		|			ИНАЧЕ НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.БазовыйПериодНачало, МЕСЯЦ)
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		""ДоходыВНатуральнойФорме"",
		|		НДФЛСведенияОДоходах.ОбособленноеПодразделение,
		|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		|		НДФЛСведенияОДоходах.ФизЛицо,
		|		""Мат. выгода по займам (кредитам)"",
		|		""БААА9"",
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(НДФЛСведенияОДоходах.СуммаДохода),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ),
		|		НДФЛСведенияОДоходах.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
		|	ГДЕ
		|		НДФЛСведенияОДоходах.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И НДФЛСведенияОДоходах.КодДохода В(&КодыМатвыгоды)
		|		И НДФЛСведенияОДоходах.ИсчисленоИзЗарплаты
		|		И НДФЛСведенияОДоходах.СуммаДохода <> 0
		|	{ГДЕ
		|		НДФЛСведенияОДоходах.ФизЛицо,
		|		НДФЛСведенияОДоходах.ОбособленноеПодразделение КАК Организация}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		|		НДФЛСведенияОДоходах.ФизЛицо,
		|		НДФЛСведенияОДоходах.ОбособленноеПодразделение,
		|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ),
		|		НДФЛСведенияОДоходах.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		""Удержано"",
		|		УдержанияРаботниковОрганизации.ОбособленноеПодразделение,
		|		УдержанияРаботниковОрганизации.ПериодРегистрации,
		|		УдержанияРаботниковОрганизации.ФизЛицо,
		|		УдержанияРаботниковОрганизации.ВидРасчета.Наименование,
		|		""АААА"" + УдержанияРаботниковОрганизации.ВидРасчета.Код,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(УдержанияРаботниковОрганизации.Результат),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		УдержанияРаботниковОрганизации.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизации
		|	ГДЕ
		|		УдержанияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И УдержанияРаботниковОрганизации.Результат <> 0
		|	{ГДЕ
		|		УдержанияРаботниковОрганизации.ФизЛицо,
		|		УдержанияРаботниковОрганизации.ОбособленноеПодразделение}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		УдержанияРаботниковОрганизации.ПериодРегистрации,
		|		УдержанияРаботниковОрганизации.ФизЛицо,
		|		""АААА"" + УдержанияРаботниковОрганизации.ВидРасчета.Код,
		|		УдержанияРаботниковОрганизации.ОбособленноеПодразделение,
		|		УдержанияРаботниковОрганизации.ВидРасчета.Наименование,
		|		УдержанияРаботниковОрганизации.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		""Удержано"",
		|		ЕСНИсчисленный.ОбособленноеПодразделение,
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ),
		|		ЕСНИсчисленный.ФизЛицо,
		|		""Пенсионный фонд исчисленный"",
		|		""БААА"",
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(ЕСНИсчисленный.ПенсионныйФонд),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		ЕСНИсчисленный.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		|	ГДЕ
		|		ЕСНИсчисленный.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И ЕСНИсчисленный.ПенсионныйФонд <> 0
		|	{ГДЕ
		|		ЕСНИсчисленный.ФизЛицо,
		|		ЕСНИсчисленный.ОбособленноеПодразделение КАК Организация}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ),
		|		ЕСНИсчисленный.ФизЛицо,
		|		ЕСНИсчисленный.ОбособленноеПодразделение,
		|		ЕСНИсчисленный.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		""Удержано"",
		|		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		|		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		|		НДФЛРасчетыСБюджетом.ФизЛицо,
		|		ВЫБОР
		|			КОГДА НДФЛРасчетыСБюджетом.ВидСтроки = &ВозвратНалога
		|				ТОГДА ""Подоходный налог возврат налога""
		|			ИНАЧЕ ""Подоходный налог исчисленный""
		|		КОНЕЦ,
		|		""БААА"",
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(НДФЛРасчетыСБюджетом.Налог),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
		|	ГДЕ
		|		НДФЛРасчетыСБюджетом.ИсчисленоИзЗарплаты
		|		И НДФЛРасчетыСБюджетом.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И НДФЛРасчетыСБюджетом.ВидСтроки В(&ВидСтроки)
		|		И НДФЛРасчетыСБюджетом.Налог <> 0
		|	{ГДЕ
		|		НДФЛРасчетыСБюджетом.ФизЛицо,
		|		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение КАК Организация}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		|		НДФЛРасчетыСБюджетом.ФизЛицо,
		|		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		|		ВЫБОР
		|			КОГДА НДФЛРасчетыСБюджетом.ВидСтроки = &ВозвратНалога
		|				ТОГДА ""Подоходный налог возврат налога""
		|			ИНАЧЕ ""Подоходный налог исчисленный""
		|		КОНЕЦ,
		|		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение.ГоловнаяОрганизация
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		""Удержано"",
		|		ПогашениеЗаймовРаботникамиОрганизаций.Организация,
		|		НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ),
		|		ПогашениеЗаймовРаботникамиОрганизаций.ФизЛицо,
		|		""Погашение займа"",
		|		""ВААА"",
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(ПогашениеЗаймовРаботникамиОрганизаций.ОсновнойДолг + ПогашениеЗаймовРаботникамиОрганизаций.Проценты),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		ПогашениеЗаймовРаботникамиОрганизаций.Организация.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций КАК ПогашениеЗаймовРаботникамиОрганизаций
		|	ГДЕ
		|		ПогашениеЗаймовРаботникамиОрганизаций.ВидДвижения = &Расход
		|		И ПогашениеЗаймовРаботникамиОрганизаций.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И ПогашениеЗаймовРаботникамиОрганизаций.УдержаноИзЗарплаты
		|		И ПогашениеЗаймовРаботникамиОрганизаций.ОсновнойДолг + ПогашениеЗаймовРаботникамиОрганизаций.Проценты <> 0
		|	{ГДЕ
		|		ПогашениеЗаймовРаботникамиОрганизаций.ФизЛицо}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ПогашениеЗаймовРаботникамиОрганизаций.ДоговорЗайма,
		|		НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ),
		|		ПогашениеЗаймовРаботникамиОрганизаций.Организация,
		|		ПогашениеЗаймовРаботникамиОрганизаций.ФизЛицо,
		|		ПогашениеЗаймовРаботникамиОрганизаций.Организация.ГоловнаяОрганизация
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		""Выплата"",
		|		Взаиморасчеты.Организация,
		|		НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|		Взаиморасчеты.Физлицо,
		|		ВЫБОР
		|			КОГДА НЕ Взаиморасчеты.Регистратор ССЫЛКА Документ.ДепонированиеОрганизаций
		|				ТОГДА ВЫБОР
		|						КОГДА Взаиморасчеты.ХарактерВыплаты В (&Аванс)
		|							ТОГДА ""Аванс""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = &Расчет
		|							ТОГДА ""Зарплата""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = &ХарактерНеУказан
		|								И Взаиморасчеты.СуммаВзаиморасчетов > 0
		|							ТОГДА ""Не указано""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = &ХарактерНеУказан
		|								И Взаиморасчеты.СуммаВзаиморасчетов < 0
		|							ТОГДА ""Погашение задолженности""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПоБольничнымЛистам)
		|							ТОГДА ""Пособия по больничным листам""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПособияНаДетей)
		|							ТОГДА ""Семейные пособия""
   		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Отпускные)
		|							ТОГДА ""Отпускные""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Командировочные)
		|							ТОГДА ""Командировочные""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Премии)
		|							ТОГДА ""Премия""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.РасчетПриУвольнении)
		|							ТОГДА ""Расчет при увольнении""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПрочиеРазовыеНачисления)
		|							ТОГДА ""Разовые начисления""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Дивиденды)
		|							ТОГДА ""Дивиденды""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПособияФСС)
		|							ТОГДА ""Пособие""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ВозвратНДФЛ)
		|							ТОГДА ""Возврат подоходного налога""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Задолженность)
		|							ТОГДА ""Задолженность""
		|						ИНАЧЕ ""Не указано""
		|					КОНЕЦ + ВЫБОР
		|						КОГДА Взаиморасчеты.СпособВыплаты = &ЧерезКассу
		|							ТОГДА "" (через кассу)""
		|						КОГДА Взаиморасчеты.СпособВыплаты = &ЧерезБанк
		|							ТОГДА "" (перечислено в банк)""
		|						ИНАЧЕ "" (способ выплаты не указан)""
		|					КОНЕЦ
		|			ИНАЧЕ ""Задепонировано""
		|		КОНЕЦ,
		|		""ГААА1"",
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(Взаиморасчеты.СуммаВзаиморасчетов),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		Взаиморасчеты.Период,
		|		Взаиморасчеты.Организация.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций КАК Взаиморасчеты
		|	ГДЕ
		|		Взаиморасчеты.ВидДвижения = &Расход
		|		И Взаиморасчеты.СуммаВзаиморасчетов <> 0
		|		И Взаиморасчеты.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|	{ГДЕ
		|		Взаиморасчеты.Физлицо,
		|		Взаиморасчеты.Организация}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		Взаиморасчеты.Организация,
		|		Взаиморасчеты.Физлицо,
		|		НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|		ВЫБОР
		|			КОГДА НЕ Взаиморасчеты.Регистратор ССЫЛКА Документ.ДепонированиеОрганизаций
		|				ТОГДА ВЫБОР
		|						КОГДА Взаиморасчеты.ХарактерВыплаты В (&Аванс)
		|							ТОГДА ""Аванс""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = &Расчет
		|							ТОГДА ""Зарплата""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = &ХарактерНеУказан
		|								И Взаиморасчеты.СуммаВзаиморасчетов > 0
		|							ТОГДА ""Не указано""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = &ХарактерНеУказан
		|								И Взаиморасчеты.СуммаВзаиморасчетов < 0
		|							ТОГДА ""Погашение задолженности""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПоБольничнымЛистам)
		|							ТОГДА ""Пособия по больничным листам""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПособияНаДетей)
		|							ТОГДА ""Семейные пособия""
   		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Отпускные)
		|							ТОГДА ""Отпускные""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Командировочные)
		|							ТОГДА ""Командировочные""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Премии)
		|							ТОГДА ""Премия""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.РасчетПриУвольнении)
		|							ТОГДА ""Расчет при увольнении""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПрочиеРазовыеНачисления)
		|							ТОГДА ""Разовые начисления""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Дивиденды)
		|							ТОГДА ""Дивиденды""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПособияФСС)
		|							ТОГДА ""Пособие""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ВозвратНДФЛ)
		|							ТОГДА ""Возврат подоходного налога""
		|						КОГДА Взаиморасчеты.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Задолженность)
		|							ТОГДА ""Задолженность""
		|						ИНАЧЕ ""Не указано""
		|					КОНЕЦ + ВЫБОР
		|						КОГДА Взаиморасчеты.СпособВыплаты = &ЧерезКассу
		|							ТОГДА "" (через кассу)""
		|						КОГДА Взаиморасчеты.СпособВыплаты = &ЧерезБанк
		|							ТОГДА "" (перечислено в банк)""
		|						ИНАЧЕ "" (способ выплаты не указан)""
		|					КОНЕЦ
		|			ИНАЧЕ ""Задепонировано""
		|		КОНЕЦ,
		|		Взаиморасчеты.Организация.ГоловнаяОрганизация,
		|		Взаиморасчеты.Период
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ВидыДвижения.ВидДвижения,
		|		Взаиморасчеты.Организация,
		|		НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|		Взаиморасчеты.Физлицо,
		|		""Компенсация за "" + ВЫБОР
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПлановыйАванс)
		|				ТОГДА ""несвоевременную выплату заработной платы за первую половину месяца""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.АвансЗаПервуюПоловинуМесяца)
		|				ТОГДА ""несвоевременную выплату заработной платы за первую половину месяца""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПоБольничнымЛистам)
		|				ТОГДА ""несвоевременную выплату пособий по временной нетрудоспособности""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПоБеременностиИРодам)
		|				ТОГДА ""несвоевременную выплату пособий по беременности и родам""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПособияФСС)
		|				ТОГДА ""несвоевременную выплату пособий по социальному страхованию""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Отпускные)
		|				ТОГДА ""несвоевременную выплату заработка, сохраняемого на период отпуска""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Командировочные)
		|				ТОГДА ""несвоевременную выплату заработка, сохраняемого на период командировки""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Премии)
		|				ТОГДА ""несвоевременную выплату премий""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.РасчетПриУвольнении)
		|				ТОГДА ""несвоевременные выплаты при увольнении""
		|			ИНАЧЕ ""несвоевременную выплату заработной платы""
		|		КОНЕЦ,
		|		""ГААА2"",
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(ЗарплатаКВыплатеОрганизацийЗарплата.КомпенсацияЗаЗадержкуЗарплаты),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		Взаиморасчеты.Организация.ГоловнаяОрганизация
		|	ИЗ
		|		РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций КАК Взаиморасчеты
		|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ЗарплатаКВыплатеОрганизаций.Зарплата КАК ЗарплатаКВыплатеОрганизацийЗарплата
		|			ПО Взаиморасчеты.Физлицо = ЗарплатаКВыплатеОрганизацийЗарплата.Физлицо
		|				И Взаиморасчеты.Ведомость = ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка,
		|		(ВЫБРАТЬ
		|			""Начислено"" КАК ВидДвижения
		|		
		|		ОБЪЕДИНИТЬ ВСЕ
		|		
		|		ВЫБРАТЬ
		|			""Выплата"") КАК ВидыДвижения
		|	ГДЕ
		|		Взаиморасчеты.ВидДвижения = &Расход
		|		И Взаиморасчеты.СуммаВзаиморасчетов <> 0
		|		И Взаиморасчеты.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И ЗарплатаКВыплатеОрганизацийЗарплата.КомпенсацияЗаЗадержкуЗарплаты <> 0
		|	{ГДЕ
		|		Взаиморасчеты.Физлицо,
		|		Взаиморасчеты.Организация}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		Взаиморасчеты.Организация,
		|		Взаиморасчеты.Физлицо,
		|		НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|		ВидыДвижения.ВидДвижения,
		|		Взаиморасчеты.Организация.ГоловнаяОрганизация,
		|		""Компенсация за "" + ВЫБОР
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПлановыйАванс)
		|				ТОГДА ""несвоевременную выплату заработной платы за первую половину месяца""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.АвансЗаПервуюПоловинуМесяца)
		|				ТОГДА ""несвоевременную выплату заработной платы за первую половину месяца""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПоБольничнымЛистам)
		|				ТОГДА ""несвоевременную выплату пособий по временной нетрудоспособности""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПоБеременностиИРодам)
		|				ТОГДА ""несвоевременную выплату пособий по беременности и родам""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.ПособияФСС)
		|				ТОГДА ""несвоевременную выплату пособий по социальному страхованию""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Отпускные)
		|				ТОГДА ""несвоевременную выплату заработка, сохраняемого на период отпуска""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Командировочные)
		|				ТОГДА ""несвоевременную выплату заработка, сохраняемого на период командировки""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.Премии)
		|				ТОГДА ""несвоевременную выплату премий""
		|			КОГДА ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка.ХарактерВыплаты = ЗНАЧЕНИЕ(Перечисление.ХарактерВыплатыЗарплаты.РасчетПриУвольнении)
		|				ТОГДА ""несвоевременные выплаты при увольнении""
		|			ИНАЧЕ ""несвоевременную выплату заработной платы""
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		""Сальдо"",
		|		Сальдо.Организация,
		|		Периоды.ПериодРегистрации,
		|		Сальдо.Физлицо,
		|		"""",
		|		""ЯЯЯЯ"",
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(ВЫБОР
		|				КОГДА Сальдо.Период < Периоды.ПериодРегистрации
		|					ТОГДА Сальдо.СуммаВзаиморасчетовОстаток
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА(ВЫБОР
		|				КОГДА Сальдо.Период <= Периоды.ПериодРегистрации
		|					ТОГДА Сальдо.СуммаВзаиморасчетовОстаток
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА(Сальдо.СуммаВзаиморасчетовОборот),
		|		СУММА(ВЫБОР
		|				КОГДА Сальдо.Период < Периоды.ПериодРегистрации
		|					ТОГДА Сальдо.СуммаНДФЛКОстаток
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА(ВЫБОР
		|				КОГДА Сальдо.Период <= Периоды.ПериодРегистрации
		|					ТОГДА Сальдо.СуммаНДФЛКОстаток
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		NULL,
		|		Сальдо.Организация.ГоловнаяОрганизация
		|	ИЗ
		|		Периоды КАК Периоды
		|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|				ВзаиморасчетыСРаботникамиОрганизацийОстатки.Организация КАК Организация,
		|				ДОБАВИТЬКДАТЕ(&ПериодРегистрации, МЕСЯЦ, -1) КАК Период,
		|				ВзаиморасчетыСРаботникамиОрганизацийОстатки.Физлицо КАК Физлицо,
		|				ВзаиморасчетыСРаботникамиОрганизацийОстатки.СуммаВзаиморасчетовОстаток КАК СуммаВзаиморасчетовОстаток,
		|				NULL КАК СуммаВзаиморасчетовОборот,
		|				NULL КАК СуммаНДФЛКОстаток
		|			ИЗ
		|				РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций.Остатки(&ПериодРегистрации, {(Физлицо), (Организация)}) КАК ВзаиморасчетыСРаботникамиОрганизацийОстатки
		|			
		|			ОБЪЕДИНИТЬ ВСЕ
		|			
		|			ВЫБРАТЬ
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.Организация,
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.Период,
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.Физлицо,
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.СуммаВзаиморасчетовОборот,
		|				NULL,
		|				NULL
		|			ИЗ
		|				РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций.Обороты(&ПериодРегистрации, &КонецПериодаРегистрации, Месяц, {(Организация), (Физлицо)}) КАК ВзаиморасчетыСРаботникамиОрганизацийОбороты
		|			
		|			ОБЪЕДИНИТЬ ВСЕ
		|			
		|			ВЫБРАТЬ
		|				НДФЛКЗачету.Организация,
		|				ДОБАВИТЬКДАТЕ(&ПериодРегистрации, МЕСЯЦ, -1),
		|				НДФЛКЗачету.ФизЛицо,
		|				НДФЛКЗачету.СуммаНДФЛКЗачетуОстаток,
		|				NULL,
		|				НДФЛКЗачету.СуммаНДФЛКЗачетуОстаток
		|			ИЗ
		|				РегистрНакопления.НДФЛКЗачету.Остатки(&ПериодРегистрации, {(ФизЛицо), (Организация)}) КАК НДФЛКЗачету
		|			
		|			ОБЪЕДИНИТЬ ВСЕ
		|			
		|			ВЫБРАТЬ
		|				НДФЛКЗачету.Организация,
		|				НДФЛКЗачету.Период,
		|				НДФЛКЗачету.ФизЛицо,
		|				НДФЛКЗачету.СуммаНДФЛКЗачетуОборот,
		|				NULL,
		|				НДФЛКЗачету.СуммаНДФЛКЗачетуОборот
		|			ИЗ
		|				РегистрНакопления.НДФЛКЗачету.Обороты(&ПериодРегистрации, &КонецПериодаРегистрации, Месяц, {(Организация), (ФизЛицо)}) КАК НДФЛКЗачету
		|			
		|			ОБЪЕДИНИТЬ ВСЕ
		|			
		|			ВЫБРАТЬ
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.Организация,
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.Период,
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.Физлицо,
		|				NULL,
		|				ВзаиморасчетыСРаботникамиОрганизацийОбороты.СуммаВзаиморасчетовРасход + ВзаиморасчетыСРаботникамиОрганизацийОбороты.СуммаВзаиморасчетовПриход,
		|				NULL
		|			ИЗ
		|				РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций.Обороты(&ПериодРегистрации, &КонецПериодаРегистрации, Месяц, {(Организация), (Физлицо)}) КАК ВзаиморасчетыСРаботникамиОрганизацийОбороты) КАК Сальдо
		|			ПО (Сальдо.Период <= Периоды.ПериодРегистрации)
		|	{ГДЕ
		|		Сальдо.Организация,
		|		Сальдо.Физлицо}
		|	
		|	СГРУППИРОВАТЬ ПО
		|		Сальдо.Организация,
		|		Сальдо.Физлицо,
		|		Периоды.ПериодРегистрации,
		|		Сальдо.Организация.ГоловнаяОрганизация) КАК НачисленияУдержания
		|{ГДЕ
		|	НачисленияУдержания.ФизЛицо.*,
		|	НачисленияУдержания.Организация.*}
		|
		|УПОРЯДОЧИТЬ ПО
		|	ПериодРегистрации,
		|	Организация,
		|	ФизЛицо,
		|	ПорядокВидаРасчета,
		|	ВидРасчета
		|ИТОГИ ПО
		|	Организация,
		|	ПериодРегистрации,
		|	ФизЛицо,
		|	ВидДвижения";		
		
	Иначе
		
		ТекстПостроителя = 
		//"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
		//|	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации
		//|ПОМЕСТИТЬ Периоды
		//|ИЗ
		//|	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
		//|ГДЕ
		//|	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода
		//|;
		//|
		//|////////////////////////////////////////////////////////////////////////////////
		//|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
		//|	ОсновныеНачисленияРаботниковОрганизацийФактическийПериодДействия.НомерСтроки,
		//|	ОсновныеНачисленияРаботниковОрганизацийФактическийПериодДействия.Регистратор
		//|ПОМЕСТИТЬ СтрокиСФактическимПериодомДействия
		//|ИЗ
		//|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации) КАК ОсновныеНачисленияРаботниковОрганизацийФактическийПериодДействия
		//|;
		//|
		
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	НачисленияУдержания.ВидДвижения КАК ВидДвижения,
		|	НачисленияУдержания.ФизЛицо КАК ФизЛицо,
		|	НачисленияУдержания.ПериодРегистрации КАК ПериодРегистрации,
		|	НачисленияУдержания.ВидРасчета КАК ВидРасчета,
		|	НачисленияУдержания.ПорядокВидаРасчета КАК ПорядокВидаРасчета,
		|	НачисленияУдержания.ОтработаноДней,
		|	НачисленияУдержания.ОтработаноЧасов,
		|	НачисленияУдержания.ОплаченоДней,
		|	НачисленияУдержания.Результат,
		|	НачисленияУдержания.ОплаченоЧасов,
		|	НачисленияУдержания.ПериодДействияНачало КАК ПериодДействияНачало,
		|	НачисленияУдержания.ПериодДействияКонец,
		|	НачисленияУдержания.Регистратор,
		|	НачисленияУдержания.НомерСтроки,
		|	НачисленияУдержания.Организация КАК Организация,
		|	НачисленияУдержания.ДополнениеКВидуРасчета,
		|	НачисленияУдержания.Показатель1,
		|	НачисленияУдержания.Показатель2,
		|	НачисленияУдержания.Показатель3,
		|	НачисленияУдержания.Показатель4,
		|	НачисленияУдержания.Показатель5,
		|	НачисленияУдержания.Показатель6,
		|	НачисленияУдержания.СальдоНачальное,
		|	НачисленияУдержания.СальдоКонечное,
		|	НачисленияУдержания.СальдоНачальноеНДФЛ,
		|	НачисленияУдержания.СальдоКонечноеНДФЛ,
		|	НачисленияУдержания.Обороты КАК Оборот
		|ИЗ
		|	(ВЫБРАТЬ
		|		НачисленияУдержания.ВидДвижения КАК ВидДвижения,
		|		НачисленияУдержания.ФизЛицо КАК ФизЛицо,
		|		НачисленияУдержания.Организация КАК Организация,
		|		НачисленияУдержания.ПериодРегистрации КАК ПериодРегистрации,
		|		НачисленияУдержания.ВидРасчета КАК ВидРасчета,
		|		НачисленияУдержания.ПорядокВидаРасчета КАК ПорядокВидаРасчета,
		|		НачисленияУдержания.ОтработаноДней КАК ОтработаноДней,
		|		НачисленияУдержания.ОтработаноЧасов КАК ОтработаноЧасов,
		|		НачисленияУдержания.ОплаченоДней КАК ОплаченоДней,
		|		НачисленияУдержания.ОплаченоЧасов КАК ОплаченоЧасов,
		|		НачисленияУдержания.Результат КАК Результат,
		|		НачисленияУдержания.ПериодДействияНачало КАК ПериодДействияНачало,
		|		НачисленияУдержания.ПериодДействияКонец КАК ПериодДействияКонец,
		|		НачисленияУдержания.Регистратор КАК Регистратор,
		|		НачисленияУдержания.НомерСтроки КАК НомерСтроки,
		|		НачисленияУдержания.ДополнениеКВидуРасчета КАК ДополнениеКВидуРасчета,
		|		НачисленияУдержания.Показатель1 КАК Показатель1,
		|		НачисленияУдержания.Показатель2 КАК Показатель2,
		|		НачисленияУдержания.Показатель3 КАК Показатель3,
		|		НачисленияУдержания.Показатель4 КАК Показатель4,
		|		НачисленияУдержания.Показатель5 КАК Показатель5,
		|		НачисленияУдержания.Показатель6 КАК Показатель6,
		|		НачисленияУдержания.СальдоНачальное КАК СальдоНачальное,
		|		НачисленияУдержания.СальдоКонечное КАК СальдоКонечное,
		|		НачисленияУдержания.СальдоНачальноеНДФЛ КАК СальдоНачальноеНДФЛ,
		|		НачисленияУдержания.СальдоКонечноеНДФЛ КАК СальдоКонечноеНДФЛ,
		|		НачисленияУдержания.Обороты КАК Обороты
		|	ИЗ
		|		(ВЫБРАТЬ
		|			ВЫБОР
		|				КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме
		|					ТОГДА ""ДоходыВНатуральнойФорме""
		|				ИНАЧЕ ""Начислено""
		|			КОНЕЦ КАК ВидДвижения,
		|			ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение КАК Организация,
		|			ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации КАК ПериодРегистрации,
		|			ОсновныеНачисленияРаботниковОрганизации.ФизЛицо КАК ФизЛицо,
		|			ОсновныеНачисленияРаботниковОрганизации.ВидРасчета КАК ВидРасчета,
		|			""А"" + ВЫБОР
		|				КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЗачетОтработанногоВремени
		|					ТОГДА ""А""
		|				ИНАЧЕ ""Б""
		|			КОНЕЦ + ВЫБОР
		|				КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЗачетНормыВремени
		|					ТОГДА ""А""
		|				ИНАЧЕ ""Б""
		|			КОНЕЦ + ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.Код КАК ПорядокВидаРасчета,
		|			ОсновныеНачисленияРаботниковОрганизации.ОтработаноДней КАК ОтработаноДней,
		|			ОсновныеНачисленияРаботниковОрганизации.ОтработаноЧасов КАК ОтработаноЧасов,
		|			ВЫБОР
		|				КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
		|					ТОГДА ОсновныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|				ИНАЧЕ 0
		|			КОНЕЦ КАК ОплаченоДней,
		|			ВЫБОР
		|				КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидУчетаВремени <> ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
		|					ТОГДА ОсновныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|				ИНАЧЕ 0
		|			КОНЕЦ КАК ОплаченоЧасов,
		|			ОсновныеНачисленияРаботниковОрганизации.Результат КАК Результат,
		|			ОсновныеНачисленияРаботниковОрганизации.ПериодДействияНачало КАК ПериодДействияНачало,
		|			ОсновныеНачисленияРаботниковОрганизации.ПериодДействияКонец КАК ПериодДействияКонец,
		|			ОсновныеНачисленияРаботниковОрганизации.Регистратор КАК Регистратор,
		|			ОсновныеНачисленияРаботниковОрганизации.НомерСтроки КАК НомерСтроки,
		|			ВЫБОР
		|				КОГДА ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизации.Сотрудник.ВидЗанятости, &ЗанятостьНеУказана) <> &ВнутреннееСовместительство
		|					ТОГДА """"
		|				ИНАЧЕ "" (по внутр. совмест-ву)""
		|			КОНЕЦ КАК ДополнениеКВидуРасчета,
		|			ОсновныеНачисленияРаботниковОрганизации.Показатель1 КАК Показатель1,
		|			ОсновныеНачисленияРаботниковОрганизации.Показатель2 КАК Показатель2,
		|			ОсновныеНачисленияРаботниковОрганизации.Показатель3 КАК Показатель3,
		|			ОсновныеНачисленияРаботниковОрганизации.Показатель4 КАК Показатель4,
		|			ОсновныеНачисленияРаботниковОрганизации.Показатель5 КАК Показатель5,
		|			ОсновныеНачисленияРаботниковОрганизации.Показатель6 КАК Показатель6,
		|			NULL КАК СальдоНачальное,
		|			NULL КАК СальдоКонечное,
		|			NULL КАК СальдоНачальноеНДФЛ,
		|			NULL КАК СальдоКонечноеНДФЛ,
		|			NULL КАК Обороты
		|		ИЗ
		|			РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизации
		|		ГДЕ
		|			ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		{ГДЕ
		|			ОсновныеНачисленияРаботниковОрганизации.Сотрудник,
		|			ОсновныеНачисленияРаботниковОрганизации.ФизЛицо,
		|			ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение КАК Организация}
		|		
		|		ОБЪЕДИНИТЬ ВСЕ
		|		
		|		ВЫБРАТЬ
		|			ВЫБОР
		|				КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме
		|					ТОГДА ""ДоходыВНатуральнойФорме""
		|				ИНАЧЕ ""Начислено""
		|			КОНЕЦ,
		|			ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение,
		|			НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ),
		|			ДополнительныеНачисленияРаботниковОрганизации.ФизЛицо,
		|			ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета,
		|			""БААА"" + ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.Код,
		|			0,
		|			0,
		|			ВЫБОР
		|				КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
		|					ТОГДА ДополнительныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|				ИНАЧЕ 0
		|			КОНЕЦ,
		|			ВЫБОР
		|				КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоЧасам)
		|					ТОГДА ДополнительныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|				ИНАЧЕ 0
		|			КОНЕЦ,
		|			ДополнительныеНачисленияРаботниковОрганизации.Результат,
		|			ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации,
		|			КОНЕЦПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, ДЕНЬ),
		|			ДополнительныеНачисленияРаботниковОрганизации.Регистратор,
		|			ДополнительныеНачисленияРаботниковОрганизации.НомерСтроки,
		|			ВЫБОР
		|				КОГДА ЕСТЬNULL(ДополнительныеНачисленияРаботниковОрганизации.Сотрудник.ВидЗанятости, &ЗанятостьНеУказана) <> &ВнутреннееСовместительство
		|					ТОГДА """"
		|				ИНАЧЕ "" (по внутр. совмест-ву)""
		|			КОНЕЦ,
		|			ДополнительныеНачисленияРаботниковОрганизации.Показатель1,
		|			ДополнительныеНачисленияРаботниковОрганизации.Показатель2,
		|			ДополнительныеНачисленияРаботниковОрганизации.Показатель3,
		|			ДополнительныеНачисленияРаботниковОрганизации.Показатель4,
		|			ДополнительныеНачисленияРаботниковОрганизации.Показатель5,
		|			ДополнительныеНачисленияРаботниковОрганизации.Показатель6,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL
		|		ИЗ
		|			РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизации
		|		ГДЕ
		|			ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		{ГДЕ
		|			ДополнительныеНачисленияРаботниковОрганизации.Сотрудник,
		|			ДополнительныеНачисленияРаботниковОрганизации.ФизЛицо,
		|			ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение КАК Организация}
		|		
		|		ОБЪЕДИНИТЬ ВСЕ
		|		
		|		ВЫБРАТЬ
		|			""ДоходыВНатуральнойФорме"",
		|			НДФЛСведенияОДоходах.ОбособленноеПодразделение,
		|			НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		|			НДФЛСведенияОДоходах.ФизЛицо,
		|			""Мат. выгода по займам (кредитам)"",
		|			""БААА9"",
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			СУММА(НДФЛСведенияОДоходах.СуммаДохода),
		|			НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		|			КОНЕЦПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL
		|		ИЗ
		|			РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
		|		ГДЕ
		|			НДФЛСведенияОДоходах.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|			И НДФЛСведенияОДоходах.КодДохода В(&КодыМатвыгоды)
		|			И НДФЛСведенияОДоходах.ИсчисленоИзЗарплаты
		|		{ГДЕ
		|			НДФЛСведенияОДоходах.ФизЛицо,
		|			НДФЛСведенияОДоходах.ОбособленноеПодразделение КАК Организация}
		|		
		|		СГРУППИРОВАТЬ ПО
		|			КОНЕЦПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		|			НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		|			НДФЛСведенияОДоходах.ФизЛицо,
		|			НДФЛСведенияОДоходах.ОбособленноеПодразделение,
		|			НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ)
		|		
		|		ОБЪЕДИНИТЬ ВСЕ
		|		
		|		ВЫБРАТЬ
		|			""Удержано"",
		|			УдержанияРаботниковОрганизации.ОбособленноеПодразделение,
		|			УдержанияРаботниковОрганизации.ПериодРегистрации,
		|			УдержанияРаботниковОрганизации.ФизЛицо,
		|			УдержанияРаботниковОрганизации.ВидРасчета.Наименование,
		|			""АААА"" + УдержанияРаботниковОрганизации.ВидРасчета.Код,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			УдержанияРаботниковОрганизации.Результат,
		|			УдержанияРаботниковОрганизации.БазовыйПериодНачало,
		|			УдержанияРаботниковОрганизации.БазовыйПериодКонец,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL
		|		ИЗ
		|			РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизации
		|		ГДЕ
		|			УдержанияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		{ГДЕ
		|			УдержанияРаботниковОрганизации.ФизЛицо,
		|			УдержанияРаботниковОрганизации.ОбособленноеПодразделение КАК Организация}
		|		
		|		ОБЪЕДИНИТЬ ВСЕ
		|		
		|		ВЫБРАТЬ
		|			""Удержано"",
		|			ЕСНИсчисленный.ОбособленноеПодразделение,
		|			НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ),
		|			ЕСНИсчисленный.ФизЛицо,
		|			""Пенсионный фонд исчисленный"",
		|			""БААА"",
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			СУММА(ЕСНИсчисленный.ПенсионныйФонд),
		|			НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ),
		|			КОНЕЦПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ),
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL
		|		ИЗ
		|			РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		|		ГДЕ
		|			ЕСНИсчисленный.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|			И ЕСНИсчисленный.ПенсионныйФонд <> 0
		|		{ГДЕ
		|			ЕСНИсчисленный.ФизЛицо,
		|			ЕСНИсчисленный.ОбособленноеПодразделение КАК Организация}
		|		
		|		СГРУППИРОВАТЬ ПО
		|			НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ),
		|			ЕСНИсчисленный.ФизЛицо,
		|			НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ),
		|			КОНЕЦПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ),
		|			ЕСНИсчисленный.ОбособленноеПодразделение
		|		
		|		ОБЪЕДИНИТЬ ВСЕ
		|		
		|		ВЫБРАТЬ
		|			""Удержано"",
		|			НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		|			НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		|			НДФЛРасчетыСБюджетом.ФизЛицо,
		|			ВЫБОР
		|				КОГДА НДФЛРасчетыСБюджетом.ВидСтроки = &ВозвратНалога
		|					ТОГДА ""Подоходный налог возврат налога ""
		|				ИНАЧЕ ""Подоходный налог, исчисленный ""
		|			КОНЕЦ + ВЫБОР
		|				КОГДА НДФЛРасчетыСБюджетом.СтавкаНалогообложенияРезидента = &Общая
		|					ТОГДА ""по основной ставке""
		|				КОГДА НДФЛРасчетыСБюджетом.СтавкаНалогообложенияРезидента = &Дивиденды
		|					ТОГДА ""по дивидендам""
		|				ИНАЧЕ ""по ставке 15%""
		|			КОНЕЦ,
		|			""БААА"",
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			СУММА(НДФЛРасчетыСБюджетом.Налог),
		|			НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		|			КОНЕЦПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL
		|		ИЗ
		|			РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
		|		ГДЕ
		|			НДФЛРасчетыСБюджетом.ИсчисленоИзЗарплаты
		|			И НДФЛРасчетыСБюджетом.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|			И НДФЛРасчетыСБюджетом.ВидСтроки В(&ВидСтроки)
		|			И НДФЛРасчетыСБюджетом.Налог <> 0
		|		{ГДЕ
		|			НДФЛРасчетыСБюджетом.ФизЛицо,
		|			НДФЛРасчетыСБюджетом.ОбособленноеПодразделение КАК Организация}
		|		
		|		СГРУППИРОВАТЬ ПО
		|			НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		|			НДФЛРасчетыСБюджетом.ФизЛицо,
		|			НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		|			НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		|			КОНЕЦПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		|			ВЫБОР
		|				КОГДА НДФЛРасчетыСБюджетом.ВидСтроки = &ВозвратНалога
		|					ТОГДА ""Подоходный налог возврат налога ""
		|				ИНАЧЕ ""Подоходный налог, исчисленный ""
		|			КОНЕЦ + ВЫБОР
		|				КОГДА НДФЛРасчетыСБюджетом.СтавкаНалогообложенияРезидента = &Общая
		|					ТОГДА ""по основной ставке""
		|				КОГДА НДФЛРасчетыСБюджетом.СтавкаНалогообложенияРезидента = &Дивиденды
		|					ТОГДА ""по дивидендам""
		|				ИНАЧЕ ""по ставке 15%""
		|			КОНЕЦ
		|		
		|		ОБЪЕДИНИТЬ ВСЕ
		|		
		|		ВЫБРАТЬ
		|			""Удержано"",
		|			ПогашениеЗаймовРаботникамиОрганизаций.Организация,
		|			НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ),
		|			ПогашениеЗаймовРаботникамиОрганизаций.ФизЛицо,
		|			""Погашение займа"",
		|			""ВААА"",
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			СУММА(ПогашениеЗаймовРаботникамиОрганизаций.ОсновнойДолг + ПогашениеЗаймовРаботникамиОрганизаций.Проценты),
		|			НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ),
		|			КОНЕЦПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ),
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL
		|		ИЗ
		|			РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций КАК ПогашениеЗаймовРаботникамиОрганизаций
		|		ГДЕ
		|			ПогашениеЗаймовРаботникамиОрганизаций.ВидДвижения = &Расход
		|			И ПогашениеЗаймовРаботникамиОрганизаций.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|			И ПогашениеЗаймовРаботникамиОрганизаций.УдержаноИзЗарплаты
		|		{ГДЕ
		|			ПогашениеЗаймовРаботникамиОрганизаций.ФизЛицо}
		|		
		|		СГРУППИРОВАТЬ ПО
		|			ПогашениеЗаймовРаботникамиОрганизаций.ДоговорЗайма,
		|			НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ),
		|			ПогашениеЗаймовРаботникамиОрганизаций.Организация,
		|			ПогашениеЗаймовРаботникамиОрганизаций.ФизЛицо,
		|			КОНЕЦПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ),
		|			НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ)
		|		
		|		ОБЪЕДИНИТЬ ВСЕ
		|		
		|		ВЫБРАТЬ
		|			""Выплата"",
		|			Взаиморасчеты.Организация,
		|			НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|			Взаиморасчеты.Физлицо,
		|			ВЫБОР
		|				КОГДА НЕ Взаиморасчеты.Регистратор ССЫЛКА Документ.ДепонированиеОрганизаций
		|					ТОГДА ВЫБОР
		|							КОГДА Взаиморасчеты.СпособВыплаты = &ЧерезКассу
		|								ТОГДА ""Через кассу ""
		|							КОГДА Взаиморасчеты.СпособВыплаты = &ЧерезБанк
		|								ТОГДА ""Перечислено в банк ""
		|							ИНАЧЕ ""Способ выплаты не указан ""
		|						КОНЕЦ + ВЫБОР
		|							КОГДА Взаиморасчеты.ХарактерВыплаты В (&Аванс)
		|								ТОГДА ""(аванс)""
		|							КОГДА Взаиморасчеты.ХарактерВыплаты = &Расчет
		|								ТОГДА ""(под расчет)""
		|							КОГДА Взаиморасчеты.ХарактерВыплаты = &ХарактерНеУказан
		|									И Взаиморасчеты.СуммаВзаиморасчетов > 0
		|								ТОГДА ""(не указано)""
		|							КОГДА Взаиморасчеты.ХарактерВыплаты = &ХарактерНеУказан
		|									И Взаиморасчеты.СуммаВзаиморасчетов < 0
		|								ТОГДА ""(погашено задолженности)""
		|							ИНАЧЕ ""(межрасчет)""
		|						КОНЕЦ + "" № "" + ВЫБОР
		|							КОГДА Взаиморасчеты.Регистратор ССЫЛКА Документ.ПриходныйКассовыйОрдер
		|								ТОГДА ВЫРАЗИТЬ(Взаиморасчеты.Регистратор КАК Документ.ПриходныйКассовыйОрдер).Номер
		|							ИНАЧЕ Взаиморасчеты.Ведомость.Номер
		|						КОНЕЦ
		|				ИНАЧЕ ""Задепонировано №"" + Взаиморасчеты.Ведомость.Номер
		|			КОНЕЦ,
		|			""ГААА1"",
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			СУММА(Взаиморасчеты.СуммаВзаиморасчетов),
		|			ВЫБОР
		|				КОГДА Взаиморасчеты.ПериодВзаиморасчетов = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ)
		|				ИНАЧЕ НАЧАЛОПЕРИОДА(Взаиморасчеты.ПериодВзаиморасчетов, МЕСЯЦ)
		|			КОНЕЦ,
		|			ВЫБОР
		|				КОГДА Взаиморасчеты.ПериодВзаиморасчетов = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА КОНЕЦПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ)
		|				ИНАЧЕ КОНЕЦПЕРИОДА(Взаиморасчеты.ПериодВзаиморасчетов, МЕСЯЦ)
		|			КОНЕЦ,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL
		|		ИЗ
		|			РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций КАК Взаиморасчеты
		|		ГДЕ
		|			Взаиморасчеты.ВидДвижения = &Расход
		|			И Взаиморасчеты.СуммаВзаиморасчетов <> 0
		|			И Взаиморасчеты.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		{ГДЕ
		|			Взаиморасчеты.Организация,
		|			Взаиморасчеты.Физлицо}
		|		
		|		СГРУППИРОВАТЬ ПО
		|			Взаиморасчеты.Организация,
		|			Взаиморасчеты.Физлицо,
		|			ВЫБОР
		|				КОГДА НЕ Взаиморасчеты.Регистратор ССЫЛКА Документ.ДепонированиеОрганизаций
		|					ТОГДА ВЫБОР
		|							КОГДА Взаиморасчеты.СпособВыплаты = &ЧерезКассу
		|								ТОГДА ""Через кассу ""
		|							КОГДА Взаиморасчеты.СпособВыплаты = &ЧерезБанк
		|								ТОГДА ""Перечислено в банк ""
		|							ИНАЧЕ ""Способ выплаты не указан ""
		|						КОНЕЦ + ВЫБОР
		|							КОГДА Взаиморасчеты.ХарактерВыплаты В (&Аванс)
		|								ТОГДА ""(аванс)""
		|							КОГДА Взаиморасчеты.ХарактерВыплаты = &Расчет
		|								ТОГДА ""(под расчет)""
		|							КОГДА Взаиморасчеты.ХарактерВыплаты = &ХарактерНеУказан
		|									И Взаиморасчеты.СуммаВзаиморасчетов > 0
		|								ТОГДА ""(не указано)""
		|							КОГДА Взаиморасчеты.ХарактерВыплаты = &ХарактерНеУказан
		|									И Взаиморасчеты.СуммаВзаиморасчетов < 0
		|								ТОГДА ""(погашено задолженности)""
		|							ИНАЧЕ ""(межрасчет)""
		|						КОНЕЦ + "" № "" + ВЫБОР
		|							КОГДА Взаиморасчеты.Регистратор ССЫЛКА Документ.ПриходныйКассовыйОрдер
		|								ТОГДА ВЫРАЗИТЬ(Взаиморасчеты.Регистратор КАК Документ.ПриходныйКассовыйОрдер).Номер
		|							ИНАЧЕ Взаиморасчеты.Ведомость.Номер
		|						КОНЕЦ
		|				ИНАЧЕ ""Задепонировано №"" + Взаиморасчеты.Ведомость.Номер
		|			КОНЕЦ,
		|			НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|			ВЫБОР
		|				КОГДА Взаиморасчеты.ПериодВзаиморасчетов = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА КОНЕЦПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ)
		|				ИНАЧЕ КОНЕЦПЕРИОДА(Взаиморасчеты.ПериодВзаиморасчетов, МЕСЯЦ)
		|			КОНЕЦ,
		|			ВЫБОР
		|				КОГДА Взаиморасчеты.ПериодВзаиморасчетов = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ)
		|				ИНАЧЕ НАЧАЛОПЕРИОДА(Взаиморасчеты.ПериодВзаиморасчетов, МЕСЯЦ)
		|			КОНЕЦ
		|		
		|		ОБЪЕДИНИТЬ ВСЕ
		|		
		|		ВЫБРАТЬ
		|			ВидыДвижения.ВидДвижения,
		|			Взаиморасчеты.Организация,
		|			НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|			Взаиморасчеты.Физлицо,
		|			""Компенсация за задержку выплаты заработной платы"",
		|			""ГААА2"",
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			СУММА(ЗарплатаКВыплатеОрганизацийЗарплата.КомпенсацияЗаЗадержкуЗарплаты),
		|			НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|			КОНЕЦПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL
		|		ИЗ
		|			РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций КАК Взаиморасчеты
		|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ЗарплатаКВыплатеОрганизаций.Зарплата КАК ЗарплатаКВыплатеОрганизацийЗарплата
		|				ПО Взаиморасчеты.Физлицо = ЗарплатаКВыплатеОрганизацийЗарплата.Физлицо
		|					И Взаиморасчеты.Ведомость = ЗарплатаКВыплатеОрганизацийЗарплата.Ссылка,
		|			(ВЫБРАТЬ
		|				""Начислено"" КАК ВидДвижения
		|			
		|			ОБЪЕДИНИТЬ ВСЕ
		|			
		|			ВЫБРАТЬ
		|				""Выплата"") КАК ВидыДвижения
		|		ГДЕ
		|			Взаиморасчеты.ВидДвижения = &Расход
		|			И Взаиморасчеты.СуммаВзаиморасчетов <> 0
		|			И Взаиморасчеты.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|			И ЗарплатаКВыплатеОрганизацийЗарплата.КомпенсацияЗаЗадержкуЗарплаты <> 0
		|		{ГДЕ
		|			Взаиморасчеты.Физлицо,
		|			Взаиморасчеты.Организация}
		|		
		|		СГРУППИРОВАТЬ ПО
		|			Взаиморасчеты.Организация,
		|			Взаиморасчеты.Физлицо,
		|			НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|			ВидыДвижения.ВидДвижения,
		|			КОНЕЦПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|			НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ)
		|		
		|		ОБЪЕДИНИТЬ ВСЕ
		|		
		|		ВЫБРАТЬ
		|			""Сальдо"",
		|			Сальдо.Организация,
		|			Периоды.ПериодРегистрации,
		|			Сальдо.Физлицо,
		|			"""",
		|			""ЯЯЯЯ"",
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			NULL,
		|			СУММА(ВЫБОР
		|					КОГДА Сальдо.Период < Периоды.ПериодРегистрации
		|						ТОГДА Сальдо.СуммаВзаиморасчетовОстаток
		|					ИНАЧЕ 0
		|				КОНЕЦ),
		|			СУММА(ВЫБОР
		|					КОГДА Сальдо.Период <= Периоды.ПериодРегистрации
		|						ТОГДА Сальдо.СуммаВзаиморасчетовОстаток
		|					ИНАЧЕ 0
		|				КОНЕЦ),
		|			СУММА(ВЫБОР
		|					КОГДА Сальдо.Период < Периоды.ПериодРегистрации
		|						ТОГДА Сальдо.СуммаНДФЛКОстаток
		|					ИНАЧЕ 0
		|				КОНЕЦ),
		|			СУММА(ВЫБОР
		|					КОГДА Сальдо.Период <= Периоды.ПериодРегистрации
		|						ТОГДА Сальдо.СуммаНДФЛКОстаток
		|					ИНАЧЕ 0
		|				КОНЕЦ),
		|			СУММА(Сальдо.СуммаВзаиморасчетовОборот)
		|		ИЗ
		|			(ВЫБРАТЬ РАЗЛИЧНЫЕ
		|				НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации
		|			ИЗ
		|				РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
		|			ГДЕ
		|				РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации) КАК Периоды
		|				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|					ВзаиморасчетыСРаботникамиОрганизацийОстатки.Организация КАК Организация,
		|					ДОБАВИТЬКДАТЕ(&ПериодРегистрации, МЕСЯЦ, -1) КАК Период,
		|					ВзаиморасчетыСРаботникамиОрганизацийОстатки.Физлицо КАК Физлицо,
		|					ВзаиморасчетыСРаботникамиОрганизацийОстатки.СуммаВзаиморасчетовОстаток КАК СуммаВзаиморасчетовОстаток,
		|					NULL КАК СуммаВзаиморасчетовОборот,
		|					NULL КАК СуммаНДФЛКОстаток
		|				ИЗ
		|					РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций.Остатки(&ПериодРегистрации, {(Физлицо), (Организация)}) КАК ВзаиморасчетыСРаботникамиОрганизацийОстатки
		|				
		|				ОБЪЕДИНИТЬ ВСЕ
		|				
		|				ВЫБРАТЬ
		|					ВзаиморасчетыСРаботникамиОрганизацийОбороты.Организация,
		|					ВзаиморасчетыСРаботникамиОрганизацийОбороты.Период,
		|					ВзаиморасчетыСРаботникамиОрганизацийОбороты.Физлицо,
		|					ВзаиморасчетыСРаботникамиОрганизацийОбороты.СуммаВзаиморасчетовОборот,
		|					NULL,
		|					NULL
		|				ИЗ
		|					РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций.Обороты(&ПериодРегистрации, &КонецПериодаРегистрации, Месяц, {(Организация), (Физлицо)}) КАК ВзаиморасчетыСРаботникамиОрганизацийОбороты
		|				
		|				ОБЪЕДИНИТЬ ВСЕ
		|				
		|				ВЫБРАТЬ
		|					НДФЛКЗачету.Организация,
		|					ДОБАВИТЬКДАТЕ(&ПериодРегистрации, МЕСЯЦ, -1),
		|					НДФЛКЗачету.ФизЛицо,
		|					НДФЛКЗачету.СуммаНДФЛКЗачетуОстаток,
		|					NULL,
		|					НДФЛКЗачету.СуммаНДФЛКЗачетуОстаток
		|				ИЗ
		|					РегистрНакопления.НДФЛКЗачету.Остатки(&ПериодРегистрации, {(ФизЛицо), (Организация)}) КАК НДФЛКЗачету
		|				
		|				ОБЪЕДИНИТЬ ВСЕ
		|				
		|				ВЫБРАТЬ
		|					НДФЛКЗачету.Организация,
		|					НДФЛКЗачету.Период,
		|					НДФЛКЗачету.ФизЛицо,
		|					НДФЛКЗачету.СуммаНДФЛКЗачетуОборот,
		|					NULL,
		|					НДФЛКЗачету.СуммаНДФЛКЗачетуОборот
		|				ИЗ
		|					РегистрНакопления.НДФЛКЗачету.Обороты(&ПериодРегистрации, &КонецПериодаРегистрации, Месяц, {(Организация), (ФизЛицо)}) КАК НДФЛКЗачету
		|				
		|				ОБЪЕДИНИТЬ ВСЕ
		|				
		|				ВЫБРАТЬ
		|					ВзаиморасчетыСРаботникамиОрганизацийОбороты.Организация,
		|					ВзаиморасчетыСРаботникамиОрганизацийОбороты.Период,
		|					ВзаиморасчетыСРаботникамиОрганизацийОбороты.Физлицо,
		|					NULL,
		|					ВзаиморасчетыСРаботникамиОрганизацийОбороты.СуммаВзаиморасчетовОборот,
		|					NULL
		|				ИЗ
		|					РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций.Обороты(&ПериодРегистрации, &КонецПериодаРегистрации, Месяц, {(Организация), (Физлицо)}) КАК ВзаиморасчетыСРаботникамиОрганизацийОбороты) КАК Сальдо
		|				ПО (Сальдо.Период <= Периоды.ПериодРегистрации)
		|		{ГДЕ
		|			Сальдо.Организация,
		|			Сальдо.Физлицо}
		|		
		|		СГРУППИРОВАТЬ ПО
		|			Сальдо.Организация,
		|			Сальдо.Физлицо,
		|			Периоды.ПериодРегистрации) КАК НачисленияУдержания) КАК НачисленияУдержания
		|{ГДЕ
		|	НачисленияУдержания.ФизЛицо,
		|	НачисленияУдержания.ПериодРегистрации}
		|
		|УПОРЯДОЧИТЬ ПО
		|	ПериодРегистрации,
		|	ФизЛицо,
		|	ВидДвижения,
		|	ПорядокВидаРасчета,
		|	ВидРасчета,
		|	ПериодДействияНачало
		|ИТОГИ ПО
		|	Организация,
		|	ПериодРегистрации,
		|	ФизЛицо,
		|	ВидДвижения";
		
	КонецЕсли;

	
	ТекстПостроителя = УправлениеОтчетамиЗК.СформироватьСписокМесяцев(ТекстПостроителя, ДатаНач, ДатаКон);
	
	ПостроительОтчетов.Текст = ТекстПостроителя;
	
	// Подготовим построитель запросов к настройке отборов
	ПостроительОтчетов.ЗаполнитьНастройки();
	ПостроительОтчетов.Отбор.Сбросить();
	
КонецПроцедуры

// Заполняет таблицу значений "НачисленияУдержания" (внешний источник данных).
//
Процедура ЗаполнитьВнешнийИсточникДанных(ПостроительОтчетов, ВидРасчетногоЛистка) Экспорт
	
	// Выполнить запрос 
	ПостроительОтчетов.Выполнить();
	
	// Получим таблицу результатов запроса
	ТаблицаРезультатаЗапроса = ПостроительОтчетов.Результат.Выгрузить(ОбходРезультатаЗапроса.ПоГруппировкамСИерархией);
	
	СведенияОВидахРасчета     = Новый Соответствие;
	
	// Сформировать таблицу значений
	НачисленияУдержания.Очистить();
	
	// Если вид расчетного листка подробный сформируем выборку с фактическими периодами действия начислений
	Если ВидРасчетногоЛистка = "Подробно" тогда
		// сформируем начальное и конечное сальдо
		Запрос = Новый Запрос;
		
		ФПДУсловиеТекст = 
		"ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации";
		ПолеОрганизация = Новый ПолеКомпоновкиДанных("Организация");
		ПолеФизЛицо     = Новый ПолеКомпоновкиДанных("ФизЛицо");
		ПолеСотрудник   = Новый ПолеКомпоновкиДанных("Сотрудник");
		
		Для каждого ЭлементОтбора из КомпоновщикНастроек.Настройки.Отбор.Элементы Цикл
			
			Если ЭлементОтбора.Использование И ТипЗнч(ЭлементОтбора) = Тип("ЭлементОтбораКомпоновкиДанных") И ЭлементОтбора.ЛевоеЗначение = ПолеОрганизация Тогда
				
				Запрос.УстановитьПараметр("Организация", ЭлементОтбора.ПравоеЗначение);
				
				Если ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно Тогда
					ВидСравненияОрганизацииСтрокой = "=" 
				ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.НеРавно Тогда
					ВидСравненияОрганизацииСтрокой = "<>"
				ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВСписке Тогда
					ВидСравненияОрганизацииСтрокой = "В"
				ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВСпискеПоИерархии ИЛИ 
					ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВИерархии Тогда
					ВидСравненияОрганизацииСтрокой = "В ИЕРАРХИИ"
				ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.НеВСписке Тогда
					ВидСравненияОрганизацииСтрокой = " НЕ В"
				ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.НеВСпискеПоИерархии ИЛИ 
					ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.НеВИерархии Тогда
					ВидСравненияОрганизацииСтрокой = "НЕ В ИЕРАРХИИ"
				КонецЕсли; 
				
				ФПДУсловиеТекст = ФПДУсловиеТекст + " И Организация " + ВидСравненияОрганизацииСтрокой + " (&Организация)";
			КонецЕсли;  
			
			
			Если ЭлементОтбора.Использование И ТипЗнч(ЭлементОтбора) = Тип("ЭлементОтбораКомпоновкиДанных") И ЭлементОтбора.ЛевоеЗначение = ПолеФизЛицо Тогда
				
				Запрос.УстановитьПараметр("РаботникиОрганизации", ЭлементОтбора.ПравоеЗначение);
				
				Если ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно Тогда
					ВидСравненияРаботник = "=" 
				ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.НеРавно Тогда
					ВидСравненияРаботник = "<>"
				ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВСписке Тогда
					ВидСравненияРаботник = "В"
				ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВСпискеПоИерархии ИЛИ 
					ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВИерархии Тогда
					ВидСравненияРаботник = "В ИЕРАРХИИ"
				ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.НеВСписке Тогда
					ВидСравненияРаботник = " НЕ В"
				ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.НеВСпискеПоИерархии ИЛИ 
					ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.НеВИерархии Тогда
					ВидСравненияРаботник = "НЕ В ИЕРАРХИИ"
				КонецЕсли; 
				
				ФПДУсловиеТекст = ФПДУсловиеТекст + " И ФизЛицо " + ВидСравненияРаботник + " (&РаботникиОрганизации)";
			КонецЕсли; 
			
			Если ЭлементОтбора.Использование И ТипЗнч(ЭлементОтбора) = Тип("ЭлементОтбораКомпоновкиДанных") И ЭлементОтбора.ЛевоеЗначение = ПолеСотрудник И ТипЗнч(ЭлементОтбора.ПравоеЗначение) = Тип("СправочникСсылка.СотрудникиОрганизаций") Тогда
				
				Запрос.УстановитьПараметр("РаботникиОрганизации", ЭлементОтбора.ПравоеЗначение.ФизЛицо);
				
				Если ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно Тогда
					ВидСравненияРаботник = "=" 
				ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.НеРавно Тогда
					ВидСравненияРаботник = "<>"
				ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВСписке Тогда
					ВидСравненияРаботник = "В"
				ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВСпискеПоИерархии ИЛИ 
					ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВИерархии Тогда
					ВидСравненияРаботник = "В ИЕРАРХИИ"
				ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.НеВСписке Тогда
					ВидСравненияРаботник = " НЕ В"
				ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.НеВСпискеПоИерархии ИЛИ 
					ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.НеВИерархии Тогда
					ВидСравненияРаботник = "НЕ В ИЕРАРХИИ"
				КонецЕсли; 
				
				ФПДУсловиеТекст = ФПДУсловиеТекст + " И ФизЛицо " + ВидСравненияРаботник + " (&РаботникиОрганизации)";
			КонецЕсли; 
			
		КонецЦикла;
		
		ТекстЗапроса =
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ФактическийПериод.Регистратор КАК Регистратор,
		|	ФактическийПериод.НомерСтроки КАК НомерСтроки,
		|	ФактическийПериод.ПериодДействияНачало,
		|	ФактическийПериод.ПериодДействияКонец
		|ИЗ
		|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(" + ФПДУсловиеТекст + ") КАК ФактическийПериод
		|
		|УПОРЯДОЧИТЬ ПО
		|	Регистратор,
		|	НомерСтроки,
		|	ПериодДействияНачало";
		
		Запрос.Текст = ТекстЗапроса;
		
		ДатаНач = КомпоновщикНастроек.Настройки.ПараметрыДанных.Элементы.Найти("НачалоПериода").Значение;
		ДатаКон = КомпоновщикНастроек.Настройки.ПараметрыДанных.Элементы.Найти("КонецПериода").Значение;
		Запрос.УстановитьПараметр("ПериодРегистрации", 	  	 ДатаНач);
		Запрос.УстановитьПараметр("КонецПериодаРегистрации", ДатаКон);
		ВыборкаПоФПД = Запрос.Выполнить().Выбрать();
		
	КонецЕсли;
	
	// Заполним таблицу значений
	Для каждого СтрокаОрганизация  из ТаблицаРезультатаЗапроса.Строки Цикл
		Для каждого СтрокаПериодаРегистрации из СтрокаОрганизация.Строки Цикл
			Для каждого СтрокаФизЛицо из СтрокаПериодаРегистрации.Строки Цикл
				
				Выполнился = истина;
				
				// Получим таблицы значений по каждой из частей расчетного листка
				Начисления              = СтрокаФизЛицо.Строки.Найти("Начислено", "ВидДвижения");
				Удержания               = СтрокаФизЛицо.Строки.Найти("Удержано", "ВидДвижения");
				ДоходыВНатуральнойФорме = СтрокаФизЛицо.Строки.Найти("ДоходыВНатуральнойФорме", "ВидДвижения");
				Выплачено              	= СтрокаФизЛицо.Строки.Найти("Выплата", "ВидДвижения");
				Сальдо                  = СтрокаФизЛицо.Строки.Найти("Сальдо", "ВидДвижения");
				
				// Определим максимальное количество строк из таблиц начислений и удержания
				КолВоСтрокНачислений = ?(Начисления <> Неопределено, Начисления.Строки.Количество(), 0)- 1;
				КолВоСтрокУдержаний  = ?(Удержания <> Неопределено, Удержания.Строки.Количество(), 0) - 1; 
				МаксКолвоСтрок = Макс(КолВоСтрокНачислений, КолВоСтрокУдержаний); 
				
				//Проверяем количество строк в отчет
				Если Сальдо <> Неопределено И Сальдо.Строки.Количество()> 0 тогда
					СтрокаСальдо = Сальдо.Строки[0];
					СальдоКон = ?(СтрокаСальдо.СальдоКонечное = NUll, 0, СтрокаСальдо.СальдоКонечное);
					СальдоНач = ?(СтрокаСальдо.СальдоНачальное = Null, 0, СтрокаСальдо.СальдоНачальное);
					СальдоКонНДФЛ = СтрокаСальдо.СальдоКонечноеНДФЛ;
					СальдоНачНДФЛ = СтрокаСальдо.СальдоНачальноеНДФЛ;
					Оборот    = ?(СтрокаСальдо.Оборот = Null, 0, СтрокаСальдо.Оборот);
				Иначе
					СальдоКон = 0;
					СальдоНач = 0;
					Оборот    = 0;
				КОнецЕсли; 
				
				//Если МаксКолвоСтрок = -1 И СтрокаСальдо <> Неопределено тогда
				//	СтрокаНачисленияУдержания                            = НачисленияУдержания.Добавить();
				//	СтрокаНачисленияУдержания.ВидДвижения                = "3";
				//	СтрокаНачисленияУдержания.ПризнакУпорядочиванияСтрок = 999;
				//	СтрокаНачисленияУдержания.СальдоНачальное = СальдоНач;
				//	СтрокаНачисленияУдержания.СальдоКонечное  = СальдоКон;
				//	СтрокаНачисленияУдержания.СальдоНачальноеНДФЛ = СальдоНачНДФЛ;
				//	СтрокаНачисленияУдержания.СальдоКонечноеНДФЛ  = СальдоКонНДФЛ;
				//	СтрокаНачисленияУдержания.Оборот          = Оборот;
				//КонецЕсли;
				
				
				// Перенесем таблицы начисления  значений в таблицу внешнего источника данных 
				Сч = 0;
				
				Пока Сч <= МаксКолвоСтрок Цикл
					
					НомерСтрокиНачисления = 0;
					РегистраторНачисления = "";
					
					// Добавим строку и заполним значений колонок
					СтрокаНачисленияУдержания                            = НачисленияУдержания.Добавить();
					СтрокаНачисленияУдержания.ВидДвижения                = "1";
					СтрокаНачисленияУдержания.ПризнакУпорядочиванияСтрок = Сч;
					СтрокаНачисленияУдержания.СальдоНачальное = СальдоНач;
					СтрокаНачисленияУдержания.СальдоКонечное  = СальдоКон;
					СтрокаНачисленияУдержания.СальдоНачальноеНДФЛ = СальдоНачНДФЛ;
					СтрокаНачисленияУдержания.СальдоКонечноеНДФЛ  = СальдоКонНДФЛ;
					СтрокаНачисленияУдержания.Оборот          = Оборот + 1;
					
					
					Если Сч <= КолВоСтрокНачислений тогда
						СтрокаНачисленияУдержания.ФизЛицо             = Начисления.Строки[Сч].ФизЛицо;
						СтрокаНачисленияУдержания.Организация         = Начисления.Строки[Сч].Организация;
//						СтрокаНачисленияУдержания.ГоловнаяОрганизация = ОбщегоНазначенияЗК.ГоловнаяОрганизация(Начисления.Строки[Сч].Организация);
						СтрокаНачисленияУдержания.ПериодРегистрации   = Начисления.Строки[Сч].ПериодРегистрации;
						
						// Если вид расчетного листка подробный, то добавим к начислению периоды действия и показатели
						Если ВидРасчетногоЛистка = "Подробно" И (ТипЗнч(Начисления.Строки[Сч].ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") 
							ИЛИ ТипЗнч(Начисления.Строки[Сч].ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций")) тогда
							
							ВидРасчета = Начисления.Строки[Сч].ВидРасчета;
							
							ВидНачисленияНаименование = Строка(ВидРасчета) + Начисления.Строки[Сч].ДополнениеКВидуРасчета;
							
							НомерСтрокиНачисления = Начисления.Строки[Сч].НомерСтроки;
							РегистраторНачисления = Начисления.Строки[Сч].Регистратор;
							НачалоПериодаДействия = Начисления.Строки[Сч].ПериодДействияНачало;
							КонецПериодаДействия  = Начисления.Строки[Сч].ПериодДействияКонец;
							СчДобавленныхСтрок = 1;
							СведенияОВидеРасчета = ЗаполнениеДокументовЗК.ПолучитьСведенияОВидеРасчетаСхемыМотивации(СведенияОВидахРасчета, ВидРасчета, "ПриРасчете");
							ПервыйРаз = истина;
							
							Для СчПоказатель = 1 по Мин(СведенияОВидеРасчета["КоличествоПоказателей"], 6) Цикл
								Если СведенияОВидеРасчета["Показатель"+СчПоказатель+"Видимость"] И СведенияОВидеРасчета["Показатель" + СчПоказатель + "Наименование"] <> Null тогда
									Если ПервыйРаз тогда
										ВидНачисленияНаименование = ВидНачисленияНаименование + Символы.ПС + " показатели:";
										ПервыйРаз                 = ложь;
									КонецЕсли;
									ВидНачисленияНаименование = ВидНачисленияНаименование + Символы.ПС + " " + СведенияОВидеРасчета["Показатель" + СчПоказатель + "Наименование"] + " - " + Начисления.Строки[Сч]["Показатель"+СчПоказатель];
								ИначеЕсли СведенияОВидеРасчета["ПоказательТР" + СчПоказатель + "НаименованиеВидимость"] И СведенияОВидеРасчета["ПоказательТР" + СчПоказатель + "Наименование"] <> Null тогда
									Если ПервыйРаз тогда
										ВидНачисленияНаименование = ВидНачисленияНаименование + Символы.ПС + " показатели:";
										ПервыйРаз                 = ложь;
									КонецЕсли;
									ВидНачисленияНаименование = ВидНачисленияНаименование + Символы.ПС + " " + СведенияОВидеРасчета["ПоказательТР" + СчПоказатель + "Наименование"] + " - " + Начисления.Строки[Сч]["Показатель"+СчПоказатель];
								КонецЕсли;                                                                  
							КонецЦикла;
							
							СтрокаНачисленияУдержания.НачисленияУдержанияВидНачисления = ВидНачисленияНаименование;
							
							Если ТипЗнч(Начисления.Строки[Сч].ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
								ВыборкаПоФПД.Сбросить();
								Если ВыборкаПоФПД.НайтиСледующий(Новый Структура("Регистратор, НомерСтроки", РегистраторНачисления, НомерСтрокиНачисления)) Тогда
									Если (ВыборкаПоФПД.ПериодДействияНачало <> НачалоПериодаДействия) или (ВыборкаПоФПД.ПериодДействияКонец <> КонецПериодаДействия) Тогда
										
										СтрокаНачислений                      = Начисления.Строки.Вставить(Сч+СчДобавленныхСтрок);
										СтрокаНачислений.ВидРасчета           = "  оплачены периоды:";
										СтрокаНачислений.ФизЛицо              = Начисления.Строки[Сч].ФизЛицо;
										СтрокаНачислений.Организация          = Начисления.Строки[Сч].Организация;
										СтрокаНачислений.ПериодРегистрации    = Начисления.Строки[Сч].ПериодРегистрации;
										СтрокаНачислений.ПериодДействияНачало = ВыборкаПоФПД.ПериодДействияНачало;
										СтрокаНачислений.ПериодДействияКонец  = ВыборкаПоФПД.ПериодДействияКонец;
										КолВоСтрокНачислений                  = КолВоСтрокНачислений + 1;
										МаксКолвоСтрок                      = МаксКолвоСтрок + 1;
										СчДобавленныхСтрок                    = СчДобавленныхСтрок + 1;
										
										Пока ВыборкаПоФПД.Следующий() Цикл
											
											Если ВыборкаПоФПД.НомерСтроки <> НомерСтрокиНачисления или ВыборкаПоФПД.Регистратор <> РегистраторНачисления Тогда
												Прервать;
											КонецЕсли;
											
											СтрокаНачислений                      = Начисления.Строки.Вставить(Сч+СчДобавленныхСтрок);
											СтрокаНачислений.ВидРасчета           = "";
											СтрокаНачислений.ФизЛицо              = Начисления.Строки[Сч].ФизЛицо;
											СтрокаНачислений.Организация          = Начисления.Строки[Сч].Организация;
											СтрокаНачислений.ПериодРегистрации    = Начисления.Строки[Сч].ПериодРегистрации;
											СтрокаНачислений.ПериодДействияНачало = ВыборкаПоФПД.ПериодДействияНачало;
											СтрокаНачислений.ПериодДействияКонец  = ВыборкаПоФПД.ПериодДействияКонец;
											КолВоСтрокНачислений                  = КолВоСтрокНачислений + 1;
											МаксКолвоСтрок                      = МаксКолвоСтрок + 1;
											СчДобавленныхСтрок                    = СчДобавленныхСтрок + 1;
											
										КонецЦикла;
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
						Иначе
							СтрокаНачисленияУдержания.НачисленияУдержанияВидНачисления = Начисления.Строки[Сч].ВидРасчета;
						КонецЕсли;
						СтрокаНачисленияУдержания.НачисленияУдержанияОтработанныеДни   = Начисления.Строки[Сч].ОтработаноДней;
						СтрокаНачисленияУдержания.НачисленияУдержанияОтработанныеЧасы  = Начисления.Строки[Сч].ОтработаноЧасов;
						СтрокаНачисленияУдержания.НачисленияУдержанияОплаченныеДни     = Начисления.Строки[Сч].ОплаченоДней;
						СтрокаНачисленияУдержания.НачисленияУдержанияОплаченныеЧасы    = Начисления.Строки[Сч].ОплаченоЧасов;
						СтрокаНачисленияУдержания.НачисленияУдержанияСуммаНачисления   = Начисления.Строки[Сч].Результат;
						
						Если ВидРасчетногоЛистка = "Подробно" и ТипЗнч(Начисления.Строки[Сч].ПериодДействияНачало) = Тип("Дата") тогда
							СтрокаНачисленияУдержания.НачисленияУдержанияПериодНачисления = УправлениеОтчетамиЗК.ОписаниеПериода(Начисления.Строки[Сч].ПериодДействияНачало, Начисления.Строки[Сч].ПериодДействияКонец);
						ИначеЕсли ВидРасчетногоЛистка = "Рабочий" и ТипЗнч(Начисления.Строки[Сч].ПериодДействия) = Тип("Дата") тогда
							СтрокаНачисленияУдержания.НачисленияУдержанияПериодНачисления = Формат(Начисления.Строки[Сч].ПериодДействия, "ДФ='MMММ yy'");
						КонецЕсли;
						
					КонецЕсли;
					
					// Добавим строку 2-го раздела
					Если Сч <= КолВоСтрокУдержаний тогда
						
						СтрокаНачисленияУдержания.ФизЛицо                         = Удержания.Строки[Сч].ФизЛицо;
						СтрокаНачисленияУдержания.Организация                     = Удержания.Строки[Сч].Организация;
//						СтрокаНачисленияУдержания.ГоловнаяОрганизация             = ОбщегоНазначенияЗК.ГоловнаяОрганизация(Удержания.Строки[Сч].Организация);
						СтрокаНачисленияУдержания.ПериодРегистрации               = Удержания.Строки[Сч].ПериодРегистрации;
						
						ВидРасчета = Удержания.Строки[Сч].ВидРасчета;
						ВидУдержанияНаименование = Строка(ВидРасчета);	
						
						Если ВидРасчетногоЛистка = "Подробно" тогда
							СтрокаНачисленияУдержания.НачисленияУдержанияПериодУдержания = УправлениеОтчетамиЗК.ОписаниеПериода(Удержания.Строки[Сч].ПериодДействияНачало, Удержания.Строки[Сч].ПериодДействияКонец);
							
							Если  ТипЗнч(ВидРасчета) = Тип("ПланВидовРасчетаСсылка.УдержанияОрганизаций") тогда
								СведенияОВидеРасчета = ЗаполнениеДокументовЗК.ПолучитьСведенияОВидеРасчетаСхемыМотивации(СведенияОВидахРасчета, ВидРасчета, "ПриРасчете");
								ПервыйРаз = истина;
								Для СчПоказатель = 1 по Мин(СведенияОВидеРасчета["КоличествоПоказателей"], 6) Цикл
									Если СведенияОВидеРасчета["Показатель"+СчПоказатель+"Видимость"] И СведенияОВидеРасчета["Показатель" + СчПоказатель + "Наименование"] <> Null тогда
										Если ПервыйРаз тогда
											ВидУдержанияНаименование = ВидУдержанияНаименование + Символы.ПС + " показатели:";
											ПервыйРаз                 = ложь;
										КонецЕсли;
										ВидУдержанияНаименование = ВидУдержанияНаименование + Символы.ПС + " " + СведенияОВидеРасчета["Показатель" + СчПоказатель + "Наименование"] + " - " + Удержания.Строки[Сч]["Показатель"+СчПоказатель];
									ИначеЕсли СведенияОВидеРасчета["ПоказательТР" + СчПоказатель + "НаименованиеВидимость"] И СведенияОВидеРасчета["ПоказательТР" + СчПоказатель + "Наименование"] <> Null тогда
										Если ПервыйРаз тогда
											ВидУдержанияНаименование = ВидУдержанияНаименование + Символы.ПС + " показатели:";
											ПервыйРаз                 = ложь;
										КонецЕсли;
										ВидУдержанияНаименование = ВидУдержанияНаименование + Символы.ПС + " " + СведенияОВидеРасчета["ПоказательТР" + СчПоказатель + "Наименование"] + " - " + Удержания.Строки[Сч]["Показатель"+СчПоказатель];
									КонецЕсли;                                                                  
								КонецЦикла;
							КонецЕсли;
						ИначеЕсли ВидРасчетногоЛистка = "Рабочий" и ТипЗнч(Удержания.Строки[Сч].ПериодДействия) = Тип("Дата") тогда
							СтрокаНачисленияУдержания.НачисленияУдержанияПериодНачисления = Формат(Удержания.Строки[Сч].ПериодДействия, "ДФ=dd.MM.yy");
						КонецЕсли;
						СтрокаНачисленияУдержания.НачисленияУдержанияВидУдержания = ВидУдержанияНаименование; 
						
						СтрокаНачисленияУдержания.НачисленияУдержанияСуммаУдержания    = Удержания.Строки[Сч].Результат;
						
					КонецЕсли;
					
					Сч = Сч + 1;
					
				КонецЦикла;
				
				КолВоСтрокДоходыВНатуральнойФорме = ?(ДоходыВНатуральнойФорме <> Неопределено, ДоходыВНатуральнойФорме.Строки.Количество(), 0)-1;
				КолВоСтрокВыплачено               = ?(Выплачено <> Неопределено, Выплачено.Строки.Количество(), 0)-1;
				
				Если МаксКолвоСтрок = -1 И Макс(КолВоСтрокДоходыВНатуральнойФорме, КолВоСтрокВыплачено) = -1 тогда
					СтрокаНачисленияУдержания                            = НачисленияУдержания.Добавить();
					СтрокаНачисленияУдержания.ВидДвижения                = "3";
					СтрокаНачисленияУдержания.ПризнакУпорядочиванияСтрок = 0;
					СтрокаНачисленияУдержания.ФизЛицо           = СтрокаФизЛицо.ФизЛицо;
					СтрокаНачисленияУдержания.Организация       = СтрокаФизЛицо.Организация;
					//СтрокаНачисленияУдержания.ГоловнаяОрганизация = ОбщегоНазначенияЗК.ГоловнаяОрганизация(СтрокаФизЛицо.Организация);
					СтрокаНачисленияУдержания.ПериодРегистрации = СтрокаФизЛицо.ПериодРегистрации;
					СтрокаНачисленияУдержания.СальдоНачальное   = СальдоНач;
					СтрокаНачисленияУдержания.СальдоКонечное    = СальдоКон;
					СтрокаНачисленияУдержания.СальдоНачальноеНДФЛ = СальдоНачНДФЛ;
					СтрокаНачисленияУдержания.СальдоКонечноеНДФЛ  = СальдоКонНДФЛ;
					
					СтрокаНачисленияУдержания.Оборот            = Оборот + 1;
				КонецЕсли;
				
				МаксКолвоСтрок = Макс(КолВоСтрокДоходыВНатуральнойФорме, КолВоСтрокВыплачено);
				
				// заполним строки 3-го и 4-го разделов
				Для Сч = 0 по МаксКолвоСтрок Цикл
					
					СтрокаНачисленияУдержания = НачисленияУдержания.Добавить();
					СтрокаНачисленияУдержания.ВидДвиженияУд = "2";
					
					СтрокаНачисленияУдержания.СальдоНачальное = СальдоНач;
					СтрокаНачисленияУдержания.СальдоКонечное  = СальдоКон;
					СтрокаНачисленияУдержания.СальдоНачальноеНДФЛ = СальдоНачНДФЛ;
					СтрокаНачисленияУдержания.СальдоКонечноеНДФЛ  = СальдоКонНДФЛ;
					
					СтрокаНачисленияУдержания.Оборот          = Оборот+1;
					
					Если Сч <= КолВоСтрокДоходыВНатуральнойФорме тогда
						
						СтрокаНачисленияУдержания.ФизЛицо             = ДоходыВНатуральнойФорме.Строки[Сч].ФизЛицо;
						СтрокаНачисленияУдержания.Организация         = ДоходыВНатуральнойФорме.Строки[Сч].Организация;
//						СтрокаНачисленияУдержания.ГоловнаяОрганизация = ОбщегоНазначенияЗК.ГоловнаяОрганизация(ДоходыВНатуральнойФорме.Строки[Сч].Организация);
						СтрокаНачисленияУдержания.ПериодРегистрации   = ДоходыВНатуральнойФорме.Строки[Сч].ПериодРегистрации;
						
						Если ВидРасчетногоЛистка = "Подробно" тогда
							СтрокаНачисленияУдержания.НачисленияУдержанияВидНачисления = Строка(ДоходыВНатуральнойФорме.Строки[Сч].ВидРасчета) + ДоходыВНатуральнойФорме.Строки[Сч].ДополнениеКВидуРасчета;
						Иначе
							СтрокаНачисленияУдержания.НачисленияУдержанияВидНачисления = ДоходыВНатуральнойФорме.Строки[Сч].ВидРасчета;
						КонецЕсли;
						
						Если ВидРасчетногоЛистка = "Подробно" тогда
							СтрокаНачисленияУдержания.НачисленияУдержанияПериодНачисления = УправлениеОтчетамиЗК.ОписаниеПериода(ДоходыВНатуральнойФорме.Строки[Сч].ПериодДействияНачало, ДоходыВНатуральнойФорме.Строки[Сч].ПериодДействияКонец);
						КонецЕсли;
						
						СтрокаНачисленияУдержания.НачисленияУдержанияОтработанныеДни   = ДоходыВНатуральнойФорме.Строки[Сч].ОтработаноДней;
						СтрокаНачисленияУдержания.НачисленияУдержанияОтработанныеЧасы  = ДоходыВНатуральнойФорме.Строки[Сч].ОтработаноЧасов;
						СтрокаНачисленияУдержания.НачисленияУдержанияОплаченныеДни     = ДоходыВНатуральнойФорме.Строки[Сч].ОплаченоДней;
						СтрокаНачисленияУдержания.НачисленияУдержанияОплаченныеЧасы    = ДоходыВНатуральнойФорме.Строки[Сч].ОплаченоЧасов;
						СтрокаНачисленияУдержания.НачисленияУдержанияСуммаНачисления   = ДоходыВНатуральнойФорме.Строки[Сч].Результат;
						
					КонецЕсли;
					
					Если Сч <= КолВоСтрокВыплачено тогда
						
						СтрокаНачисленияУдержания.ФизЛицо                         = Выплачено.Строки[Сч].ФизЛицо;
						СтрокаНачисленияУдержания.Организация                     = Выплачено.Строки[Сч].Организация;
//						СтрокаНачисленияУдержания.ГоловнаяОрганизация             = ОбщегоНазначенияЗК.ГоловнаяОрганизация(Выплачено.Строки[Сч].Организация);
						СтрокаНачисленияУдержания.ПериодРегистрации               = Выплачено.Строки[Сч].ПериодРегистрации;
						
						Если ВидРасчетногоЛистка = "Подробно"  Тогда
							//СтрокаНачисленияУдержания.НачисленияУдержанияВидУдержания = Выплачено.Строки[Сч].ВидРасчета + " от " + Формат(Выплачено.Строки[Сч].ДатаВедомости, "ДФ=dd.MM.yyyy"); 
							СтрокаНачисленияУдержания.НачисленияУдержанияВидУдержания = Выплачено.Строки[Сч].ВидРасчета ; 

						Иначе
							СтрокаНачисленияУдержания.НачисленияУдержанияВидУдержания = Выплачено.Строки[Сч].ВидРасчета; 
						КонецЕсли;
						
						Если ВидРасчетногоЛистка = "Подробно" тогда
							СтрокаНачисленияУдержания.НачисленияУдержанияПериодУдержания = УправлениеОтчетамиЗК.ОписаниеПериода(Выплачено.Строки[Сч].ПериодДействияНачало, Выплачено.Строки[Сч].ПериодДействияКонец);
						ИначеЕсли ВидРасчетногоЛистка = "Рабочий" и ТипЗнч(Выплачено.Строки[Сч].ПериодДействия) = Тип("Дата") тогда
							СтрокаНачисленияУдержания.НачисленияУдержанияПериодУдержания = Формат(Выплачено.Строки[Сч].ПериодДействия, "ДФ=dd.MM.yy");
						КонецЕсли;
						
						СтрокаНачисленияУдержания.НачисленияУдержанияСуммаУдержания    = Выплачено.Строки[Сч].Результат;
						
					КонецЕсли;
				КонецЦикла;
			КонецЦикла;
		КонецЦикла;
	КонецЦикла;
КонецПроцедуры

// Вывод заголовка отчета
//
Процедура ВыводЗаголовкаОтчета(Результат, ВыводВФормуОтчета = Истина) Экспорт
	
	Если РасширеннаяНастройка Тогда
		Возврат;                                           
	КонецЕсли;
	
	ЗначениеПараметра = КомпоновщикНастроек.Настройки.ПараметрыВывода.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("TitleOutput"));
	ВыводитьЗаголовок = (ЗначениеПараметра.Значение = ТипВыводаТекстаКомпоновкиДанных.Выводить И ЗначениеПараметра.Использование);
	
	Если Не ВыводВФормуОтчета И Не ВыводитьЗаголовок Тогда
		Возврат;
	КонецЕсли;
	
	
	МакетЗаголовок = ПолучитьОбщийМакет("ЗаголовокТиповогоОтчета");
	ОбластьЗаголовок = МакетЗаголовок.ПолучитьОбласть("Заголовок");
	ЗаголовокОтчета = КомпоновщикНастроек.Настройки.ПараметрыВывода.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("Title")).Значение;
	ОбластьЗаголовок.Параметры.ЗаголовокОтчета = ЗаголовокОтчета;
	Результат.Вывести(ОбластьЗаголовок);
	
КонецПроцедуры

Функция ПолучитьТипРазмещенияТекста(ТипРазмещения)
	
	Если ТипРазмещения = ТипРазмещенияТекстаКомпоновкиДанных.Выступать тогда
		Возврат ТипРазмещенияТекстаТабличногоДокумента.Авто;
	ИначеЕсли ТипРазмещения = ТипРазмещенияТекстаКомпоновкиДанных.Забивать тогда
		Возврат ТипРазмещенияТекстаТабличногоДокумента.Забивать;
	ИначеЕсли ТипРазмещения = ТипРазмещенияТекстаКомпоновкиДанных.Обрезать тогда
		Возврат ТипРазмещенияТекстаТабличногоДокумента.Обрезать;
	ИначеЕсли ТипРазмещения = ТипРазмещенияТекстаКомпоновкиДанных.Переносить тогда
		Возврат ТипРазмещенияТекстаТабличногоДокумента.Переносить;
	КонецЕсли;
	
КонецФункции

// Разбивает табличный документ по страницам
//
// Параметры:
//  ТабличныйДокумент - ссылка на табличный документ.
//
Процедура РазбитьТабличныйДокументПоСтраницам(ТабличныйДокумент)
	
	#Если НЕ Сервер И НЕ ВнешнееСоединение Тогда
		Состояние(НСТР("ru='Разделение расчетных листков по страницам ...  (Если вы хотите прервать вывод отчета, нажмите Ctrl+Break)'"));
	#КонецЕсли
	
	ТабличныйДокументДляПроверки = Новый ТабличныйДокумент;
	ТабличныйДокументДляПроверки.Очистить();
	
	
	Для сч = 0 по НастройкаШириныКолонокРасчетногоЛистка.ВГраница() Цикл
		ОбластьКолонкиРЛ                  = ТабличныйДокумент.Область(, сч+1, , сч+1);
		ОбластьКолонкиРЛ.ШиринаКолонки    = НастройкаШириныКолонокРасчетногоЛистка[сч];
		ОбластьКолонкиРЛ.РазмещениеТекста = ПолучитьТипРазмещенияТекста(НастройкаРазмТекстаКолонокРасчетногоЛистка[сч]);
	КонецЦикла;
	
	
	Для сч = 0 по НастройкаШириныКолонокРасчетногоЛистка.ВГраница() Цикл
		ОбластьКолонкиРЛ                  = ТабличныйДокументДляПроверки.Область(, сч+1, , сч+1);
		ОбластьКолонкиРЛ.ШиринаКолонки    = НастройкаШириныКолонокРасчетногоЛистка[сч];
		ОбластьКолонкиРЛ.РазмещениеТекста = ПолучитьТипРазмещенияТекста(НастройкаРазмТекстаКолонокРасчетногоЛистка[сч]);
	КонецЦикла;
	
	ТабличныйДокументДляПроверки.АвтоМасштаб = Истина;
	
	
	ОбластьПервойЯчейки = ТабличныйДокумент.НайтиТекст("Расчетный листок");
	
	Если ОбластьПервойЯчейки = Неопределено тогда
		Возврат;
	КонецЕсли;
	
	НомерСтрокиНачалаРЛ = ОбластьПервойЯчейки.Верх;
	НомерСтрокиНачалаРЛ = НомерСтрокиНачалаРЛ - 1;
	
	ОбластьГруппировки = ТабличныйДокумент.Область(1, , НомерСтрокиНачалаРЛ - 2, );
	ОбластьПриемник    = ТабличныйДокументДляПроверки.Область(1, , НомерСтрокиНачалаРЛ - 2, );
	ТабличныйДокументДляПроверки.ВставитьОбласть(ОбластьГруппировки, ОбластьПриемник, ТипСмещенияТабличногоДокумента.ПоВертикали);
	
	ОбластьПоследнейЯчейки = ТабличныйДокумент.НайтиТекст("Долг за ");
	НомерСтрокиКонцаРЛ     = ОбластьПоследнейЯчейки.Верх + 1;
	
	ОбластьРЛ = ТабличныйДокумент.Область(НомерСтрокиНачалаРЛ, , НомерСтрокиКонцаРЛ, );
	ОбластьПриемник = ТабличныйДокументДляПроверки.Область(ТабличныйДокументДляПроверки.ВысотаТаблицы+1, ,ТабличныйДокументДляПроверки.ВысотаТаблицы + (НомерСтрокиКонцаРЛ - НомерСтрокиНачалаРЛ)+1, );
	ТабличныйДокументДляПроверки.ВставитьОбласть(ОбластьРЛ, ОбластьПриемник, , истина);
	
	ОбластьСлед = ТабличныйДокумент.Область(НомерСтрокиКонцаРЛ, , НомерСтрокиКонцаРЛ, );
	ОбластьПервойЯчейки = ТабличныйДокумент.НайтиТекст("Расчетный листок", ОбластьСлед);
	
	Пока ОбластьПервойЯчейки <> Неопределено Цикл
		
		Если ОбластьПервойЯчейки.Верх - НомерСтрокиКонцаРЛ > 2 тогда
			ОбластьГруппировки = ТабличныйДокумент.Область(НомерСтрокиКонцаРЛ + 1, , ОбластьПервойЯчейки.Верх - 1, );
			ОбластьПриемник    = ТабличныйДокументДляПроверки.Область(ТабличныйДокументДляПроверки.ВысотаТаблицы + 1, ,ТабличныйДокументДляПроверки.ВысотаТаблицы + (ОбластьПервойЯчейки.Верх - НомерСтрокиКонцаРЛ - 2) + 1, );
			ТабличныйДокументДляПроверки.ВставитьОбласть(ОбластьГруппировки, ОбластьПриемник, ТипСмещенияТабличногоДокумента.ПоВертикали);
		КонецЕсли;
		
		НомерСтрокиНачалаРЛ    = ОбластьПервойЯчейки.Верх - 1;
		
		ОбластьСлед = ТабличныйДокумент.Область(НомерСтрокиНачалаРЛ, , НомерСтрокиНачалаРЛ, );
		ОбластьПоследнейЯчейки = ТабличныйДокумент.НайтиТекст("Долг за ", ОбластьСлед);
		НомерСтрокиКонцаРЛ     = ОбластьПоследнейЯчейки.Верх + 1;
		
		ОбластьРЛ = ТабличныйДокумент.Область(НомерСтрокиНачалаРЛ, , НомерСтрокиКонцаРЛ, );
		ОбластьПриемник = ТабличныйДокументДляПроверки.Область(ТабличныйДокументДляПроверки.ВысотаТаблицы + 1, ,ТабличныйДокументДляПроверки.ВысотаТаблицы + (НомерСтрокиКонцаРЛ - НомерСтрокиНачалаРЛ) + 1, );
		ТабличныйДокументДляПроверки.ВставитьОбласть(ОбластьРЛ, ОбластьПриемник, , истина);
		
		КоличествоСтраниц = 0;
		Попытка
			КоличествоСтраниц = ТабличныйДокументДляПроверки.КоличествоСтраниц();
		Исключение
		КонецПопытки;
		
		Если КоличествоСтраниц > 1 тогда
			
			ТабличныйДокумент.Область(НомерСтрокиНачалаРЛ, , НомерСтрокиНачалаРЛ,).НачалоСтраницы = истина;
			
			ТабличныйДокументДляПроверки.Очистить();
			
			Для сч = 0 по НастройкаШириныКолонокРасчетногоЛистка.ВГраница() Цикл
				ОбластьКолонкиРЛ                  = ТабличныйДокументДляПроверки.Область(, сч+1, , сч+1);
				ОбластьКолонкиРЛ.ШиринаКолонки    = НастройкаШириныКолонокРасчетногоЛистка[сч];
				ОбластьКолонкиРЛ.РазмещениеТекста = ПолучитьТипРазмещенияТекста(НастройкаРазмТекстаКолонокРасчетногоЛистка[сч]);
			КонецЦикла;
			
			ОбластьПриемник = ТабличныйДокументДляПроверки.Область(ТабличныйДокументДляПроверки.ВысотаТаблицы + 1, ,ТабличныйДокументДляПроверки.ВысотаТаблицы + (НомерСтрокиКонцаРЛ - НомерСтрокиНачалаРЛ) + 1, );
			ТабличныйДокументДляПроверки.ВставитьОбласть(ОбластьРЛ, ОбластьПриемник, , истина);
			
		КонецЕсли;
		
		ОбластьСлед = ТабличныйДокумент.Область(НомерСтрокиКонцаРЛ, , НомерСтрокиКонцаРЛ, );
		ОбластьПервойЯчейки    = ТабличныйДокумент.НайтиТекст("Расчетный листок", ОбластьСлед);
		
		#Если НЕ Сервер И НЕ ВнешнееСоединение Тогда
			ОбработкаПрерыванияПользователя();
		#КонецЕсли
		
	КонецЦикла;
	
КонецПроцедуры

// Вывод результата компоновки в табличный документ
//
Процедура ВывестиРезультатВТабличныйДокумент(ПроцессорКомпоновкиДанных, ТабличныйДокумент, ВыводитьПоСтраницам) Экспорт
	
	// Создадим и инициализируем процессор вывода результата
	ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
	ПроцессорВывода.УстановитьДокумент(ТабличныйДокумент);
	
	// Обозначим начало вывода
	ПроцессорВывода.НачатьВывод();
	#Если НЕ Сервер И НЕ ВнешнееСоединение Тогда
		Состояние(НСТР("ru='Если Вы хотите прервать вывод отчета, нажмите Ctrl+Break'"));
	#КонецЕсли
	
	// Основной цикл вывода отчета
	Счетчик = 0;
	Пока Истина Цикл
		
		
		// Получим следующий элемент результата компоновки
		ЭлементРезультата = ПроцессорКомпоновкиДанных.Следующий();
		
		// Получим следующий элемент результата компоновки
		Если ЭлементРезультата = Неопределено Тогда
			
			// Следующий элемент не получен - заканчиваем цикл вывода
			Прервать;
			
		Иначе
			
			// Элемент получен - выведем его при помощи процессора вывода
			ПроцессорВывода.ВывестиЭлемент(ЭлементРезультата);
			
		КонецЕсли;
		
		#Если НЕ Сервер И НЕ ВнешнееСоединение Тогда
			ОбработкаПрерыванияПользователя();
		#КонецЕсли
		
	КонецЦикла;
	
	ПроцессорВывода.ЗакончитьВывод();
	
	Если ВыводитьПоСтраницам тогда
		РазбитьТабличныйДокументПоСтраницам(ТабличныйДокумент);
	КонецЕсли
	
КонецПроцедуры

// Формирование отчета в табличный документ "Результат"
//
// Параметры:
//   Результат         – табличный документ, в который помещается результат вывода расчетных листков.
//	 ДанныеРасшифровки - данные расшифровки компоновки данных
//
Функция СформироватьОтчет(Результат, ДанныеРасшифровки = Неопределено, ВыводВФормуОтчета = ложь, ВыводитьПоСтраницам = ложь) Экспорт
	
	#Если ТолстыйКлиентОбычноеПриложение Тогда
		СохранитьНастройкуТабличногоДокумента(Результат);
	#КонецЕсли
	
	Если ДанныеРасшифровки = Неопределено тогда
		ДанныеРасшифровки = Новый ДанныеРасшифровкиКомпоновкиДанных;
	КонецЕсли;
	
	НастрокаПоУмолчанию        = КомпоновщикНастроек.ПолучитьНастройки();
	ТиповыеОтчеты.ПолучитьПримененуюНастройку(ЭтотОбъект);
	
	ЗначениеПараметра = КомпоновщикНастроек.Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("Группировать"));
	
	Если ЗначениеПараметра.Использование и НЕ ЗначениеПараметра.Значение тогда
		УдалитьГруппировку();
	КонецЕсли;
	
	// Получить настройки схемы компоновки данных
	Настройки = КомпоновщикНастроек.Настройки;
	
	// Преобразовать отбор по физ лицу в отбор по сотруднику
	Для каждого ЭлементОтбора из Настройки.Отбор.Элементы Цикл
		
		Если НЕ ЭлементОтбора.Использование Тогда
			Продолжить;
		КонецЕсли;
		
		Если ТипЗнч(ЭлементОтбора) = Тип("ГруппаЭлементовОтбораКомпоновкиДанных") Тогда
			Продолжить;
		КонецЕсли;
		
		Если ЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных("Сотрудник") И 
			(ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно 
			ИЛИ ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВИерархии) 
			И ЭлементОтбора.ПравоеЗначение <> Справочники.СотрудникиОрганизаций.ПустаяСсылка()
			И НЕ ОбщегоНазначенияЗК.ПолучитьЗначениеРеквизита(ЭлементОтбора.ПравоеЗначение, "ЭтоГруппа") Тогда
			
			ЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных("ФизЛицо");
			ЭлементОтбора.ПравоеЗначение = ОбщегоНазначенияЗК.ПолучитьЗначениеРеквизита(ЭлементОтбора.ПравоеЗначение, "ФизЛицо");
			
		ИначеЕсли ЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных("Сотрудник") И 
			(ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВСписке
			ИЛИ ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВСпискеПоИерархии) Тогда
			ОтборБезГрупп = Истина;
			СписокФизЛиц = Новый СписокЗначений;
			Для каждого ЭлементСписка из ЭлементОтбора.ПравоеЗначение Цикл
				//
				Если ЭлементСписка.Значение <> Справочники.СотрудникиОрганизаций.ПустаяСсылка() И НЕ ОбщегоНазначенияЗК.ПолучитьЗначениеРеквизита(ЭлементСписка.Значение, "ЭтоГруппа") Тогда
				//Если ЭлементСписка.Значение <> Справочники.СотрудникиОрганизаций.ПустаяСсылка()  Тогда

					СписокФизЛиц.Добавить(ОбщегоНазначенияЗК.ПолучитьЗначениеРеквизита(ЭлементСписка.Значение, "ФизЛицо"));
				Иначе
					ОтборБезГрупп = Ложь;
					Прервать;
				КонецЕсли;
			КонецЦикла;
			Если ОтборБезГрупп Тогда
				ЭлементОтбора.ЛевоеЗначение  = Новый ПолеКомпоновкиДанных("ФизЛицо");
				ЭлементОтбора.ПравоеЗначение = СписокФизЛиц;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
	ЗначениеПараметра = КомпоновщикНастроек.Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("ВидРасчетногоЛистка"));
	ВидРасчетногоЛистка = ЗначениеПараметра.Значение;
	
	ЗначениеНачалоПараметра = Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("НачалоПериода"));
	НачалоПериода           = ЗначениеНачалоПараметра.Значение;
	
	ЗначениеКонецПараметра = Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("КонецПериода"));
	КонецПериода           = ЗначениеКонецПараметра.Значение;
	
	Если Дата(КонецПериода) = '00010101' И Дата(НачалоПериода) = '00010101' Тогда
		#Если НЕ Сервер И НЕ ВнешнееСоединение Тогда
			ЗначениеКонецПараметра.Значение  = НачалоМесяца(РабочаяДата);
			НачалоПериода                    = НачалоМесяца(РабочаяДата);
			ЗначениеНачалоПараметра.Значение = КонецМесяца(РабочаяДата);
			КонецПериода                     = КонецМесяца(РабочаяДата);
		#ИначеЕсли Сервер Или ВнешнееСоединение Тогда
			ЗначениеКонецПараметра.Значение  = НачалоМесяца(ТекущаяДатаСеанса());
			НачалоПериода                    = НачалоМесяца(ТекущаяДатаСеанса());
			ЗначениеНачалоПараметра.Значение = КонецМесяца(ТекущаяДатаСеанса());
			КонецПериода                     = КонецМесяца(ТекущаяДатаСеанса());
		#КонецЕсли
	КонецЕсли;
	
	Если НачалоПериода <> Неопределено и КонецПериода <> Неопределено тогда
		УправлениеОтчетамиЗК.ЗаменитьВСКДТекстЗапросКалендаря(СхемаКомпоновкиДанных, НачалоПериода, КонецПериода, СоответствиеНаборовДанныхИЗапросов);
	КонецЕсли;
	
	// установим параметры и текст запроса построителя запроса
	ПостроительОтчетов = Новый ПостроительОтчета;
	
	НастроитьПостроительЗапросов(ПостроительОтчетов, ВидРасчетногоЛистка);
	
	//// установим отбор р/л без без начислений и удержаний
	ГруппаОтбора                 = Настройки.Отбор.Элементы.Добавить(Тип("ГруппаЭлементовОтбораКомпоновкиДанных"));
	ГруппаОтбора.ТипГруппы       = ТипГруппыЭлементовОтбораКомпоновкиДанных.ГруппаИли;
	ГруппаОтбора.Использование   = Истина;
	
	ЭлементОтбора                = ГруппаОтбора.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
	ЭлементОтбора.ВидСравнения   = ВидСравненияКомпоновкиДанных.Содержит;
	ЭлементОтбора.Использование  = Истина;
	ЭлементОтбора.ЛевоеЗначение  = Настройки.ДоступныеПоляОтбора.НайтиПоле(Новый ПолеКомпоновкиДанных("ВидДвижения")).Поле;
	ЭлементОтбора.ПравоеЗначение = "1";
	
	ЭлементОтбора                = ГруппаОтбора.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
	ЭлементОтбора.ВидСравнения   = ВидСравненияКомпоновкиДанных.Содержит;
	ЭлементОтбора.Использование  = Истина;
	ЭлементОтбора.ЛевоеЗначение  = Настройки.ДоступныеПоляОтбора.НайтиПоле(Новый ПолеКомпоновкиДанных("ВидДвиженияУд")).Поле;
	ЭлементОтбора.ПравоеЗначение = "2";
	
	ЭлементОтбора                = ГруппаОтбора.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
	ЭлементОтбора.ВидСравнения   = ВидСравненияКомпоновкиДанных.Содержит;
	ЭлементОтбора.Использование  = Истина;
	ЭлементОтбора.ЛевоеЗначение  = Настройки.ДоступныеПоляОтбора.НайтиПоле(Новый ПолеКомпоновкиДанных("ВидДвижения")).Поле;
	ЭлементОтбора.ПравоеЗначение = "3";
	
	
	ГруппаОтбора                 = Настройки.Отбор.Элементы.Добавить(Тип("ГруппаЭлементовОтбораКомпоновкиДанных"));
	ГруппаОтбора.ТипГруппы       = ТипГруппыЭлементовОтбораКомпоновкиДанных.ГруппаИли;
	ГруппаОтбора.Использование   = Истина;
	
	ЭлементОтбора                = ГруппаОтбора.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
	ЭлементОтбора.ВидСравнения   = ВидСравненияКомпоновкиДанных.НеРавно;
	ЭлементОтбора.Использование  = Истина;
	ЭлементОтбора.ЛевоеЗначение  = Настройки.ДоступныеПоляОтбора.Элементы.Найти("СальдоНачальное").Поле;
	ЭлементОтбора.ПравоеЗначение = 0;
	
	ЭлементОтбора                = ГруппаОтбора.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
	ЭлементОтбора.ВидСравнения   = ВидСравненияКомпоновкиДанных.НеРавно;
	ЭлементОтбора.Использование  = Истина;
	ЭлементОтбора.ЛевоеЗначение  = Настройки.ДоступныеПоляОтбора.Элементы.Найти("СальдоКонечное").Поле;
	ЭлементОтбора.ПравоеЗначение = 0;
	
	ЭлементОтбора                = ГруппаОтбора.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
	ЭлементОтбора.ВидСравнения   = ВидСравненияКомпоновкиДанных.НеРавно;
	ЭлементОтбора.Использование  = Истина;
	ЭлементОтбора.ЛевоеЗначение  = Настройки.ДоступныеПоляОтбора.Элементы.Найти("Оборот").Поле;
	ЭлементОтбора.ПравоеЗначение = 0;
	
	
	ЗначениеОтбораСотрудника = Неопределено;
	ЕстьОтборПоФизЛицу = ложь;
	Для каждого ЭлементОтбора из Настройки.Отбор.Элементы Цикл
		
		// если отбор установлен по сотруднику
		Если ЭлементОтбора.Использование  И ТипЗнч(ЭлементОтбора) = Тип("ЭлементОтбораКомпоновкиДанных") И ЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных("Сотрудник") тогда
			Если ЭлементОтбора.ПравоеЗначение <> Неопределено И ТипЗнч(ЭлементОтбора.ПравоеЗначение) <> Тип("ПолеКомпоновкиДанных") тогда
				ЗначениеОтбораСотрудника = ЭлементОтбора;
			КонецЕсли;
		КонецЕсли;
		
		//если отбор установлен по физлицу
		Если ЭлементОтбора.Использование И ТипЗнч(ЭлементОтбора) = Тип("ЭлементОтбораКомпоновкиДанных") И ЭлементОтбора.ЛевоеЗначение = СписокПолейОтбора.Получить(0).Значение тогда
			Если ЭлементОтбора.ПравоеЗначение <> Неопределено И ТипЗнч(ЭлементОтбора.ПравоеЗначение) <> Тип("ПолеКомпоновкиДанных") тогда
				ЕстьОтборПоФизЛицу = истина;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
	Если НЕ ЕстьОтборПоФизЛицу И ЗначениеОтбораСотрудника <> Неопределено 
		И ((ТипЗнч(ЗначениеОтбораСотрудника.ПравоеЗначение) = Тип("СправочникСсылка.СотрудникиОрганизаций") 
		И  НЕ ЗначениеОтбораСотрудника.ПравоеЗначение.ЭтоГруппа)
		или ТипЗнч(ЗначениеОтбораСотрудника.ПравоеЗначение) = Тип("СписокЗначений"))тогда
		
		ОтборПоФизЛицу                = Настройки.Отбор.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
		ОтборПоФизЛицу.ВидСравнения   = ЗначениеОтбораСотрудника.ВидСравнения;
		ОтборПоФизЛицу.Использование  = Истина;
		ОтборПоФизЛицу.ЛевоеЗначение  = Настройки.ДоступныеПоляОтбора.НайтиПоле(Новый ПолеКомпоновкиДанных("ФизЛицо")).Поле;
		
		Если ТипЗнч(ЗначениеОтбораСотрудника.ПравоеЗначение) = Тип("СправочникСсылка.СотрудникиОрганизаций") тогда
			ОтборПоФизЛицу.ПравоеЗначение = ЗначениеОтбораСотрудника.ПравоеЗначение.Физлицо;
		ИначеЕсли ТипЗнч(ЗначениеОтбораСотрудника.ПравоеЗначение) = Тип("СписокЗначений") тогда
			
			СписокЗначенийОтбораФизЛиц = Новый СписокЗначений;
			
			Для каждого ЭлементСписка из ЗначениеОтбораСотрудника.ПравоеЗначение Цикл
				Если ТипЗнч(ЭлементСписка.Значение) = Тип("СправочникСсылка.СотрудникиОрганизаций") тогда
					СписокЗначенийОтбораФизЛиц.Добавить(ЭлементСписка.Значение.ФизЛицо);
				КонецЕсли;
			КонецЦикла;
			
			ОтборПоФизЛицу.ПравоеЗначение = СписокЗначенийОтбораФизЛиц;
			
		Иначе
			
			Настройки.Отбор.Элементы.Удалить(ОтборПоФизЛицу);
			
		КонецЕсли;
	КонецЕсли;
	
	// установим отборы в построителе запросов 
	Для каждого ЭлементОтбора из Настройки.Отбор.Элементы Цикл
		Если ЭлементОтбора.Использование И ТипЗнч(ЭлементОтбора) = Тип("ЭлементОтбораКомпоновкиДанных") И СписокПолейОтбора.НайтиПоЗначению(ЭлементОтбора.ЛевоеЗначение)<>Неопределено 
			тогда
			ВидСравненияОтбора = Неопределено;
			Если ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно тогда
				ВидСравненияОтбора = ВидСравнения.Равно;
			ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВСписке тогда
				ВидСравненияОтбора = ВидСравнения.ВСписке;
			ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.НеРавно тогда
				ВидСравненияОтбора = ВидСравнения.НеРавно;
			ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВСпискеПоИерархии тогда
				ВидСравненияОтбора = ВидСравнения.ВСпискеПоИерархии;
			ИначеЕсли ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВИерархии тогда
				ВидСравненияОтбора = ВидСравнения.ВИерархии;
			КонецЕсли;
			Если ВидСравненияОтбора <> Неопределено тогда 
				Имя = Строка(ЭлементОтбора.ЛевоеЗначение);
				ПостроительОтчетов.Отбор.Добавить(Имя);
				ПостроительОтчетов.Отбор[Имя].ВидСравнения  = ВидСравненияОтбора;
				Если ЭлементОтбора.ПравоеЗначение <> Неопределено и ЭлементОтбора.ПравоеЗначение <> Null и ТипЗнч(ЭлементОтбора.ПравоеЗначение) <> Тип("ПолеКомпоновкиДанных") тогда
					ПостроительОтчетов.Отбор[Имя].Значение      = ЭлементОтбора.ПравоеЗначение;
				КонецЕсли;
				ПостроительОтчетов.Отбор[Имя].Использование = Истина;
			КонецЕсли;
		КонецЕсли;
		
		// если отбор установлен по сотруднику
		Если ЭлементОтбора.Использование  И ТипЗнч(ЭлементОтбора) = Тип("ЭлементОтбораКомпоновкиДанных") И ЭлементОтбора.ЛевоеЗначение = СписокПолейОтбора.Получить(1).Значение тогда
			Если ЭлементОтбора.ПравоеЗначение <> Неопределено И ТипЗнч(ЭлементОтбора.ПравоеЗначение) <> Тип("ПолеКомпоновкиДанных") тогда
				ЗначениеОтбораСотрудника = ЭлементОтбора;
			КонецЕсли;
		КонецЕсли;
		
		//если отбор установлен по физлицу
		Если ЭлементОтбора.Использование И ТипЗнч(ЭлементОтбора) = Тип("ЭлементОтбораКомпоновкиДанных") И ЭлементОтбора.ЛевоеЗначение = СписокПолейОтбора.Получить(0).Значение тогда
			Если ЭлементОтбора.ПравоеЗначение <> Неопределено И ТипЗнч(ЭлементОтбора.ПравоеЗначение) <> Тип("ПолеКомпоновкиДанных") тогда
				ЕстьОтборПоФизЛицу = истина;
			КонецЕсли;
		КонецЕсли;
		
	КонецЦикла;
	
	// заполним ТЗ "НачисленияУдержания"
	ЗаполнитьВнешнийИсточникДанных(ПостроительОтчетов, ВидРасчетногоЛистка);
	
	//Установить параметрыы расшифровки макета
	
	Для каждого МакетГруппировки из СхемаКомпоновкиДанных.МакетыГруппировок Цикл
		Если МакетГруппировки.ИмяГруппировки = "СтрокаНачисленийУдержаний" тогда
			ИмяМакетаСтрокаНачислений = МакетГруппировки.Макет;
		КонецЕсли;
		Если МакетГруппировки.ИмяГруппировки = "ДоходыВНатуральнойФормеВыплата" тогда
			ИмяМакетаДоходыВнатруальнойФорме = МакетГруппировки.Макет;
		КонецЕсли;
		
	КонецЦикла;
	
	СотрудникМесяц = Новый ПараметрКомпоновкиДанных("СотрудникМесяц");
	СотрудникМесяц1 = Новый ПараметрКомпоновкиДанных("СотрудникМесяц");
	
	МакетСтрокиНачисленийУдержаний = СхемаКомпоновкиДанных.Макеты.Найти(ИмяМакетаСтрокаНачислений);
	МакетСтрокиДоходовВыплат       = СхемаКомпоновкиДанных.Макеты.Найти(ИмяМакетаДоходыВнатруальнойФорме);
	
	ЯчейкиСтрокиНачисленийУдержаний = МакетСтрокиНачисленийУдержаний.Макет[0].Ячейки;
	ЯчейкиСтрокиДоходовВыплат       = МакетСтрокиДоходовВыплат.Макет[0].Ячейки;
	Для сч = 0 по 16 Цикл
		ЯчейкиСтрокиНачисленийУдержаний[Сч].Оформление.Элементы.Найти("Details").Значение = СотрудникМесяц;
		ЯчейкиСтрокиДоходовВыплат[Сч].Оформление.Элементы.Найти("Details").Значение       = СотрудникМесяц1;
	КонецЦикла;
	
	// создадим структуру с внешним набором данных
	ВнешниеНаборыДанных = Новый Структура;
	ВнешниеНаборыДанных.Вставить("НачисленияУдержания", НачисленияУдержания);
	
	// получим макет компоновки данных
	КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;
	МакетКомпоновки   = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, Настройки, ДанныеРасшифровки);
	
	// создадим и инициализируем процессор компоновки данных
	ПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;
	ПроцессорКомпоновки.Инициализировать(МакетКомпоновки, ВнешниеНаборыДанных, ДанныеРасшифровки);
	
	// очистим результирующий табличный документ
	Результат.Очистить();
	
	Если ВыводВФормуОтчета тогда
		ВыводЗаголовкаОтчета(Результат);
	КонецЕсли;
	
	// удалим отбор пустых строк начислений
	Настройки.Отбор.Элементы.Удалить(ГруппаОтбора);
	Если ОтборПоФизЛицу <> Неопределено тогда
		Настройки.Отбор.Элементы.Удалить(ОтборПоФизЛицу);
	КонецЕсли;
	
	// выведем отчет в табличный документ "Результат"
	ВывестиРезультатВТабличныйДокумент(ПроцессорКомпоновки, Результат, ВыводитьПоСтраницам);
	
	УправлениеОтчетамиЗК.УстановитьЗапросыСКДПоСоответсвию(СхемаКомпоновкиДанных.НаборыДанных, СоответствиеНаборовДанныхИЗапросов);
	
	Результат.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	
	
	Если ВыводВФормуОтчета тогда
		ТиповыеОтчеты.УправлениеОтображениемЗаголовкаТиповогоОтчета(ЭтотОбъект, Результат);
	КонецЕсли;
	
	Результат.Область(1, 1, 1, 1).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Авто;
	КомпоновщикНастроек.ЗагрузитьНастройки(НастрокаПоУмолчанию);
	
	#Если ТолстыйКлиентОбычноеПриложение Тогда
		ВосстановитьНастройкуТабличногоДокумента(Результат);
	#КонецЕсли
	
	Возврат Результат;
	
КонецФункции

Функция ПолучитьПараметрыИсполненияОтчета() Экспорт
	
	СписокПолейПодстановкиОтборовПоУмолчанию = Новый Соответствие;
	СписокПолейПодстановкиОтборовПоУмолчанию.Вставить("Организация", "ОсновнаяОрганизация");
	
	Возврат Новый Структура("ИспользоватьСобытияПриФормированииОтчета,
	|ПриВыводеЗаголовкаОтчета,
	|ПослеВыводаПанелиПользователя,
	|ПослеВыводаПериода,
	|ПослеВыводаПараметра,
	|ПослеВыводаГруппировки,
	|ПослеВыводаОтбора,
	|ДействияПанелиИзменениеФлажкаДопНастроек,
	|ПриПолучениеНастроекПользователя, 
	|ЗаполнитьОтборыПоУмолчанию, 
	|СписокПолейПодстановкиОтборовПоУмолчанию,
	|СписокДоступныхПредопределенныхНастроек,
	|МинимальныйПериодОтчета", 
	ложь, ложь, ложь, ложь, ложь, ложь, ложь, ложь, ложь, истина, СписокПолейПодстановкиОтборовПоУмолчанию,, "Месяц");
	
КонецФункции

#Если ТолстыйКлиентОбычноеПриложение тогда

// Настраивает отчет
//
Процедура Настроить(Отбор, КомпоновщикНастроекОсновногоОтчета = Неопределено) Экспорт
	
	ТиповыеОтчеты.НастроитьТиповойОтчет(ЭтотОбъект, Отбор, КомпоновщикНастроекОсновногоОтчета);
	
КонецПроцедуры

// Инициализация отчета
//
// Параметры:
//  Нет.
//
Процедура ИнициализацияОтчета() Экспорт
	
КонецПроцедуры

// Заполняет отборы и параметры схемы копоновки
//
Функция НастроитьОтборыПарметры(Отбор = Неопределено, Параметры = Неопределено) Экспорт
	
	Если Отбор = Неопределено И Параметры = Неопределено тогда
		Возврат ложь;
	КонецЕсли;
	
	Настройки = КомпоновщикНастроек.Настройки;
	
	Если ТипЗнч(Отбор) = Тип("Массив") тогда
		
		Для каждого ЭлементОтбора из Отбор Цикл
			Если ТипЗнч(ЭлементОтбора) = Тип("Структура") тогда
				
				ЛевоеЗначение    = Неопределено;
				ВидСравненияКомп = Неопределено;
				ПравоеЗначение   = Неопределено;
				
				Если НЕ ЭлементОтбора.Свойство("ЛевоеЗначение", ЛевоеЗначение) тогда
					Возврат ложь;
				КонецЕсли;
				
				Если НЕ ЭлементОтбора.Свойство("ВидСравнения", ВидСравненияКомп) тогда
					Возврат ложь;
				КонецЕсли;
				
				Если НЕ ЭлементОтбора.Свойство("ПравоеЗначение", ПравоеЗначение) тогда
					Возврат ложь;
				КонецЕсли;
				
				ПолеОтбора = Настройки.Отбор.ДоступныеПоляОтбора.НайтиПоле(Новый ПолеКомпоновкиДанных(Строка(ЛевоеЗначение)));
				
				Если ПолеОтбора = Неопределено тогда
					Возврат ложь;
				КонецЕсли;
				
				Если НЕ ТипЗнч(ВидСравненияКомп) = Тип("ВидСравненияКомпоновкиДанных") тогда
					Возврат ложь;
				КонецЕсли;
				
				Если НЕ ПолеОтбора.Тип.СодержитТип(ТипЗнч(ПравоеЗначение))   тогда
					Возврат ложь;
				КонецЕсли;
				
				ЭлементОтбораКомпоновки = Неопределено;
				
				Для каждого ЭлементОтбораКомп из Настройки.Отбор.Элементы Цикл
					Если ЭлементОтбораКомп.ЛевоеЗначение = ПолеОтбора.Поле тогда
						ЭлементОтбораКомпоновки = ЭлементОтбораКомп;
					КонецЕсли;
				КонецЦикла;
				
				Если ЭлементОтбораКомпоновки = Неопределено тогда
					ЭлементОтбораКомпоновки = Настройки.Отбор.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
				КонецЕсли;
				
				ЭлементОтбораКомпоновки.ЛевоеЗначение  = ПолеОтбора.Поле;
				ЭлементОтбораКомпоновки.ВидСравнения   = ВидСравненияКомп;
				ЭлементОтбораКомпоновки.ПравоеЗначение = ПравоеЗначение;
				ЭлементОтбораКомпоновки.Использование  = истина;
				
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
	
	Если ТипЗнч(Параметры) = Тип("Массив") тогда
		
		Для каждого ЭлементПараметра из Параметры Цикл
			Если ТипЗнч(ЭлементПараметра) = Тип("Структура") тогда
				
				Параметр = Неопределено;
				Значение = Неопределено;
				
				Если НЕ ЭлементПараметра.Свойство("Параметр", Параметр) тогда
					Возврат ложь;
				КонецЕсли;
				
				Если НЕ ЭлементПараметра.Свойство("Значение", Значение) тогда
					Возврат ложь;
				КонецЕсли;
				
				ПараметрКомпоновки = Настройки.ПараметрыДанных.ДоступныеПараметры.НайтиПараметр(Новый ПараметрКомпоновкиДанных(Строка(Параметр)));
				
				Если ПараметрКомпоновки = Неопределено тогда
					Возврат ложь;
				КонецЕсли;
				
				Если НЕ ПараметрКомпоновки.Тип.СодержитТип(ТипЗнч(Значение)) тогда
					Возврат ложь;
				КонецЕсли;
				
				ЗначениеПараметра               = Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных(Строка(Параметр)));
				ЗначениеПараметра.Значение      = Значение;
				ЗначениеПараметра.Использование = Истина;
			КонецЕсли;
		КонецЦикла;
		
	КонецЕсли;
	
	Возврат истина;
	
КонецФункции

// Возвращает значение вида сравнения компоновки данных в зависимости от вида сравнения
//
Функция ПолучитьВидСравнения(ВидСравненияЭлемента) Экспорт
	
	ВидСравненияДляСхемыКомпоновки = Неопределено;
	Если ВидСравненияЭлемента = ВидСравнения.Равно тогда
		ВидСравненияДляСхемыКомпоновки = ВидСравненияКомпоновкиДанных.Равно;
	ИначеЕсли ВидСравненияЭлемента = ВидСравнения.НеРавно тогда
		ВидСравненияДляСхемыКомпоновки = ВидСравненияКомпоновкиДанных.НеРавно;
	ИначеЕсли ВидСравненияЭлемента = ВидСравнения.ВСписке тогда
		ВидСравненияДляСхемыКомпоновки = ВидСравненияКомпоновкиДанных.ВСписке;
	ИначеЕсли ВидСравненияЭлемента = ВидСравнения.ВСпискеПоИерархии тогда
		ВидСравненияДляСхемыКомпоновки = ВидСравненияКомпоновкиДанных.ВСпискеПоИерархии;
	ИначеЕсли ВидСравненияЭлемента = ВидСравнения.ВИерархии тогда
		ВидСравненияДляСхемыКомпоновки = ВидСравненияКомпоновкиДанных.ВИерархии;
	КонецЕсли;
	
	Возврат ВидСравненияДляСхемыКомпоновки;
	
КонецФункции

// Сохранение настроек печати табличного документа
//
// Параметры:
//   ТабличныйДокумент – табличный документ.
//
Процедура СохранитьНастройкуТабличногоДокумента(ТабличныйДокумент) Экспорт
	
	СтруктураПараметров = Новый Структура("ПолеСверху, ПолеСлева, ПолеСправа, ПолеСнизу, МасштабПечати, АвтоМасштаб");
	
	СтруктураПараметров.ПолеСверху    = ТабличныйДокумент.ПолеСверху;
	СтруктураПараметров.ПолеСлева     = ТабличныйДокумент.ПолеСлева;
	СтруктураПараметров.ПолеСправа    = ТабличныйДокумент.ПолеСправа;
	СтруктураПараметров.ПолеСнизу     = ТабличныйДокумент.ПолеСнизу;
	СтруктураПараметров.МасштабПечати = ТабличныйДокумент.МасштабПечати;
	СтруктураПараметров.АвтоМасштаб   = ТабличныйДокумент.АвтоМасштаб;
	
	СохранитьЗначение("ПАРАМЕТРЫ_ПЕЧАТИ_РасчетногоЛисткаОрганизации", СтруктураПараметров);
	
КонецПроцедуры

Процедура СохранитьНастройку() Экспорт
	
	СтруктураНастроек = ТиповыеОтчеты.ПолучитьСтруктуруПараметровТиповогоОтчета(ЭтотОбъект);
	СохранениеНастроек.СохранитьНастройкуОбъекта(СохраненнаяНастройка, СтруктураНастроек);
	
КонецПроцедуры

Процедура ПрименитьНастройку() Экспорт
	
	Схема = ТиповыеОтчеты.ПолучитьСхемуКомпоновкиОбъекта(ЭтотОбъект);
	
	// Считываение структуры настроек отчета
	Если Не СохраненнаяНастройка.Пустая() Тогда
		
		СтруктураНастроек = СохраненнаяНастройка.ХранилищеНастроек.Получить();
		Если Не СтруктураНастроек = Неопределено Тогда
			КомпоновщикНастроек.ЗагрузитьНастройки(СтруктураНастроек.НастройкиКомпоновщика);
			ЗаполнитьЗначенияСвойств(ЭтотОбъект, СтруктураНастроек);
		Иначе
			КомпоновщикНастроек.ЗагрузитьНастройки(Схема.НастройкиПоУмолчанию);
		КонецЕсли;
		
	Иначе
		КомпоновщикНастроек.ЗагрузитьНастройки(Схема.НастройкиПоУмолчанию);
	КонецЕсли;
	
КонецПроцедуры

// Восстановление настройки печати табличного документа.
//
// Параметры:
//   ТабличныйДокумент – табличный документ.
//
Процедура ВосстановитьНастройкуТабличногоДокумента(ТабличныйДокумент) Экспорт
	
	Перем СтруктураПараметров;
	
	СтруктураПараметров = ВосстановитьЗначение("ПАРАМЕТРЫ_ПЕЧАТИ_РасчетногоЛисткаОрганизации");
	
	Если СтруктураПараметров = Неопределено тогда
		СтруктураПараметров = Новый Структура("ПолеСверху, ПолеСлева, ПолеСправа, ПолеСнизу, МасштабПечати, АвтоМасштаб");
		СтруктураПараметров.ПолеСверху    = 10;
		СтруктураПараметров.ПолеСлева     = 20;
		СтруктураПараметров.ПолеСправа    = 10;
		СтруктураПараметров.ПолеСнизу     = 10;
		СтруктураПараметров.МасштабПечати = 100;
		СтруктураПараметров.АвтоМасштаб   = истина;
	КонецЕсли;
	
	ТабличныйДокумент.ПолеСверху    = СтруктураПараметров.ПолеСверху;
	ТабличныйДокумент.ПолеСлева     = СтруктураПараметров.ПолеСлева;
	ТабличныйДокумент.ПолеСправа    = СтруктураПараметров.ПолеСправа;
	ТабличныйДокумент.ПолеСнизу     = СтруктураПараметров.ПолеСнизу;
	ТабличныйДокумент.МасштабПечати = ?(СтруктураПараметров.МасштабПечати = Неопределено, 100, СтруктураПараметров.МасштабПечати);
	ТабличныйДокумент.АвтоМасштаб   = СтруктураПараметров.АвтоМасштаб;
	
КонецПроцедуры

Если СохраненнаяНастройка = Неопределено Тогда
	СохраненнаяНастройка =  Справочники.СохраненныеНастройки.ПустаяСсылка();
КонецЕсли;

#КонецЕсли

НастройкаШириныКолонокРасчетногоЛистка     = Новый Массив();
НастройкаРазмТекстаКолонокРасчетногоЛистка = Новый Массив();

Для каждого МакетГруппировки из СхемаКомпоновкиДанных.МакетыГруппировок Цикл
	Если МакетГруппировки.ИмяГруппировки = "ШапкаРасчетногоЛистка" тогда
		ИмяМакетаШапкаРасчетногоЛистка = МакетГруппировки.Макет;
	КонецЕсли;
КонецЦикла;
МакетШапкаРасчетногоЛистка = СхемаКомпоновкиДанных.Макеты.Найти(ИмяМакетаШапкаРасчетногоЛистка);

// запомнить настройки макета
ЯчейкиМакета = МакетШапкаРасчетногоЛистка.Макет[0].Ячейки;

Для каждого Ячейка из ЯчейкиМакета Цикл
	НастройкаШириныКолонокРасчетногоЛистка.Вставить(ЯчейкиМакета.Индекс(Ячейка), Ячейка.Оформление.Элементы.Найти("MaximumWidth").Значение);
	НастройкаРазмТекстаКолонокРасчетногоЛистка.Вставить(ЯчейкиМакета.Индекс(Ячейка), Ячейка.Оформление.Элементы.Найти("Placement").Значение);
КонецЦикла;

НастройкаРазмТекстаКолонокРасчетногоЛистка[1] = ТипРазмещенияТекстаКомпоновкиДанных.Выступать;

МакетШапкаРасчетногоЛистка = Неопределено;
ЯчейкиМакета               = Неопределено;

НачисленияУдержания = Новый ТаблицаЗначений();
НачисленияУдержания.Колонки.Добавить("ВидДвижения");
НачисленияУдержания.Колонки.Добавить("ВидДвиженияУд");
НачисленияУдержания.Колонки.Добавить("ФизЛицо");
НачисленияУдержания.Колонки.Добавить("Организация");
НачисленияУдержания.Колонки.Добавить("ГоловнаяОрганизация");
НачисленияУдержания.Колонки.Добавить("ПериодРегистрации");
НачисленияУдержания.Колонки.Добавить("ПризнакУпорядочиванияСтрок");
НачисленияУдержания.Колонки.Добавить("НачисленияУдержанияВидНачисления");
НачисленияУдержания.Колонки.Добавить("НачисленияУдержанияПериодНачисления");
НачисленияУдержания.Колонки.Добавить("НачисленияУдержанияОтработанныеДни");
НачисленияУдержания.Колонки.Добавить("НачисленияУдержанияОтработанныеЧасы");
НачисленияУдержания.Колонки.Добавить("НачисленияУдержанияОплаченныеДни");
НачисленияУдержания.Колонки.Добавить("НачисленияУдержанияОплаченныеЧасы");
НачисленияУдержания.Колонки.Добавить("НачисленияУдержанияСуммаНачисления");
НачисленияУдержания.Колонки.Добавить("НачисленияУдержанияВидУдержания");
НачисленияУдержания.Колонки.Добавить("НачисленияУдержанияПериодУдержания");
НачисленияУдержания.Колонки.Добавить("НачисленияУдержанияСуммаУдержания");
НачисленияУдержания.Колонки.Добавить("СальдоНачальное");
НачисленияУдержания.Колонки.Добавить("СальдоКонечное");
НачисленияУдержания.Колонки.Добавить("СальдоНачальноеНДФЛ");
НачисленияУдержания.Колонки.Добавить("СальдоКонечноеНДФЛ");
НачисленияУдержания.Колонки.Добавить("Оборот");

СписокПолейОтбора = Новый СписокЗначений;
СписокПолейОтбора.Добавить(Новый ПолеКомпоновкиДанных("ФизЛицо"));
СписокПолейОтбора.Добавить(Новый ПолеКомпоновкиДанных("ПериодРегистрации"));
СписокПолейОтбора.Добавить(Новый ПолеКомпоновкиДанных("Организация"));
